/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(1);


/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	const StandardPeriodSelector = __webpack_require__(2);
	
	window.stPS = new StandardPeriodSelector();
	
	;(function (env, factory) {
	  if (typeof module === 'object' && module.exports) {
	    module.exports = env.document
	       ? factory(env) : function (win) {
	         if (!win.document) {
	           throw new Error('Window with document not present');
	         }
	         return factory(win, true);
	       };
	  } else {
	    env.StandardPeriodSelector = factory(env, true);
	  }
	})(typeof window !== 'undefined' ? window : this, function (_window, windowExists) {
	  var FC = _window.FusionCharts;
	  FC.register('extension', ['private', 'StandardPeriodSelector', function () {
	    FC.registerComponent('extensions', 'StandardPeriodSelector', StandardPeriodSelector({FusionCharts: FC}));
	  }]);
	});


/***/ },
/* 2 */
/***/ function(module, exports) {

	'use strict';
	
	/**
	 * Class definition of StandardPeriodSelector
	 */
	
	module.exports = function (dep) {
	  class StandardPeriodSelector {
	    constructor () {
	      /**
	       * @private
	       */
	      this.ratio = 8;
	      this.toolbox = FusionCharts.getComponent('api', 'toolbox');
	      this.HorizontalToolbar = this.toolbox.HorizontalToolbar;
	      this.ComponentGroup = this.toolbox.ComponentGroup;
	      this.SymbolStore = this.toolbox.SymbolStore;
	      this.all = 1;
	      this.calculatedPeriods = [];
	      this.startDataset = 0;
	      // this.endDataset = this.globalReactiveModel.model['x-axis-absolute-range-end'];
	      this.startActiveWindow = 0;
	      this.endActiveWindow = 1;
	      this.standardCalculatedPeriods = [];
	      this.standardContexualPeriods = [];
	      this.startPointUnit = 0;
	      this.startPointMultiplier = 0;
	      this.clickedId = 'ALL';
	      this.noCalcButtons = 0;
	      this.calculatedButtonObj = {};
	      this.tdButtons = [
	        {
	          'name': 'YTD',
	          'abbreviation': 'YTD',
	          'parent': 'year',
	          'milliseconds': 31104000000,
	          'description': 'Year to Date'
	        },
	        {
	          'name': 'QTD',
	          'abbreviation': 'QTD',
	          'parent': 'month',
	          'multiplier': 3,
	          'milliseconds': 7776000000,
	          'description': 'Quarter to Date'
	        },
	        {
	          'name': 'MTD',
	          'abbreviation': 'MTD',
	          'parent': 'month',
	          'milliseconds': 2592000000,
	          'description': 'Month to Date'
	        },
	        {
	          'name': 'WTD',
	          'abbreviation': 'WTD',
	          'parent': 'day',
	          'multiplier': 7,
	          'milliseconds': 604800000,
	          'description': 'Week to Date'
	        },
	        {
	          'name': 'Y',
	          'abbreviation': 'Y',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Yesterday'
	        },
	        {
	          'name': 'T',
	          'abbreviation': 'T',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Today'
	        }
	      ];
	      this.config = {
	        anchorPositions: 'right',
	        all: '1',
	        contextual: '1',
	        calculated: '1',
	        tertiaryTimePeriods: {}
	      };
	    }
	
	    /**
	     * A function to generate the calculated buttons using
	     * the active range and the location of the active range
	     */
	    generateCalculatedButtons () {
	      var targetBlock = this.endActiveWindow - this.startDataset,
	        i = 0,
	        j = 0,
	        activeWindow = this.endActiveWindow - this.startActiveWindow,
	        count = 0;
	      this.standardCalculatedPeriods = [];
	      for (i = 0; i < this.timePeriods.length; i++) {
	        // checking whether the unit is applicable for the current target block
	        if (targetBlock / this.timePeriods[i].interval >= 1) {
	          // checking whether the unit is of the higher order and only multiplier 1 is applicable
	          if (Math.floor((activeWindow) / this.timePeriods[i].interval) < 1) {
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation.single,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].interval,
	              'name': this.timePeriods[i].name,
	              'multipliers': [1]
	            });
	          } else { // if the unit is of the order of the target block and calculating the multipliers
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation.single,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].interval,
	              'name': this.timePeriods[i].name,
	              'multipliers': []
	            });
	            // calculating and populating the applicable multpliers of each unit
	            for (j = 0; j < this.timePeriods[i].multipliers.length; j++) {
	              if (activeWindow / this.ratio < this.timePeriods[i].multipliers[j] * this.timePeriods[i].interval) {
	                this.standardCalculatedPeriods[this.standardCalculatedPeriods.length - 1].multipliers.push(
	                  this.timePeriods[i].multipliers[j]
	                  );
	              }
	            }
	          }
	        }
	      }
	      this.noCalcButtons = Infinity;
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = 0; j < this.standardCalculatedPeriods[i].multipliers.length; j++) {
	          ++count;
	          if (this.noCalcButtons > i) {
	            this.noCalcButtons = i;
	          }
	          if (count <= 4) {
	            this.startPointMultiplier = j;
	            this.startPointUnit = i;
	          }
	        }
	      }
	
	      // this.drawButtonsCalculated(this.standardCalculatedPeriods);
	    }
	
	    /**
	     * A function to generate the contextual buttons using
	     * the end point of the time-scale
	     */
	    generateContextualButtons () {
	      // generating an array with applicable TD buttons
	      var buttons = [],
	        i = 0,
	        endStamp = this.globalReactiveModel.model['x-axis-absolute-range-end'],
	        dateStart = endStamp - 2,
	        dateEnd = endStamp,
	        relativeTDButton = {};
	      for (; i < this.tdButtons.length; i++) {
	        dateStart = new Date(endStamp);
	        if (this.tdButtons[i].name === 'YTD') {
	          dateStart.setMonth(0);
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'MTD') {
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'QTD') {
	          dateStart.setMonth(11 - (dateStart.getMonth() % 4));
	          dateStart.setDate(0);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'WTD') {
	          dateStart.setDate(dateStart.getDate() - dateStart.getDay());
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'Y') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	          dateStart -= 86400000;
	        } else if (this.tdButtons[i].name === 'T') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	          if (+this.endDataset === +dateStart) {
	            dateStart = +dateStart - 86400000;
	          }
	        }
	
	        if (dateEnd < dateStart) {
	          continue;
	        } else {
	          this.tdButtons[i].dateStart = dateStart.valueOf();
	          this.tdButtons[i].dateEnd = dateEnd.valueOf();
	          buttons.push(this.tdButtons[i]);
	        }
	      }
	      relativeTDButton.milliseconds = Infinity;
	      for (i = 0; i < this.tdButtons.length; i++) {
	        if (Math.abs(this.tdButtons[i].milliseconds - (this.endActiveWindow - this.startActiveWindow)) < relativeTDButton.milliseconds) {
	          relativeTDButton.milliseconds = this.tdButtons[i].milliseconds;
	          relativeTDButton.name = this.tdButtons[i].abbreviation;
	        }
	      }
	
	      this.standardContexualPeriods = buttons;
	      // this.drawButtonsContextual(this.standardContexualPeriods);
	    }
	
	    processMultipliers (timeArr) {
	      for (let i = 0; i < timeArr.length; i++) {
	        let len = timeArr[i].possibleFactors.length;
	        timeArr[i].multipliers = [];
	        if (len === 1) {
	          timeArr[i].multipliers.push(timeArr[i].possibleFactors[0]);
	        } else if (len === 2) {
	          timeArr[i].multipliers.push(timeArr[i].possibleFactors[0]);
	          timeArr[i].multipliers.push(timeArr[i].possibleFactors[len - 1]);
	        } else {
	          timeArr[i].multipliers.push(timeArr[i].possibleFactors[0]);
	          timeArr[i].multipliers.push(Math.floor(timeArr[i].possibleFactors[len - 1] / 2));
	          timeArr[i].multipliers.push(timeArr[i].possibleFactors[len - 1]);
	        }
	      }
	      return timeArr;
	    }
	
	    /**
	     * A function to set the active period's
	     * start and end point
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of active period
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of active period
	     */
	    setActivePeriod () {
	      var start,
	        end,
	        temp = window.performance.now();
	      if (arguments.length === 1) {
	        end = this.globalReactiveModel.model['x-axis-visible-range-end'];
	        start = end - arguments[0];
	      } else if (arguments.length === 2) {
	        start = arguments[0];
	        end = arguments[1];
	      }
	      this.startActiveWindow = start;
	      this.endActiveWindow = end;
	      this.generateCalculatedButtons();
	      this.globalReactiveModel.model['x-axis-visible-range-start'] = this.startActiveWindow;
	      this.globalReactiveModel.model['x-axis-visible-range-end'] = this.endActiveWindow;
	      this.generateContextualButtons();
	    }
	
	    /**
	     * A function to set the start and end point of the
	     * entire time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of time-line
	     */
	
	    /**
	     * A function to set the object to set the user preferences
	     */
	    configure (config) {
	      this.config = config;
	    }
	
	    /**
	     * Fusioncharts life cycle method for extension
	     */
	    init (require) {
	      var instance = this;
	      require([
	        'xAxis',
	        'yAxis',
	        'graphics',
	        'chart',
	        'dataset',
	        'PlotManager',
	        'canvasConfig',
	        'MarkerManager',
	        'reactiveModel',
	        'globalReactiveModel',
	        'spaceManagerInstance',
	        'smartLabel',
	        'extData',
	        'chartInstance',
	        function (
	              xAxis,
	              yAxis,
	              graphics,
	              chart,
	              dataset,
	              plotManager,
	              canvasConfig,
	              markerManager,
	              reactiveModel,
	              globalReactiveModel,
	              spaceManagerInstance,
	              smartLabel,
	              extData,
	              chartInstance) {
	          instance.xAxis = xAxis;
	          instance.yAxis = yAxis;
	          instance.graphics = graphics;
	          instance.chart = chart;
	          instance.dataset = dataset;
	          instance.plotManager = plotManager;
	          instance.markerManager = markerManager;
	          instance.canvasConfig = canvasConfig;
	          instance.reactiveModel = reactiveModel;
	          instance.globalReactiveModel = globalReactiveModel;
	          instance.spaceManagerInstance = spaceManagerInstance;
	          instance.smartLabel = smartLabel;
	          instance.extData = extData;
	          instance.chartInstance = chartInstance;
	        }
	      ]);
	      this.spaceManagerInstance = instance.spaceManagerInstance;
	      this.globalReactiveModel = instance.globalReactiveModel;
	      this.endActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-end'];
	      this.startActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-start'];
	      this.startDataset = instance.globalReactiveModel.model['x-axis-absolute-range-start'];
	      this.endDataset = instance.globalReactiveModel.model['x-axis-absolute-range-end'];
	      // instance.globalReactiveModel.model['_x-axis-visible-range-start'] += 124416000000;
	      this.timeRules = this.chartInstance.apiInstance.getComponentStore();
	      this.timeRules = this.timeRules.getCanvasByIndex(0).composition.impl;
	      this.timeRules = this.timeRules.getDataAggregator();
	      this.timeRules = this.timeRules.getAggregationTimeRules();
	      this.timePeriods = this.processMultipliers(this.timeRules);
	      this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	      this.toolbars = [];
	      this.measurement = {};
	      this.flag = true;
	
	      this.toolbars.push(this.createToolbar());
	
	      this.globalReactiveModel.onPropsChange(['x-axis-visible-range-start', 'x-axis-visible-range-end'],
	        function (start, end) {
	          if (instance.flag) {
	            instance.flag = false;
	            instance.setActivePeriod(start[1], end[1]);
	            for (let i = 0; i < instance.standardCalculatedPeriods.length; i++) {
	              for (let j = 0; j < instance.standardCalculatedPeriods[i].multipliers.length; j++) {
	                if ((end[1] - start[1]) >= instance.timePeriods[i].multipliers[j] * instance.timePeriods[i].interval) {
	                  instance.clickedId = instance.timePeriods[i].multipliers[j] + instance.timePeriods[i].abbreviation.single;
	                }
	              }
	            }
	            instance.toolbar.dispose();
	            instance.toolbars.pop();
	            instance.toolbars.push(instance.createToolbar());
	            instance.getLogicalSpace();
	            instance.draw();
	          }
	        });
	      return this;
	    };
	
	    createToolbar () {
	      var unigroup,
	        toolbar,
	        calculatedButtons,
	        contextualButtons,
	        allButton,
	        self = this,
	        deductorAr = [],
	        startMultiplier,
	        deductor,
	        i,
	        j,
	        margin,
	        fromDateLabel,
	        group;
	
	      group = new this.toolbox.ComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	
	      unigroup = new this.toolbox.UniSelectComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      unigroup.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      group.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      toolbar = new this.HorizontalToolbar({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      toolbar.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      fromDateLabel = new this.toolbox.Label('Zoom:', {
	        smartLabel: this.smartLabel,
	        paper: this.graphics.paper
	      }, {
	        text: {
	          style: {
	            'font-family': '"Lucida Grande", sans-serif',
	            'font-size': '13',
	            'fill': '#696969',
	            'font-weight': 'bold'
	          }
	        },
	        container: {
	          height: 22
	        }
	      });
	      group.addSymbol(fromDateLabel);
	      allButton = new this.toolbox.Symbol('ALL', true, {
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      }, {
	        fill: '#ffffff',
	        labelFill: '#696969',
	        symbolStrokeWidth: '2',
	        stroke: '#ced5d4',
	        strokeWidth: '1',
	        hoverFill: '#ced5d4',
	        height: 22,
	        radius: 1,
	        margin: {
	          right: 5
	        },
	        btnTextStyle: {
	          'fontFamily': '"Lucida Grande", sans-serif',
	          'fontSize': '13',
	          'fill': '#696969',
	          'line-height': '1',
	          'letter-spacing': '-0.04em'
	        }
	      }).attachEventHandlers({
	        click: function () {
	          self.setActivePeriod(self.startDataset, self.endDataset);
	          toolbar.dispose();
	          self.clickedId = 'ALL';
	          // self.toolbars.pop();
	          // self.toolbars.push(self.createToolbar());
	          // self.getLogicalSpace();
	          // self.draw();
	          // self._ref.reAllocate(self.parentGroup);
	        },
	        tooltext: 'ALL'
	      });
	
	      unigroup.addSymbol(allButton);
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = this.standardCalculatedPeriods[i].multipliers.length - 1; j >= 0; j--) {
	          deductorAr.push(self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	        }
	      }
	
	      calculatedButtons = {};
	      for (let key in this.calculatedButtonObj) {
	        this.calculatedButtonObj[key].hide();
	      }
	      for (let i = self.startPointUnit; i >= 0; i--) {
	        if (i === self.startPointUnit) {
	          startMultiplier = self.startPointMultiplier;
	        } else {
	          startMultiplier = self.standardCalculatedPeriods[i].multipliers.length - 1;
	        }
	        for (let j = startMultiplier; j >= 0; j--) {
	          margin = (i === self.noCalcButtons && j === 0) ? 5 : 0;
	          let keyAbb = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	          if (this.calculatedButtonObj[keyAbb] === undefined) {
	            calculatedButtons = new this.toolbox.Symbol(keyAbb, true, {
	              paper: this.graphics.paper,
	              chart: this.chart,
	              smartLabel: this.smartLabel,
	              chartContainer: this.graphics.container
	            }, {
	              fill: '#ffffff',
	              labelFill: '#696969',
	              symbolStrokeWidth: '2',
	              stroke: '#ced5d4',
	              strokeWidth: '1',
	              hoverFill: '#ced5d4',
	              height: 22,
	              radius: 1,
	              margin: {
	                right: 0
	              },
	              btnTextStyle: {
	                'fontFamily': '"Lucida Grande", sans-serif',
	                'fontSize': '13',
	                'fill': '#696969',
	                'line-height': '1',
	                'letter-spacing': '-0.04em'
	              }
	            }).attachEventHandlers({
	              'click': function () {
	                deductor = (self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	                self.clickedId = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	                self.setActivePeriod(deductor);
	                // toolbar.dispose();
	                // self.toolbars.pop();
	                // self.toolbars.push(self.createToolbar());
	                // self.getLogicalSpace();
	                // self.draw();
	                // self._ref.reAllocate(self.parentGroup);
	                // this.toolbars[this.toolbars.length - 1] = this.createToolbar();
	              },
	              tooltext: self.standardCalculatedPeriods[i].multipliers[j] + ' ' + self.standardCalculatedPeriods[i].description
	            });
	            this.calculatedButtonObj[keyAbb] = calculatedButtons;
	          }
	          // unigroup.addSymbol(calculatedButtons[i]);
	          this.calculatedButtonObj[keyAbb].show();
	          unigroup.addSymbol(this.calculatedButtonObj[keyAbb]);
	        }
	      }
	
	      // for (let i = self.startPointUnit; i >= 0; i--) {
	      //   for (let j = startMultiplier; j >= 0; j--) {
	      //     let keyAbb = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	      //     unigroup.addSymbol(this.calculatedButtonObj[keyAbb]);
	      //   }
	      // }
	
	      contextualButtons = [];
	
	      for (let i = 0; i < this.standardContexualPeriods.length; i++) {
	        contextualButtons[i] = new this.toolbox.Symbol(this.standardContexualPeriods[i].abbreviation, true, {
	          paper: this.graphics.paper,
	          chart: this.chart,
	          smartLabel: this.smartLabel,
	          chartContainer: this.graphics.container
	        }, {
	          fill: '#ffffff',
	          labelFill: '#696969',
	          symbolStrokeWidth: '2',
	          stroke: '#ced5d4',
	          strokeWidth: '1',
	          height: 22,
	          hoverFill: '#ced5d4',
	          radius: 1,
	          margin: {
	            right: 0
	          },
	          btnTextStyle: {
	            'fontFamily': '"Lucida Grande", sans-serif',
	            'fontSize': '13',
	            'fill': '#696969',
	            'line-height': '1',
	            'letter-spacing': '-0.04em'
	          }
	        }).attachEventHandlers({
	          'click': function () {
	            self.setActivePeriod(self.standardContexualPeriods[i].dateStart, self.standardContexualPeriods[i].dateEnd);
	            self.clickedId = self.standardContexualPeriods[i].abbreviation;
	            // toolbar.dispose();
	            // self.toolbars.pop();
	            // self.toolbars.push(self.createToolbar());
	            // self.getLogicalSpace();
	            // self.draw();
	            // self._ref.reAllocate(self.parentGroup);
	          },
	          tooltext: this.standardContexualPeriods[i].description
	        });
	        unigroup.addSymbol(contextualButtons[i]);
	      }
	
	      this.SymbolStore.register('textBoxIcon', function (x, y, rad, w, h, padX, padY) {
	        var x1 = x - w / 2 + padX / 2,
	          x2 = x + w / 2 - padX / 2,
	          y1 = y - h / 2 + padY / 2,
	          y2 = y + h / 2 - padY / 2;
	
	        return ['M', x1, y1, 'L', x2, y1, 'L', x2, y2, 'L', x1, y2, 'Z'];
	      });
	
	      toolbar.addComponent(group);
	      toolbar.addComponent(unigroup);
	      this.toolbar = toolbar;
	      return toolbar;
	    };
	
	    getLogicalSpace (availableWidth = this._pWidth, availableHeight = this._pHeight) {
	      // availableWidth /= 2;
	      var logicalSpace,
	        width = 420, // width hardcoded; TODO: make it dynamic
	        height = 0,
	        i,
	        ln;
	
	      for (i = 0, ln = this.toolbars.length; i < ln; i++) {
	        logicalSpace = this.toolbars[i].getLogicalSpace(availableWidth, availableHeight);
	        // width = Math.max(logicalSpace.width, width);
	        height += logicalSpace.height;
	        this.toolbars[i].width = logicalSpace.width;
	        this.toolbars[i].height = logicalSpace.height;
	      }
	      height += this.padding;
	      return {
	        width: width,
	        height: height
	      };
	    };
	
	    getDefaultGroup () {
	      return this.parentGroup;
	    }
	
	    placeInCanvas () {
	      var self = this;
	      self.padding = 5;
	      self.spaceManagerInstance.add([{
	        name: function () {
	          return 'standard-period-selector-ext';
	        },
	        ref: function (obj) {
	          return obj['0'];
	        },
	        self: function () {
	          return self;
	        },
	        priority: function () {
	          return 2;
	        },
	        layout: function (obj) {
	          return obj.inline;
	        },
	        orientation: [{
	          type: function (obj) {
	            return obj.horizontal;
	          },
	          position: [{
	            type: function (obj) {
	              return obj.top;
	            },
	            alignment: [{
	              type: function (obj) {
	                return obj.left;
	              },
	              dimensions: [function () {
	                var parent = this.getParentComponentGroup();
	                self._ref = this;
	                return self.getLogicalSpace((self._pWidth = parent.getWidth()), (self._pHeight = parent.getHeight()));
	              }]
	            }]
	          }]
	        }]
	      }]);
	    };
	
	    setDrawingConfiguration (x, y, width, height, group) {
	      var mes = this.measurement;
	      mes.x = x;
	      mes.y = y;
	      mes.width = width;
	      mes.height = height;
	
	      this.parentGroup = group;
	
	      return this;
	    };
	
	    draw (x, y, width, height, group) {
	      var measurement = this.measurement,
	        toolbars = this.toolbars,
	        self = this,
	        ln,
	        i,
	        toolbar,
	        boundElement,
	        bBox,
	        x1,
	        x2,
	        y2,
	        selectLine,
	        model = this.globalReactiveModel;
	
	      this.flag = true;
	      selectLine = this.saveSelectLine || this.graphics.paper.path({
	        'stroke': '#c95a5a',
	        'stroke-width': '2px'
	      }).toFront();
	      x = x === undefined ? measurement.x : x;
	      y = y === undefined ? measurement.y : y;
	      width = width === undefined ? measurement.width : width;
	      height = height === undefined ? measurement.height : height;
	      group = group === undefined ? this.parentGroup : group;
	      if (width && height) {
	        for (i = 0, ln = toolbars.length; i < ln; i++) {
	          toolbar = toolbars[i];
	          toolbar.draw(x, y, group);
	        }
	      }
	      this.saveSelectLine = selectLine;
	      for (let i = 0, ii = toolbars[0].componentGroups[1].symbolList; i < ii.length; i++) {
	        if (ii[i].symbol === this.clickedId) {
	          boundElement = ii[i].getBoundElement();
	          bBox = boundElement.getBBox();
	          x1 = bBox.x;
	          x2 = bBox.x2;
	          y2 = bBox.y2;
	
	          // selectLine.attr({
	          //   path: ['M', x1 - 0.5, y2 - 0.5, 'L', x2 + 0.5, y2 - 0.5]
	          // });
	        }
	      }
	    };
	  }
	  return StandardPeriodSelector;
	};


/***/ }
/******/ ]);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNzcwNTZkZDEyMWU3ZWRmZWEyMTkiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDdENBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsMEZBQXlGLGlCQUFpQjtBQUMxRyxJQUFHO0FBQ0gsRUFBQzs7Ozs7OztBQ3RCRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QVE7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFxRSxlQUFlO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3ItZXM2Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDc3MDU2ZGQxMjFlN2VkZmVhMjE5IiwiJ3VzZSBzdHJpY3QnO1xuY29uc3QgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciA9IHJlcXVpcmUoJy4vc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yJyk7XG5cbndpbmRvdy5zdFBTID0gbmV3IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IoKTtcblxuOyhmdW5jdGlvbiAoZW52LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50XG4gICAgICAgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG4gICAgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dpbmRvdyB3aXRoIGRvY3VtZW50IG5vdCBwcmVzZW50Jyk7XG4gICAgICAgICB9XG4gICAgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuICAgICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW52LlN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG4gIH1cbn0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuICB2YXIgRkMgPSBfd2luZG93LkZ1c2lvbkNoYXJ0cztcbiAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdTdGFuZGFyZFBlcmlvZFNlbGVjdG9yJywgZnVuY3Rpb24gKCkge1xuICAgIEZDLnJlZ2lzdGVyQ29tcG9uZW50KCdleHRlbnNpb25zJywgJ1N0YW5kYXJkUGVyaW9kU2VsZWN0b3InLCBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKHtGdXNpb25DaGFydHM6IEZDfSkpO1xuICB9XSk7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDbGFzcyBkZWZpbml0aW9uIG9mIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3JcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChkZXApIHtcbiAgY2xhc3MgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgLyoqXG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICovXG4gICAgICB0aGlzLnJhdGlvID0gODtcbiAgICAgIHRoaXMudG9vbGJveCA9IEZ1c2lvbkNoYXJ0cy5nZXRDb21wb25lbnQoJ2FwaScsICd0b29sYm94Jyk7XG4gICAgICB0aGlzLkhvcml6b250YWxUb29sYmFyID0gdGhpcy50b29sYm94Lkhvcml6b250YWxUb29sYmFyO1xuICAgICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcbiAgICAgIHRoaXMuU3ltYm9sU3RvcmUgPSB0aGlzLnRvb2xib3guU3ltYm9sU3RvcmU7XG4gICAgICB0aGlzLmFsbCA9IDE7XG4gICAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IDA7XG4gICAgICAvLyB0aGlzLmVuZERhdGFzZXQgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSAwO1xuICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSAxO1xuICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuICAgICAgdGhpcy5zdGFydFBvaW50VW5pdCA9IDA7XG4gICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gMDtcbiAgICAgIHRoaXMuY2xpY2tlZElkID0gJ0FMTCc7XG4gICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSAwO1xuICAgICAgdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqID0ge307XG4gICAgICB0aGlzLnRkQnV0dG9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1lURCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdZVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAneWVhcicsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdZZWFyIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdRVEQnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnUVREJyxcbiAgICAgICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICAgICAnbXVsdGlwbGllcic6IDMsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDc3NzYwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1F1YXJ0ZXIgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ01URCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdNVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdNb250aCB0byBEYXRlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnV1REJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1dURCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtdWx0aXBsaWVyJzogNyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogNjA0ODAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdXZWVrIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdZJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuICAgICAgICAgICdwYXJlbnQnOiAnZGF5JyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llc3RlcmRheSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1QnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnVCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnVG9kYXknXG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgICAgYW5jaG9yUG9zaXRpb25zOiAncmlnaHQnLFxuICAgICAgICBhbGw6ICcxJyxcbiAgICAgICAgY29udGV4dHVhbDogJzEnLFxuICAgICAgICBjYWxjdWxhdGVkOiAnMScsXG4gICAgICAgIHRlcnRpYXJ5VGltZVBlcmlvZHM6IHt9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNhbGN1bGF0ZWQgYnV0dG9ucyB1c2luZ1xuICAgICAqIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgYWN0aXZlIHJhbmdlXG4gICAgICovXG4gICAgZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucyAoKSB7XG4gICAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuICAgICAgICBpID0gMCxcbiAgICAgICAgaiA9IDAsXG4gICAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyxcbiAgICAgICAgY291bnQgPSAwO1xuICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50aW1lUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIGFwcGxpY2FibGUgZm9yIHRoZSBjdXJyZW50IHRhcmdldCBibG9ja1xuICAgICAgICBpZiAodGFyZ2V0QmxvY2sgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsID49IDEpIHtcbiAgICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIG9mIHRoZSBoaWdoZXIgb3JkZXIgYW5kIG9ubHkgbXVsdGlwbGllciAxIGlzIGFwcGxpY2FibGVcbiAgICAgICAgICBpZiAoTWF0aC5mbG9vcigoYWN0aXZlV2luZG93KSAvIHRoaXMudGltZVBlcmlvZHNbaV0uaW50ZXJ2YWwpIDwgMSkge1xuICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlLFxuICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCxcbiAgICAgICAgICAgICAgJ25hbWUnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm5hbWUsXG4gICAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFsxXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHsgLy8gaWYgdGhlIHVuaXQgaXMgb2YgdGhlIG9yZGVyIG9mIHRoZSB0YXJnZXQgYmxvY2sgYW5kIGNhbGN1bGF0aW5nIHRoZSBtdWx0aXBsaWVyc1xuICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlLFxuICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCxcbiAgICAgICAgICAgICAgJ25hbWUnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm5hbWUsXG4gICAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0aW5nIGFuZCBwb3B1bGF0aW5nIHRoZSBhcHBsaWNhYmxlIG11bHRwbGllcnMgb2YgZWFjaCB1bml0XG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICBpZiAoYWN0aXZlV2luZG93IC8gdGhpcy5yYXRpbyA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW3RoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGggLSAxXS5tdWx0aXBsaWVycy5wdXNoKFxuICAgICAgICAgICAgICAgICAgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gSW5maW5pdHk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICArK2NvdW50O1xuICAgICAgICAgIGlmICh0aGlzLm5vQ2FsY0J1dHRvbnMgPiBpKSB7XG4gICAgICAgICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY291bnQgPD0gNCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IGo7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gaTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjb250ZXh0dWFsIGJ1dHRvbnMgdXNpbmdcbiAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG4gICAgICovXG4gICAgZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucyAoKSB7XG4gICAgICAvLyBnZW5lcmF0aW5nIGFuIGFycmF5IHdpdGggYXBwbGljYWJsZSBURCBidXR0b25zXG4gICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgZW5kU3RhbXAgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXSxcbiAgICAgICAgZGF0ZVN0YXJ0ID0gZW5kU3RhbXAgLSAyLFxuICAgICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG4gICAgICAgIHJlbGF0aXZlVERCdXR0b24gPSB7fTtcbiAgICAgIGZvciAoOyBpIDwgdGhpcy50ZEJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoZW5kU3RhbXApO1xuICAgICAgICBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1lURCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdRVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDExIC0gKGRhdGVTdGFydC5nZXRNb250aCgpICUgNCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKGRhdGVTdGFydC5nZXREYXRlKCkgLSBkYXRlU3RhcnQuZ2V0RGF5KCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnWScpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdUJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgICBpZiAoK3RoaXMuZW5kRGF0YXNldCA9PT0gK2RhdGVTdGFydCkge1xuICAgICAgICAgICAgZGF0ZVN0YXJ0ID0gK2RhdGVTdGFydCAtIDg2NDAwMDAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRlRW5kIDwgZGF0ZVN0YXJ0KSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50ZEJ1dHRvbnNbaV0uZGF0ZVN0YXJ0ID0gZGF0ZVN0YXJ0LnZhbHVlT2YoKTtcbiAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG4gICAgICAgICAgYnV0dG9ucy5wdXNoKHRoaXMudGRCdXR0b25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMgPSBJbmZpbml0eTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzIC0gKHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdykpIDwgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMpIHtcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IHRoaXMudGRCdXR0b25zW2ldLm1pbGxpc2Vjb25kcztcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm5hbWUgPSB0aGlzLnRkQnV0dG9uc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMgPSBidXR0b25zO1xuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NvbnRleHR1YWwodGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMpO1xuICAgIH1cblxuICAgIHByb2Nlc3NNdWx0aXBsaWVycyAodGltZUFycikge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aW1lQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBsZW4gPSB0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9ycy5sZW5ndGg7XG4gICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMgPSBbXTtcbiAgICAgICAgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG4gICAgICAgIH0gZWxzZSBpZiAobGVuID09PSAyKSB7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcbiAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKE1hdGguZmxvb3IodGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0gLyAyKSk7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzW2xlbiAtIDFdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRpbWVBcnI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIGFjdGl2ZSBwZXJpb2Qnc1xuICAgICAqIHN0YXJ0IGFuZCBlbmQgcG9pbnRcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBlbmQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuICAgICAqL1xuICAgIHNldEFjdGl2ZVBlcmlvZCAoKSB7XG4gICAgICB2YXIgc3RhcnQsXG4gICAgICAgIGVuZCxcbiAgICAgICAgdGVtcCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGVuZCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG4gICAgICAgIHN0YXJ0ID0gZW5kIC0gYXJndW1lbnRzWzBdO1xuICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHN0YXJ0ID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBlbmQgPSBhcmd1bWVudHNbMV07XG4gICAgICB9XG4gICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGVuZDtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddID0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgICAqIGVudGlyZSB0aW1lLWxpbmVcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgdGltZS1saW5lXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBvYmplY3QgdG8gc2V0IHRoZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICovXG4gICAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAgICovXG4gICAgaW5pdCAocmVxdWlyZSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHJlcXVpcmUoW1xuICAgICAgICAneEF4aXMnLFxuICAgICAgICAneUF4aXMnLFxuICAgICAgICAnZ3JhcGhpY3MnLFxuICAgICAgICAnY2hhcnQnLFxuICAgICAgICAnZGF0YXNldCcsXG4gICAgICAgICdQbG90TWFuYWdlcicsXG4gICAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAgICdyZWFjdGl2ZU1vZGVsJyxcbiAgICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgICAnc21hcnRMYWJlbCcsXG4gICAgICAgICdleHREYXRhJyxcbiAgICAgICAgJ2NoYXJ0SW5zdGFuY2UnLFxuICAgICAgICBmdW5jdGlvbiAoXG4gICAgICAgICAgICAgIHhBeGlzLFxuICAgICAgICAgICAgICB5QXhpcyxcbiAgICAgICAgICAgICAgZ3JhcGhpY3MsXG4gICAgICAgICAgICAgIGNoYXJ0LFxuICAgICAgICAgICAgICBkYXRhc2V0LFxuICAgICAgICAgICAgICBwbG90TWFuYWdlcixcbiAgICAgICAgICAgICAgY2FudmFzQ29uZmlnLFxuICAgICAgICAgICAgICBtYXJrZXJNYW5hZ2VyLFxuICAgICAgICAgICAgICByZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBnbG9iYWxSZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBzcGFjZU1hbmFnZXJJbnN0YW5jZSxcbiAgICAgICAgICAgICAgc21hcnRMYWJlbCxcbiAgICAgICAgICAgICAgZXh0RGF0YSxcbiAgICAgICAgICAgICAgY2hhcnRJbnN0YW5jZSkge1xuICAgICAgICAgIGluc3RhbmNlLnhBeGlzID0geEF4aXM7XG4gICAgICAgICAgaW5zdGFuY2UueUF4aXMgPSB5QXhpcztcbiAgICAgICAgICBpbnN0YW5jZS5ncmFwaGljcyA9IGdyYXBoaWNzO1xuICAgICAgICAgIGluc3RhbmNlLmNoYXJ0ID0gY2hhcnQ7XG4gICAgICAgICAgaW5zdGFuY2UuZGF0YXNldCA9IGRhdGFzZXQ7XG4gICAgICAgICAgaW5zdGFuY2UucGxvdE1hbmFnZXIgPSBwbG90TWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5tYXJrZXJNYW5hZ2VyID0gbWFya2VyTWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5jYW52YXNDb25maWcgPSBjYW52YXNDb25maWc7XG4gICAgICAgICAgaW5zdGFuY2UucmVhY3RpdmVNb2RlbCA9IHJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBzcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgICAgICBpbnN0YW5jZS5zbWFydExhYmVsID0gc21hcnRMYWJlbDtcbiAgICAgICAgICBpbnN0YW5jZS5leHREYXRhID0gZXh0RGF0YTtcbiAgICAgICAgICBpbnN0YW5jZS5jaGFydEluc3RhbmNlID0gY2hhcnRJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgXSk7XG4gICAgICB0aGlzLnNwYWNlTWFuYWdlckluc3RhbmNlID0gaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcbiAgICAgIC8vIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ194LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddICs9IDEyNDQxNjAwMDAwMDtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy5jaGFydEluc3RhbmNlLmFwaUluc3RhbmNlLmdldENvbXBvbmVudFN0b3JlKCk7XG4gICAgICB0aGlzLnRpbWVSdWxlcyA9IHRoaXMudGltZVJ1bGVzLmdldENhbnZhc0J5SW5kZXgoMCkuY29tcG9zaXRpb24uaW1wbDtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0RGF0YUFnZ3JlZ2F0b3IoKTtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMoKTtcbiAgICAgIHRoaXMudGltZVBlcmlvZHMgPSB0aGlzLnByb2Nlc3NNdWx0aXBsaWVycyh0aGlzLnRpbWVSdWxlcyk7XG4gICAgICB0aGlzLnNldEFjdGl2ZVBlcmlvZCh0aGlzLnN0YXJ0QWN0aXZlV2luZG93LCB0aGlzLmVuZEFjdGl2ZVdpbmRvdyk7XG4gICAgICB0aGlzLnRvb2xiYXJzID0gW107XG4gICAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG4gICAgICB0aGlzLmZsYWcgPSB0cnVlO1xuXG4gICAgICB0aGlzLnRvb2xiYXJzLnB1c2godGhpcy5jcmVhdGVUb29sYmFyKCkpO1xuXG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwub25Qcm9wc0NoYW5nZShbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0JywgJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLFxuICAgICAgICBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICAgIGlmIChpbnN0YW5jZS5mbGFnKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZXRBY3RpdmVQZXJpb2Qoc3RhcnRbMV0sIGVuZFsxXSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluc3RhbmNlLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnN0YW5jZS5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKChlbmRbMV0gLSBzdGFydFsxXSkgPj0gaW5zdGFuY2UudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCkge1xuICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY2xpY2tlZElkID0gaW5zdGFuY2UudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5zdGFuY2UudG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgICBpbnN0YW5jZS50b29sYmFycy5wb3AoKTtcbiAgICAgICAgICAgIGluc3RhbmNlLnRvb2xiYXJzLnB1c2goaW5zdGFuY2UuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgICAgICAgIGluc3RhbmNlLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgaW5zdGFuY2UuZHJhdygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgY3JlYXRlVG9vbGJhciAoKSB7XG4gICAgICB2YXIgdW5pZ3JvdXAsXG4gICAgICAgIHRvb2xiYXIsXG4gICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zLFxuICAgICAgICBjb250ZXh0dWFsQnV0dG9ucyxcbiAgICAgICAgYWxsQnV0dG9uLFxuICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgZGVkdWN0b3JBciA9IFtdLFxuICAgICAgICBzdGFydE11bHRpcGxpZXIsXG4gICAgICAgIGRlZHVjdG9yLFxuICAgICAgICBpLFxuICAgICAgICBqLFxuICAgICAgICBtYXJnaW4sXG4gICAgICAgIGZyb21EYXRlTGFiZWwsXG4gICAgICAgIGdyb3VwO1xuXG4gICAgICBncm91cCA9IG5ldyB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXAoe1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9KTtcblxuICAgICAgdW5pZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LlVuaVNlbGVjdENvbXBvbmVudEdyb3VwKHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSk7XG4gICAgICB1bmlncm91cC5zZXRDb25maWcoe1xuICAgICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgICAgfSk7XG4gICAgICBncm91cC5zZXRDb25maWcoe1xuICAgICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgICAgfSk7XG4gICAgICB0b29sYmFyID0gbmV3IHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIoe1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9KTtcbiAgICAgIHRvb2xiYXIuc2V0Q29uZmlnKHtcbiAgICAgICAgZmlsbDogJyNmZmYnLFxuICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICAgIH0pO1xuICAgICAgZnJvbURhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ1pvb206Jywge1xuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG4gICAgICB9LCB7XG4gICAgICAgIHRleHQ6IHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgJ2ZvbnQtZmFtaWx5JzogJ1wiTHVjaWRhIEdyYW5kZVwiLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICAgICdmb250LXNpemUnOiAnMTMnLFxuICAgICAgICAgICAgJ2ZpbGwnOiAnIzY5Njk2OScsXG4gICAgICAgICAgICAnZm9udC13ZWlnaHQnOiAnYm9sZCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRhaW5lcjoge1xuICAgICAgICAgIGhlaWdodDogMjJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG4gICAgICBhbGxCdXR0b24gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCgnQUxMJywgdHJ1ZSwge1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9LCB7XG4gICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcbiAgICAgICAgbGFiZWxGaWxsOiAnIzY5Njk2OScsXG4gICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAnMicsXG4gICAgICAgIHN0cm9rZTogJyNjZWQ1ZDQnLFxuICAgICAgICBzdHJva2VXaWR0aDogJzEnLFxuICAgICAgICBob3ZlckZpbGw6ICcjY2VkNWQ0JyxcbiAgICAgICAgaGVpZ2h0OiAyMixcbiAgICAgICAgcmFkaXVzOiAxLFxuICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICByaWdodDogNVxuICAgICAgICB9LFxuICAgICAgICBidG5UZXh0U3R5bGU6IHtcbiAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgJ2ZvbnRTaXplJzogJzEzJyxcbiAgICAgICAgICAnZmlsbCc6ICcjNjk2OTY5JyxcbiAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG4gICAgICAgICAgJ2xldHRlci1zcGFjaW5nJzogJy0wLjA0ZW0nXG4gICAgICAgIH1cbiAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuc3RhcnREYXRhc2V0LCBzZWxmLmVuZERhdGFzZXQpO1xuICAgICAgICAgIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gJ0FMTCc7XG4gICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wb3AoKTtcbiAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgIC8vIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG4gICAgICAgICAgLy8gc2VsZi5kcmF3KCk7XG4gICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRvb2x0ZXh0OiAnQUxMJ1xuICAgICAgfSk7XG5cbiAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChhbGxCdXR0b24pO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmb3IgKGogPSB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICBkZWR1Y3RvckFyLnB1c2goc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSB7fTtcbiAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmopIHtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleV0uaGlkZSgpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IHNlbGYuc3RhcnRQb2ludFVuaXQ7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGlmIChpID09PSBzZWxmLnN0YXJ0UG9pbnRVbml0KSB7XG4gICAgICAgICAgc3RhcnRNdWx0aXBsaWVyID0gc2VsZi5zdGFydFBvaW50TXVsdGlwbGllcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRNdWx0aXBsaWVyOyBqID49IDA7IGotLSkge1xuICAgICAgICAgIG1hcmdpbiA9IChpID09PSBzZWxmLm5vQ2FsY0J1dHRvbnMgJiYgaiA9PT0gMCkgPyA1IDogMDtcbiAgICAgICAgICBsZXQga2V5QWJiID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgICBpZiAodGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbChrZXlBYmIsIHRydWUsIHtcbiAgICAgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuICAgICAgICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICAgICAgICBzdHJva2U6ICcjY2VkNWQ0JyxcbiAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcbiAgICAgICAgICAgICAgaG92ZXJGaWxsOiAnI2NlZDVkNCcsXG4gICAgICAgICAgICAgIGhlaWdodDogMjIsXG4gICAgICAgICAgICAgIHJhZGl1czogMSxcbiAgICAgICAgICAgICAgbWFyZ2luOiB7XG4gICAgICAgICAgICAgICAgcmlnaHQ6IDBcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgICAgICAgICAgJ2ZvbnRGYW1pbHknOiAnXCJMdWNpZGEgR3JhbmRlXCIsIHNhbnMtc2VyaWYnLFxuICAgICAgICAgICAgICAgICdmb250U2l6ZSc6ICcxMycsXG4gICAgICAgICAgICAgICAgJ2ZpbGwnOiAnIzY5Njk2OScsXG4gICAgICAgICAgICAgICAgJ2xpbmUtaGVpZ2h0JzogJzEnLFxuICAgICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZyc6ICctMC4wNGVtJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRlZHVjdG9yID0gKHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5taWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChkZWR1Y3Rvcik7XG4gICAgICAgICAgICAgICAgLy8gdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wb3AoKTtcbiAgICAgICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgICAgIC8vIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG4gICAgICAgICAgICAgICAgLy8gc2VsZi5kcmF3KCk7XG4gICAgICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy50b29sYmFyc1t0aGlzLnRvb2xiYXJzLmxlbmd0aCAtIDFdID0gdGhpcy5jcmVhdGVUb29sYmFyKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRvb2x0ZXh0OiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyAnICcgKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uZGVzY3JpcHRpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0gPSBjYWxjdWxhdGVkQnV0dG9ucztcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gdW5pZ3JvdXAuYWRkU3ltYm9sKGNhbGN1bGF0ZWRCdXR0b25zW2ldKTtcbiAgICAgICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXS5zaG93KCk7XG4gICAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBmb3IgKGxldCBpID0gc2VsZi5zdGFydFBvaW50VW5pdDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIC8vICAgZm9yIChsZXQgaiA9IHN0YXJ0TXVsdGlwbGllcjsgaiA+PSAwOyBqLS0pIHtcbiAgICAgIC8vICAgICBsZXQga2V5QWJiID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgIC8vICAgICB1bmlncm91cC5hZGRTeW1ib2wodGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0pO1xuICAgICAgLy8gICB9XG4gICAgICAvLyB9XG5cbiAgICAgIGNvbnRleHR1YWxCdXR0b25zID0gW107XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29udGV4dHVhbEJ1dHRvbnNbaV0gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcbiAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgICAgbGFiZWxGaWxsOiAnIzY5Njk2OScsXG4gICAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcbiAgICAgICAgICBzdHJva2U6ICcjY2VkNWQ0JyxcbiAgICAgICAgICBzdHJva2VXaWR0aDogJzEnLFxuICAgICAgICAgIGhlaWdodDogMjIsXG4gICAgICAgICAgaG92ZXJGaWxsOiAnI2NlZDVkNCcsXG4gICAgICAgICAgcmFkaXVzOiAxLFxuICAgICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgICAgcmlnaHQ6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgICAgJ2ZvbnRGYW1pbHknOiAnXCJMdWNpZGEgR3JhbmRlXCIsIHNhbnMtc2VyaWYnLFxuICAgICAgICAgICAgJ2ZvbnRTaXplJzogJzEzJyxcbiAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuICAgICAgICAgICAgJ2xpbmUtaGVpZ2h0JzogJzEnLFxuICAgICAgICAgICAgJ2xldHRlci1zcGFjaW5nJzogJy0wLjA0ZW0nXG4gICAgICAgICAgfVxuICAgICAgICB9KS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kYXRlU3RhcnQsIHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmRhdGVFbmQpO1xuICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgICAvLyB0b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b29sdGV4dDogdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uZGVzY3JpcHRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChjb250ZXh0dWFsQnV0dG9uc1tpXSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuU3ltYm9sU3RvcmUucmVnaXN0ZXIoJ3RleHRCb3hJY29uJywgZnVuY3Rpb24gKHgsIHksIHJhZCwgdywgaCwgcGFkWCwgcGFkWSkge1xuICAgICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcbiAgICAgICAgICB4MiA9IHggKyB3IC8gMiAtIHBhZFggLyAyLFxuICAgICAgICAgIHkxID0geSAtIGggLyAyICsgcGFkWSAvIDIsXG4gICAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblxuICAgICAgICByZXR1cm4gWydNJywgeDEsIHkxLCAnTCcsIHgyLCB5MSwgJ0wnLCB4MiwgeTIsICdMJywgeDEsIHkyLCAnWiddO1xuICAgICAgfSk7XG5cbiAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KGdyb3VwKTtcbiAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KHVuaWdyb3VwKTtcbiAgICAgIHRoaXMudG9vbGJhciA9IHRvb2xiYXI7XG4gICAgICByZXR1cm4gdG9vbGJhcjtcbiAgICB9O1xuXG4gICAgZ2V0TG9naWNhbFNwYWNlIChhdmFpbGFibGVXaWR0aCA9IHRoaXMuX3BXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0ID0gdGhpcy5fcEhlaWdodCkge1xuICAgICAgLy8gYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICAgIHZhciBsb2dpY2FsU3BhY2UsXG4gICAgICAgIHdpZHRoID0gNDIwLCAvLyB3aWR0aCBoYXJkY29kZWQ7IFRPRE86IG1ha2UgaXQgZHluYW1pY1xuICAgICAgICBoZWlnaHQgPSAwLFxuICAgICAgICBpLFxuICAgICAgICBsbjtcblxuICAgICAgZm9yIChpID0gMCwgbG4gPSB0aGlzLnRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgbG9naWNhbFNwYWNlID0gdGhpcy50b29sYmFyc1tpXS5nZXRMb2dpY2FsU3BhY2UoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIC8vIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG4gICAgICAgIGhlaWdodCArPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgICB9XG4gICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICBoZWlnaHQ6IGhlaWdodFxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgZ2V0RGVmYXVsdEdyb3VwICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhcmVudEdyb3VwO1xuICAgIH1cblxuICAgIHBsYWNlSW5DYW52YXMgKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICAgIHNlbGYuc3BhY2VNYW5hZ2VySW5zdGFuY2UuYWRkKFt7XG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1leHQnO1xuICAgICAgICB9LFxuICAgICAgICByZWY6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGY6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpb3JpdHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgfSxcbiAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIG9iai5pbmxpbmU7XG4gICAgICAgIH0sXG4gICAgICAgIG9yaWVudGF0aW9uOiBbe1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmouaG9yaXpvbnRhbDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvc2l0aW9uOiBbe1xuICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLnRvcDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG4gICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmxlZnQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRpbWVuc2lvbnM6IFtmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9yZWYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldExvZ2ljYWxTcGFjZSgoc2VsZi5fcFdpZHRoID0gcGFyZW50LmdldFdpZHRoKCkpLCAoc2VsZi5fcEhlaWdodCA9IHBhcmVudC5nZXRIZWlnaHQoKSkpO1xuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV0pO1xuICAgIH07XG5cbiAgICBzZXREcmF3aW5nQ29uZmlndXJhdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuICAgICAgbWVzLnggPSB4O1xuICAgICAgbWVzLnkgPSB5O1xuICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG4gICAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBkcmF3ICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lYXN1cmVtZW50ID0gdGhpcy5tZWFzdXJlbWVudCxcbiAgICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgbG4sXG4gICAgICAgIGksXG4gICAgICAgIHRvb2xiYXIsXG4gICAgICAgIGJvdW5kRWxlbWVudCxcbiAgICAgICAgYkJveCxcbiAgICAgICAgeDEsXG4gICAgICAgIHgyLFxuICAgICAgICB5MixcbiAgICAgICAgc2VsZWN0TGluZSxcbiAgICAgICAgbW9kZWwgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG5cbiAgICAgIHRoaXMuZmxhZyA9IHRydWU7XG4gICAgICBzZWxlY3RMaW5lID0gdGhpcy5zYXZlU2VsZWN0TGluZSB8fCB0aGlzLmdyYXBoaWNzLnBhcGVyLnBhdGgoe1xuICAgICAgICAnc3Ryb2tlJzogJyNjOTVhNWEnLFxuICAgICAgICAnc3Ryb2tlLXdpZHRoJzogJzJweCdcbiAgICAgIH0pLnRvRnJvbnQoKTtcbiAgICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcbiAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcbiAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcbiAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcbiAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc2F2ZVNlbGVjdExpbmUgPSBzZWxlY3RMaW5lO1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdG9vbGJhcnNbMF0uY29tcG9uZW50R3JvdXBzWzFdLnN5bWJvbExpc3Q7IGkgPCBpaS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaWlbaV0uc3ltYm9sID09PSB0aGlzLmNsaWNrZWRJZCkge1xuICAgICAgICAgIGJvdW5kRWxlbWVudCA9IGlpW2ldLmdldEJvdW5kRWxlbWVudCgpO1xuICAgICAgICAgIGJCb3ggPSBib3VuZEVsZW1lbnQuZ2V0QkJveCgpO1xuICAgICAgICAgIHgxID0gYkJveC54O1xuICAgICAgICAgIHgyID0gYkJveC54MjtcbiAgICAgICAgICB5MiA9IGJCb3gueTI7XG5cbiAgICAgICAgICAvLyBzZWxlY3RMaW5lLmF0dHIoe1xuICAgICAgICAgIC8vICAgcGF0aDogWydNJywgeDEgLSAwLjUsIHkyIC0gMC41LCAnTCcsIHgyICsgMC41LCB5MiAtIDAuNV1cbiAgICAgICAgICAvLyB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdfQ==

/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(1);


/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	const StandardPeriodSelector = __webpack_require__(2);
	
	window.stPS = new StandardPeriodSelector();
	
	;(function (env, factory) {
	  if (typeof module === 'object' && module.exports) {
	    module.exports = env.document
	       ? factory(env) : function (win) {
	         if (!win.document) {
	           throw new Error('Window with document not present');
	         }
	         return factory(win, true);
	       };
	  } else {
	    env.StandardPeriodSelector = factory(env, true);
	  }
	})(typeof window !== 'undefined' ? window : this, function (_window, windowExists) {
	  var FC = _window.FusionCharts;
	  FC.register('extension', ['private', 'StandardPeriodSelector', function () {
	    FC.registerComponent('extensions', 'StandardPeriodSelector', StandardPeriodSelector({FusionCharts: FC}));
	  }]);
	});


/***/ },
/* 2 */
/***/ function(module, exports) {

	'use strict';
	
	/**
	 * Class definition of StandardPeriodSelector
	 */
	
	class StandardPeriodSelector {
	  constructor () {
	    /**
	     * @private
	     */
	    this.ratio = 8;
	    this.toolbox = FusionCharts.getComponent('api', 'toolbox');
	    this.HorizontalToolbar = this.toolbox.HorizontalToolbar;
	    this.ComponentGroup = this.toolbox.ComponentGroup;
	    this.SymbolStore = this.toolbox.SymbolStore;
	    this.all = 1;
	    this.calculatedPeriods = [];
	    this.startDataset = 0;
	    // this.endDataset = this.globalReactiveModel.model['x-axis-absolute-range-end'];
	    this.startActiveWindow = 0;
	    this.endActiveWindow = 1;
	    this.standardCalculatedPeriods = [];
	    this.standardContexualPeriods = [];
	    this.startPointUnit = 0;
	    this.startPointMultiplier = 0;
	    this.clickedId;
	    this.noCalcButtons = 0;
	    this.timePeriods = [{
	      'name': 'second',
	      'milliseconds': 1000,
	      'startingPoint': 0,
	      'total': 60,
	      'abbreviation': 'sec',
	      'description': 'SECOND',
	      'parent': 'minute',
	      'multipliers': [1, 5, 15, 30]
	    }, {
	      'name': 'minute',
	      'milliseconds': 60000,
	      'startingPoint': 0,
	      'total': 60,
	      'abbreviation': 'min',
	      'description': 'MINUTE',
	      'parent': 'hour',
	      'multipliers': [1, 5, 15, 30]
	    }, {
	      'name': 'hour',
	      'milliseconds': 3600000,
	      'startingPoint': 0,
	      'total': 24,
	      'abbreviation': 'hr',
	      'description': 'HOUR',
	      'parent': 'day',
	      'multipliers': [1, 3, 6, 12]
	    }, {
	      'name': 'day',
	      'milliseconds': 86400000,
	      'startingPoint': 0,
	      'total': 30,
	      'abbreviation': 'D',
	      'description': 'DAY',
	      'parent': 'month',
	      'multipliers': [1, 7, 15]
	    }, {
	      'name': 'month',
	      'milliseconds': 2592000000,
	      'startingPoint': 0,
	      'total': 12,
	      'abbreviation': 'M',
	      'description': 'MONTH',
	      'parent': 'year',
	      'multipliers': [1, 3, 6]
	    }, {
	      'name': 'year',
	      'milliseconds': 31104000000,
	      'startingPoint': 0,
	      'abbreviation': 'Y',
	      'description': 'YEAR',
	      'multipliers': [1, 3, 5]
	    }];
	    this.tdButtons = [
	      {
	        'name': 'YTD',
	        'abbreviation': 'YTD',
	        'parent': 'year',
	        'milliseconds': 31104000000,
	        'description': 'Year to Date'
	      },
	      {
	        'name': 'QTD',
	        'abbreviation': 'QTD',
	        'parent': 'month',
	        'multiplier': 3,
	        'milliseconds': 7776000000,
	        'description': 'Quarter to Date'
	      },
	      {
	        'name': 'MTD',
	        'abbreviation': 'MTD',
	        'parent': 'month',
	        'milliseconds': 2592000000,
	        'description': 'Month to Date'
	      },
	      {
	        'name': 'WTD',
	        'abbreviation': 'WTD',
	        'parent': 'day',
	        'multiplier': 7,
	        'milliseconds': 604800000,
	        'description': 'Week to Date'
	      },
	      {
	        'name': 'Y',
	        'abbreviation': 'Y',
	        'parent': 'day',
	        'milliseconds': 86400000,
	        'description': 'Yesterday'
	      },
	      {
	        'name': 'T',
	        'abbreviation': 'T',
	        'parent': 'day',
	        'milliseconds': 86400000,
	        'description': 'Today'
	      }
	    ];
	    this.config = {
	      anchorPositions: 'right',
	      all: '1',
	      contextual: '1',
	      calculated: '1',
	      tertiaryTimePeriods: {}
	    };
	  }
	
	  /**
	   * A function to generate the calculated buttons using
	   * the active range and the location of the active range
	   */
	  generateCalculatedButtons () {
	    var targetBlock = this.endActiveWindow - this.startDataset,
	      i = 0,
	      j = 0,
	      activeWindow = this.endActiveWindow - this.startActiveWindow,
	      count = 0;
	    this.standardCalculatedPeriods = [];
	    for (i = 0; i < this.timePeriods.length; i++) {
	      // checking whether the unit is applicable for the current target block
	      if (targetBlock / this.timePeriods[i].milliseconds >= 1) {
	        // checking whether the unit is of the higher order and only multiplier 1 is applicable
	        if (Math.floor((activeWindow) / this.timePeriods[i].milliseconds) < 1) {
	          this.standardCalculatedPeriods.push({
	            'abbreviation': this.timePeriods[i].abbreviation,
	            'description': this.timePeriods[i].description,
	            'milliseconds': this.timePeriods[i].milliseconds,
	            'multipliers': [1]
	          });
	        } else { // if the unit is of the order of the target block and calculating the multipliers
	          this.standardCalculatedPeriods.push({
	            'abbreviation': this.timePeriods[i].abbreviation,
	            'description': this.timePeriods[i].description,
	            'milliseconds': this.timePeriods[i].milliseconds,
	            'multipliers': []
	          });
	          // calculating and populating the applicable multpliers of each unit
	          for (j = 0; j < this.timePeriods[i].multipliers.length; j++) {
	            if (activeWindow / this.ratio < this.timePeriods[i].multipliers[j] * this.timePeriods[i].milliseconds) {
	              this.standardCalculatedPeriods[this.standardCalculatedPeriods.length - 1].multipliers.push(
	                this.timePeriods[i].multipliers[j]
	                );
	            }
	          }
	        }
	      }
	    }
	    this.noCalcButtons = Infinity;
	    for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	      for (j = 0; j < this.standardCalculatedPeriods[i].multipliers.length; j++) {
	        ++count;
	        if (this.noCalcButtons > i) {
	          this.noCalcButtons = i;
	        }
	        if (count <= 4) {
	          this.startPointMultiplier = j;
	          this.startPointUnit = i;
	        }
	      }
	    }
	
	    // this.drawButtonsCalculated(this.standardCalculatedPeriods);
	  }
	
	  /**
	   * A function to generate the contextual buttons using
	   * the end point of the time-scale
	   */
	  generateContextualButtons () {
	    // generating an array with applicable TD buttons
	    var buttons = [],
	      i = 0,
	      endStamp = this.globalReactiveModel.model['x-axis-absolute-range-end'],
	      dateStart = endStamp - 2,
	      dateEnd = endStamp,
	      relativeTDButton = {};
	    for (; i < this.tdButtons.length; i++) {
	      dateStart = new Date(endStamp);
	      if (this.tdButtons[i].name === 'YTD') {
	        dateStart.setMonth(0);
	        dateStart.setDate(1);
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	      } else if (this.tdButtons[i].name === 'MTD') {
	        dateStart.setDate(1);
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	      } else if (this.tdButtons[i].name === 'QTD') {
	        dateStart.setMonth(11 - (dateStart.getMonth() % 4));
	        dateStart.setDate(0);
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	      } else if (this.tdButtons[i].name === 'WTD') {
	        dateStart.setDate(dateStart.getDate() - dateStart.getDay());
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	      } else if (this.tdButtons[i].name === 'Y') {
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	        dateStart -= 86400000;
	      } else if (this.tdButtons[i].name === 'T') {
	        dateStart.setHours(0);
	        dateStart.setMinutes(0);
	        dateStart.setSeconds(0);
	      }
	
	      if (dateEnd < dateStart) {
	        continue;
	      } else {
	        this.tdButtons[i].dateStart = dateStart.valueOf();
	        this.tdButtons[i].dateEnd = dateEnd.valueOf();
	        buttons.push(this.tdButtons[i]);
	      }
	    }
	    relativeTDButton.milliseconds = Infinity;
	    for (i = 0; i < this.tdButtons.length; i++) {
	      if (Math.abs(this.tdButtons[i].milliseconds - (this.endActiveWindow - this.startActiveWindow)) < relativeTDButton.milliseconds) {
	        relativeTDButton.milliseconds = this.tdButtons[i].milliseconds;
	        relativeTDButton.name = this.tdButtons[i].abbreviation;
	      }
	    }
	
	    this.standardContexualPeriods = buttons;
	    // this.drawButtonsContextual(this.standardContexualPeriods);
	  }
	
	  /**
	   * A function to set the active period's
	   * start and end point
	   * @param  {number} date stamp - A UNIX timestamp to be set as the start point of active period
	   * @param  {number} date stamp - A UNIX timestamp to be set as the end point of active period
	   */
	  setActivePeriod () {
	    var start,
	      end;
	    if (arguments.length === 1) {
	      end = this.globalReactiveModel.model['x-axis-visible-range-end'];
	      start = end - arguments[0];
	    } else if (arguments.length === 2) {
	      start = arguments[0];
	      end = arguments[1];
	    }
	
	    this.startActiveWindow = start;
	    this.endActiveWindow = end;
	    this.generateCalculatedButtons();
	    this.globalReactiveModel.model['x-axis-visible-range-start'] = this.startActiveWindow;
	    this.globalReactiveModel.model['x-axis-visible-range-end'] = this.endActiveWindow;
	    this.generateContextualButtons();
	  }
	
	  /**
	   * A function to set the start and end point of the
	   * entire time-line
	   * @param  {number} date stamp - A UNIX timestamp to be set as the start point of time-line
	   * @param  {number} date stamp - A UNIX timestamp to be set as the end point of time-line
	   */
	  setTimeline (start, end) {
	    this.startDataset = start;
	    this.endDataset = end;
	    document.getElementById('startActiveRange').innerHTML = new Date(this.startDataset);
	    document.getElementById('endActiveRange').innerHTML = new Date(this.endDataset);
	    this.generateCalculatedButtons();
	  }
	
	  /**
	   * A function to set the object to set the user preferences
	   */
	  configure (config) {
	    this.config = config;
	  }
	
	  /**
	   * Fusioncharts life cycle method for extension
	   */
	  init (require) {
	    var instance = this;
	    require([
	      'xAxis',
	      'yAxis',
	      'graphics',
	      'chart',
	      'dataset',
	      'PlotManager',
	      'canvasConfig',
	      'MarkerManager',
	      'reactiveModel',
	      'globalReactiveModel',
	      'spaceManagerInstance',
	      'smartLabel',
	      function (
	            xAxis,
	            yAxis,
	            graphics,
	            chart,
	            dataset,
	            plotManager,
	            canvasConfig,
	            markerManager,
	            reactiveModel,
	            globalReactiveModel,
	            spaceManagerInstance,
	            smartLabel) {
	        instance.xAxis = xAxis;
	        instance.yAxis = yAxis;
	        instance.graphics = graphics;
	        instance.chart = chart;
	        instance.dataset = dataset;
	        instance.plotManager = plotManager;
	        instance.markerManager = markerManager;
	        instance.canvasConfig = canvasConfig;
	        instance.reactiveModel = reactiveModel;
	        instance.globalReactiveModel = globalReactiveModel;
	        instance.spaceManagerInstance = spaceManagerInstance;
	        instance.smartLabel = smartLabel;
	      }
	    ]);
	    this.spaceManagerInstance = instance.spaceManagerInstance;
	    this.globalReactiveModel = instance.globalReactiveModel;
	    this.endActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-end'];
	    this.startActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-start'];
	    this.startDataset = instance.globalReactiveModel.model['x-axis-absolute-range-start'];
	    this.endDataset = instance.globalReactiveModel.model['x-axis-absolute-range-end'];
	    this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	    // instance.globalReactiveModel.model['_x-axis-visible-range-start'] += 124416000000;
	    this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	
	    this.toolbars = [];
	
	    this.measurement = {};
	
	    this.toolbars.push(this.createToolbar());
	    return this;
	  };
	
	  createToolbar () {
	    var unigroup,
	      toolbar,
	      calculatedButtons,
	      contextualButtons,
	      allButton,
	      self = this,
	      endActive = this.globalReactiveModel.model['x-axis-visible-range-end'],
	      deductorAr = [],
	      startMultiplier,
	      deductor,
	      i,
	      j,
	      margin,
	      fromDateLabel,
	      group;
	
	    group = new this.toolbox.ComponentGroup({
	      paper: this.graphics.paper,
	      chart: this.chart,
	      smartLabel: this.smartLabel,
	      chartContainer: this.graphics.container
	    });
	
	    unigroup = new this.toolbox.UniSelectComponentGroup({
	      paper: this.graphics.paper,
	      chart: this.chart,
	      smartLabel: this.smartLabel,
	      chartContainer: this.graphics.container
	    });
	    unigroup.setConfig({
	      fill: '#fff',
	      borderThickness: 0
	    });
	    group.setConfig({
	      fill: '#fff',
	      borderThickness: 0
	    });
	    toolbar = new this.HorizontalToolbar({
	      paper: this.graphics.paper,
	      chart: this.chart,
	      smartLabel: this.smartLabel,
	      chartContainer: this.graphics.container
	    });
	    toolbar.setConfig({
	      fill: '#fff',
	      borderThickness: 0
	    });
	    fromDateLabel = new this.toolbox.Label('Zoom:', {
	      smartLabel: this.smartLabel,
	      paper: this.graphics.paper
	    }, {
	      text: {
	        style: {
	          'font-size': '15',
	          'fontFamily': 'MyriadPro'
	        }
	      }
	    });
	    group.addSymbol(fromDateLabel);
	    allButton = new this.toolbox.Symbol('ALL', true, {
	      paper: this.graphics.paper,
	      chart: this.chart,
	      smartLabel: this.smartLabel,
	      chartContainer: this.graphics.container
	    }, {
	      fill: '#ffffff',
	      labelFill: '#696969',
	      symbolStrokeWidth: '2',
	      symbolStroke: '#000000',
	      strokeWidth: '1',
	      hoverFill: '#7f7f7f',
	      radius: 1,
	      margin: {
	        right: 5
	      }
	    }).attachEventHandlers({
	      click: function () {
	        self.setActivePeriod(self.startDataset, self.endDataset);
	        toolbar.dispose();
	        self.clickedId = 'ALL';
	        self.toolbars.pop();
	        self.toolbars.push(self.createToolbar());
	        self.getLogicalSpace();
	        self.draw();
	      }
	    });
	
	    unigroup.addSymbol(allButton);
	    for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	      for (j = this.standardCalculatedPeriods[i].multipliers.length - 1; j >= 0; j--) {
	        deductorAr.push(self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	      }
	    }
	
	    calculatedButtons = [];
	    for (let i = self.startPointUnit; i >= 0; i--) {
	      if (i === self.startPointUnit) {
	        startMultiplier = self.startPointMultiplier;
	      } else {
	        startMultiplier = self.standardCalculatedPeriods[i].multipliers.length - 1;
	      }
	      for (let j = startMultiplier; j >= 0; j--) {
	        margin = (i === self.noCalcButtons && j === 0) ? 5 : 0;
	        console.log(endActive, i, self.noCalcButtons, j, margin);
	        calculatedButtons[i] = new this.toolbox.Symbol(self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation, true, {
	          paper: this.graphics.paper,
	          chart: this.chart,
	          smartLabel: this.smartLabel,
	          chartContainer: this.graphics.container
	        }, {
	          fill: '#ffffff',
	          labelFill: '#696969',
	          symbolStrokeWidth: '2',
	          symbolStroke: '#000000',
	          strokeWidth: '1',
	          hoverFill: '#7f7f7f',
	          radius: 1,
	          margin: {
	            right: margin
	          }
	        }).attachEventHandlers({
	          'click': function () {
	            deductor = (self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	            self.clickedId = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	            self.setActivePeriod(deductor);
	            toolbar.dispose();
	            self.toolbars.pop();
	            self.toolbars.push(self.createToolbar());
	            self.getLogicalSpace();
	            self.draw();
	            // this.toolbars[this.toolbars.length - 1] = this.createToolbar();
	          }
	        });
	        unigroup.addSymbol(calculatedButtons[i]);
	      }
	    }
	
	    contextualButtons = [];
	
	    for (let i = 0; i < this.standardContexualPeriods.length; i++) {
	      contextualButtons[i] = new this.toolbox.Symbol(this.standardContexualPeriods[i].abbreviation, true, {
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      }, {
	        fill: '#ffffff',
	        labelFill: '#696969',
	        symbolStrokeWidth: '2',
	        symbolStroke: '#000000',
	        strokeWidth: '1',
	        hoverFill: '#7f7f7f',
	        radius: 1,
	        margin: {
	          right: 0
	        }
	      }).attachEventHandlers({
	        'click': function () {
	          self.setActivePeriod(self.standardContexualPeriods[i].dateStart, self.standardContexualPeriods[i].dateEnd);
	          self.clickedId = self.standardContexualPeriods[i].abbreviation;
	          toolbar.dispose();
	          self.toolbars.pop();
	          self.toolbars.push(self.createToolbar());
	          self.getLogicalSpace();
	          self.draw();
	        }
	      });
	      unigroup.addSymbol(contextualButtons[i]);
	    }
	
	      // btn = document.createElement('BUTTON');
	      // btn.id = standardPeriods[i].abbreviation;
	      // btn.innerHTML = standardPeriods[i].abbreviation;
	      // btn.addEventListener('click', eventBtn.bind(this, standardPeriods[i]));
	      // contextualButtons.appendChild(btn);
	
	    this.SymbolStore.register('textBoxIcon', function (x, y, rad, w, h, padX, padY) {
	      var x1 = x - w / 2 + padX / 2,
	        x2 = x + w / 2 - padX / 2,
	        y1 = y - h / 2 + padY / 2,
	        y2 = y + h / 2 - padY / 2;
	
	      return ['M', x1, y1, 'L', x2, y1, 'L', x2, y2, 'L', x1, y2, 'Z'];
	    });
	
	    toolbar.addComponent(group);
	    toolbar.addComponent(unigroup);
	    return toolbar;
	  };
	
	  getLogicalSpace (availableWidth, availableHeight) {
	    availableWidth /= 2;
	    var logicalSpace,
	      width = 0,
	      height = 0,
	      i,
	      ln;
	
	    for (i = 0, ln = this.toolbars.length; i < ln; i++) {
	      logicalSpace = this.toolbars[i].getLogicalSpace(availableWidth, availableHeight);
	      width = Math.max(logicalSpace.width, width);
	      height += logicalSpace.height;
	      this.toolbars[i].width = logicalSpace.width;
	      this.toolbars[i].height = logicalSpace.height;
	    }
	    height += this.padding;
	    return {
	      width: width,
	      height: height
	    };
	  };
	
	  placeInCanvas () {
	    var self = this;
	    self.padding = 5;
	    self.spaceManagerInstance.add([{
	      name: function () {
	        return 'standard-period-selector-ext';
	      },
	      ref: function (obj) {
	        return obj['0'];
	      },
	      self: function () {
	        return self;
	      },
	      priority: function () {
	        return 2;
	      },
	      layout: function (obj) {
	        return obj.inline;
	      },
	      orientation: [{
	        type: function (obj) {
	          return obj.horizontal;
	        },
	        position: [{
	          type: function (obj) {
	            return obj.top;
	          },
	          alignment: [{
	            type: function (obj) {
	              return obj.left;
	            },
	            dimensions: [function () {
	              var parent = this.getParentComponentGroup();
	              return self.getLogicalSpace(parent.getWidth(), parent.getHeight());
	            }]
	          }]
	        }]
	      }]
	    }]);
	  };
	
	  setDrawingConfiguration (x, y, width, height, group) {
	    var mes = this.measurement;
	    mes.x = x;
	    mes.y = y;
	    mes.width = width;
	    mes.height = height;
	
	    this.parentGroup = group;
	
	    return this;
	  };
	
	  draw (x, y, width, height, group) {
	    var measurement = this.measurement,
	      toolbars = this.toolbars,
	      ln,
	      i,
	      toolbar,
	      boundElement,
	      bBox,
	      x1,
	      x2,
	      y2;
	
	    x = x === undefined ? measurement.x : x;
	    y = y === undefined ? measurement.y : y;
	    width = width === undefined ? measurement.width : width;
	    height = height === undefined ? measurement.height : height;
	    group = group === undefined ? this.parentGroup : group;
	    if (width && height) {
	      for (i = 0, ln = toolbars.length; i < ln; i++) {
	        toolbar = toolbars[i];
	        toolbar.draw(x, y, group);
	      }
	    }
	    console.log(toolbars);
	    for (let i = 0, ii = toolbars[0].componentGroups[1].symbolList; i < ii.length; i++) {
	      if (ii[i].symbol === this.clickedId) {
	        boundElement = ii[i].getBoundElement();
	        bBox = boundElement.getBBox();
	        x1 = bBox.x;
	        x2 = bBox.x2;
	        y2 = bBox.y2;
	
	        this.graphics.paper.path({
	          path: ['M', x1, y2 - 2 / 2, 'L', x2, y2 - 2 / 2],
	          'stroke': '#ff0000'
	        }).toFront();
	        // this._parentGroup.setState(this);
	      }
	    }
	  };
	}
	
	if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {
	  module.exports = StandardPeriodSelector;
	} else {
	  window.StandardPeriod = StandardPeriodSelector;
	}
	
	module.exports = function (dep) {
	  class StandardPeriodSelector {
	    constructor () {
	      /**
	       * @private
	       */
	      this.ratio = 8;
	      this.toolbox = FusionCharts.getComponent('api', 'toolbox');
	      this.HorizontalToolbar = this.toolbox.HorizontalToolbar;
	      this.ComponentGroup = this.toolbox.ComponentGroup;
	      this.SymbolStore = this.toolbox.SymbolStore;
	      this.all = 1;
	      this.calculatedPeriods = [];
	      this.startDataset = 0;
	      // this.endDataset = this.globalReactiveModel.model['x-axis-absolute-range-end'];
	      this.startActiveWindow = 0;
	      this.endActiveWindow = 1;
	      this.standardCalculatedPeriods = [];
	      this.standardContexualPeriods = [];
	      this.startPointUnit = 0;
	      this.startPointMultiplier = 0;
	      this.clickedId;
	      this.noCalcButtons = 0;
	      this.timePeriods = [{
	        'name': 'second',
	        'milliseconds': 1000,
	        'startingPoint': 0,
	        'total': 60,
	        'abbreviation': 'sec',
	        'description': 'SECOND',
	        'parent': 'minute',
	        'multipliers': [1, 5, 15, 30]
	      }, {
	        'name': 'minute',
	        'milliseconds': 60000,
	        'startingPoint': 0,
	        'total': 60,
	        'abbreviation': 'min',
	        'description': 'MINUTE',
	        'parent': 'hour',
	        'multipliers': [1, 5, 15, 30]
	      }, {
	        'name': 'hour',
	        'milliseconds': 3600000,
	        'startingPoint': 0,
	        'total': 24,
	        'abbreviation': 'hr',
	        'description': 'HOUR',
	        'parent': 'day',
	        'multipliers': [1, 3, 6, 12]
	      }, {
	        'name': 'day',
	        'milliseconds': 86400000,
	        'startingPoint': 0,
	        'total': 30,
	        'abbreviation': 'D',
	        'description': 'DAY',
	        'parent': 'month',
	        'multipliers': [1, 7, 15]
	      }, {
	        'name': 'month',
	        'milliseconds': 2592000000,
	        'startingPoint': 0,
	        'total': 12,
	        'abbreviation': 'M',
	        'description': 'MONTH',
	        'parent': 'year',
	        'multipliers': [1, 3, 6]
	      }, {
	        'name': 'year',
	        'milliseconds': 31104000000,
	        'startingPoint': 0,
	        'abbreviation': 'Y',
	        'description': 'YEAR',
	        'multipliers': [1, 3, 5]
	      }];
	      this.tdButtons = [
	        {
	          'name': 'YTD',
	          'abbreviation': 'YTD',
	          'parent': 'year',
	          'milliseconds': 31104000000,
	          'description': 'Year to Date'
	        },
	        {
	          'name': 'QTD',
	          'abbreviation': 'QTD',
	          'parent': 'month',
	          'multiplier': 3,
	          'milliseconds': 7776000000,
	          'description': 'Quarter to Date'
	        },
	        {
	          'name': 'MTD',
	          'abbreviation': 'MTD',
	          'parent': 'month',
	          'milliseconds': 2592000000,
	          'description': 'Month to Date'
	        },
	        {
	          'name': 'WTD',
	          'abbreviation': 'WTD',
	          'parent': 'day',
	          'multiplier': 7,
	          'milliseconds': 604800000,
	          'description': 'Week to Date'
	        },
	        {
	          'name': 'Y',
	          'abbreviation': 'Y',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Yesterday'
	        },
	        {
	          'name': 'T',
	          'abbreviation': 'T',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Today'
	        }
	      ];
	      this.config = {
	        anchorPositions: 'right',
	        all: '1',
	        contextual: '1',
	        calculated: '1',
	        tertiaryTimePeriods: {}
	      };
	    }
	
	    /**
	     * A function to generate the calculated buttons using
	     * the active range and the location of the active range
	     */
	    generateCalculatedButtons () {
	      var targetBlock = this.endActiveWindow - this.startDataset,
	        i = 0,
	        j = 0,
	        activeWindow = this.endActiveWindow - this.startActiveWindow,
	        count = 0;
	      this.standardCalculatedPeriods = [];
	      for (i = 0; i < this.timePeriods.length; i++) {
	        // checking whether the unit is applicable for the current target block
	        if (targetBlock / this.timePeriods[i].milliseconds >= 1) {
	          // checking whether the unit is of the higher order and only multiplier 1 is applicable
	          if (Math.floor((activeWindow) / this.timePeriods[i].milliseconds) < 1) {
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].milliseconds,
	              'multipliers': [1]
	            });
	          } else { // if the unit is of the order of the target block and calculating the multipliers
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].milliseconds,
	              'multipliers': []
	            });
	            // calculating and populating the applicable multpliers of each unit
	            for (j = 0; j < this.timePeriods[i].multipliers.length; j++) {
	              if (activeWindow / this.ratio < this.timePeriods[i].multipliers[j] * this.timePeriods[i].milliseconds) {
	                this.standardCalculatedPeriods[this.standardCalculatedPeriods.length - 1].multipliers.push(
	                  this.timePeriods[i].multipliers[j]
	                  );
	              }
	            }
	          }
	        }
	      }
	      this.noCalcButtons = Infinity;
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = 0; j < this.standardCalculatedPeriods[i].multipliers.length; j++) {
	          ++count;
	          if (this.noCalcButtons > i) {
	            this.noCalcButtons = i;
	          }
	          if (count <= 4) {
	            this.startPointMultiplier = j;
	            this.startPointUnit = i;
	          }
	        }
	      }
	
	      // this.drawButtonsCalculated(this.standardCalculatedPeriods);
	    }
	
	    /**
	     * A function to generate the contextual buttons using
	     * the end point of the time-scale
	     */
	    generateContextualButtons () {
	      // generating an array with applicable TD buttons
	      var buttons = [],
	        i = 0,
	        endStamp = this.globalReactiveModel.model['x-axis-absolute-range-end'],
	        dateStart = endStamp - 2,
	        dateEnd = endStamp,
	        relativeTDButton = {};
	      for (; i < this.tdButtons.length; i++) {
	        dateStart = new Date(endStamp);
	        if (this.tdButtons[i].name === 'YTD') {
	          dateStart.setMonth(0);
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'MTD') {
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'QTD') {
	          dateStart.setMonth(11 - (dateStart.getMonth() % 4));
	          dateStart.setDate(0);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'WTD') {
	          dateStart.setDate(dateStart.getDate() - dateStart.getDay());
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'Y') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	          dateStart -= 86400000;
	        } else if (this.tdButtons[i].name === 'T') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        }
	
	        if (dateEnd < dateStart) {
	          continue;
	        } else {
	          this.tdButtons[i].dateStart = dateStart.valueOf();
	          this.tdButtons[i].dateEnd = dateEnd.valueOf();
	          buttons.push(this.tdButtons[i]);
	        }
	      }
	      relativeTDButton.milliseconds = Infinity;
	      for (i = 0; i < this.tdButtons.length; i++) {
	        if (Math.abs(this.tdButtons[i].milliseconds - (this.endActiveWindow - this.startActiveWindow)) < relativeTDButton.milliseconds) {
	          relativeTDButton.milliseconds = this.tdButtons[i].milliseconds;
	          relativeTDButton.name = this.tdButtons[i].abbreviation;
	        }
	      }
	
	      this.standardContexualPeriods = buttons;
	      // this.drawButtonsContextual(this.standardContexualPeriods);
	    }
	
	    /**
	     * A function to set the active period's
	     * start and end point
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of active period
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of active period
	     */
	    setActivePeriod () {
	      var start,
	        end;
	      if (arguments.length === 1) {
	        end = this.globalReactiveModel.model['x-axis-visible-range-end'];
	        start = end - arguments[0];
	      } else if (arguments.length === 2) {
	        start = arguments[0];
	        end = arguments[1];
	      }
	
	      this.startActiveWindow = start;
	      this.endActiveWindow = end;
	      this.generateCalculatedButtons();
	      this.globalReactiveModel.model['x-axis-visible-range-start'] = this.startActiveWindow;
	      this.globalReactiveModel.model['x-axis-visible-range-end'] = this.endActiveWindow;
	      this.generateContextualButtons();
	    }
	
	    /**
	     * A function to set the start and end point of the
	     * entire time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of time-line
	     */
	    setTimeline (start, end) {
	      this.startDataset = start;
	      this.endDataset = end;
	      document.getElementById('startActiveRange').innerHTML = new Date(this.startDataset);
	      document.getElementById('endActiveRange').innerHTML = new Date(this.endDataset);
	      this.generateCalculatedButtons();
	    }
	
	    /**
	     * A function to set the object to set the user preferences
	     */
	    configure (config) {
	      this.config = config;
	    }
	
	    /**
	     * Fusioncharts life cycle method for extension
	     */
	    init (require) {
	      var instance = this;
	      require([
	        'xAxis',
	        'yAxis',
	        'graphics',
	        'chart',
	        'dataset',
	        'PlotManager',
	        'canvasConfig',
	        'MarkerManager',
	        'reactiveModel',
	        'globalReactiveModel',
	        'spaceManagerInstance',
	        'smartLabel',
	        function (
	              xAxis,
	              yAxis,
	              graphics,
	              chart,
	              dataset,
	              plotManager,
	              canvasConfig,
	              markerManager,
	              reactiveModel,
	              globalReactiveModel,
	              spaceManagerInstance,
	              smartLabel) {
	          instance.xAxis = xAxis;
	          instance.yAxis = yAxis;
	          instance.graphics = graphics;
	          instance.chart = chart;
	          instance.dataset = dataset;
	          instance.plotManager = plotManager;
	          instance.markerManager = markerManager;
	          instance.canvasConfig = canvasConfig;
	          instance.reactiveModel = reactiveModel;
	          instance.globalReactiveModel = globalReactiveModel;
	          instance.spaceManagerInstance = spaceManagerInstance;
	          instance.smartLabel = smartLabel;
	        }
	      ]);
	      this.spaceManagerInstance = instance.spaceManagerInstance;
	      this.globalReactiveModel = instance.globalReactiveModel;
	      this.endActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-end'];
	      this.startActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-start'];
	      this.startDataset = instance.globalReactiveModel.model['x-axis-absolute-range-start'];
	      this.endDataset = instance.globalReactiveModel.model['x-axis-absolute-range-end'];
	      this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	      // instance.globalReactiveModel.model['_x-axis-visible-range-start'] += 124416000000;
	      this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	
	      this.toolbars = [];
	
	      this.measurement = {};
	
	      this.toolbars.push(this.createToolbar());
	      return this;
	    };
	
	    createToolbar () {
	      var unigroup,
	        toolbar,
	        calculatedButtons,
	        contextualButtons,
	        allButton,
	        self = this,
	        endActive = this.globalReactiveModel.model['x-axis-visible-range-end'],
	        deductorAr = [],
	        startMultiplier,
	        deductor,
	        i,
	        j,
	        margin,
	        fromDateLabel,
	        group;
	
	      group = new this.toolbox.ComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	
	      unigroup = new this.toolbox.UniSelectComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      unigroup.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      group.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      toolbar = new this.HorizontalToolbar({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      toolbar.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      fromDateLabel = new this.toolbox.Label('Zoom:', {
	        smartLabel: this.smartLabel,
	        paper: this.graphics.paper
	      }, {
	        text: {
	          style: {
	            'font-size': '15',
	            'fontFamily': 'MyriadPro'
	          }
	        }
	      });
	      group.addSymbol(fromDateLabel);
	      allButton = new this.toolbox.Symbol('ALL', true, {
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      }, {
	        fill: '#ffffff',
	        labelFill: '#696969',
	        symbolStrokeWidth: '2',
	        symbolStroke: '#000000',
	        strokeWidth: '1',
	        hoverFill: '#7f7f7f',
	        radius: 1,
	        margin: {
	          right: 5
	        }
	      }).attachEventHandlers({
	        click: function () {
	          self.setActivePeriod(self.startDataset, self.endDataset);
	          toolbar.dispose();
	          self.clickedId = 'ALL';
	          self.toolbars.pop();
	          self.toolbars.push(self.createToolbar());
	          self.getLogicalSpace();
	          self.draw();
	        }
	      });
	
	      unigroup.addSymbol(allButton);
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = this.standardCalculatedPeriods[i].multipliers.length - 1; j >= 0; j--) {
	          deductorAr.push(self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	        }
	      }
	
	      calculatedButtons = [];
	      for (let i = self.startPointUnit; i >= 0; i--) {
	        if (i === self.startPointUnit) {
	          startMultiplier = self.startPointMultiplier;
	        } else {
	          startMultiplier = self.standardCalculatedPeriods[i].multipliers.length - 1;
	        }
	        for (let j = startMultiplier; j >= 0; j--) {
	          margin = (i === self.noCalcButtons && j === 0) ? 5 : 0;
	          console.log(endActive, i, self.noCalcButtons, j, margin);
	          calculatedButtons[i] = new this.toolbox.Symbol(self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation, true, {
	            paper: this.graphics.paper,
	            chart: this.chart,
	            smartLabel: this.smartLabel,
	            chartContainer: this.graphics.container
	          }, {
	            fill: '#ffffff',
	            labelFill: '#696969',
	            symbolStrokeWidth: '2',
	            symbolStroke: '#000000',
	            strokeWidth: '1',
	            hoverFill: '#7f7f7f',
	            radius: 1,
	            margin: {
	              right: margin
	            }
	          }).attachEventHandlers({
	            'click': function () {
	              deductor = (self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	              self.clickedId = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	              self.setActivePeriod(deductor);
	              toolbar.dispose();
	              self.toolbars.pop();
	              self.toolbars.push(self.createToolbar());
	              self.getLogicalSpace();
	              self.draw();
	              // this.toolbars[this.toolbars.length - 1] = this.createToolbar();
	            }
	          });
	          unigroup.addSymbol(calculatedButtons[i]);
	        }
	      }
	
	      contextualButtons = [];
	
	      for (let i = 0; i < this.standardContexualPeriods.length; i++) {
	        contextualButtons[i] = new this.toolbox.Symbol(this.standardContexualPeriods[i].abbreviation, true, {
	          paper: this.graphics.paper,
	          chart: this.chart,
	          smartLabel: this.smartLabel,
	          chartContainer: this.graphics.container
	        }, {
	          fill: '#ffffff',
	          labelFill: '#696969',
	          symbolStrokeWidth: '2',
	          symbolStroke: '#000000',
	          strokeWidth: '1',
	          hoverFill: '#7f7f7f',
	          radius: 1,
	          margin: {
	            right: 0
	          }
	        }).attachEventHandlers({
	          'click': function () {
	            self.setActivePeriod(self.standardContexualPeriods[i].dateStart, self.standardContexualPeriods[i].dateEnd);
	            self.clickedId = self.standardContexualPeriods[i].abbreviation;
	            toolbar.dispose();
	            self.toolbars.pop();
	            self.toolbars.push(self.createToolbar());
	            self.getLogicalSpace();
	            self.draw();
	          }
	        });
	        unigroup.addSymbol(contextualButtons[i]);
	      }
	
	        // btn = document.createElement('BUTTON');
	        // btn.id = standardPeriods[i].abbreviation;
	        // btn.innerHTML = standardPeriods[i].abbreviation;
	        // btn.addEventListener('click', eventBtn.bind(this, standardPeriods[i]));
	        // contextualButtons.appendChild(btn);
	
	      this.SymbolStore.register('textBoxIcon', function (x, y, rad, w, h, padX, padY) {
	        var x1 = x - w / 2 + padX / 2,
	          x2 = x + w / 2 - padX / 2,
	          y1 = y - h / 2 + padY / 2,
	          y2 = y + h / 2 - padY / 2;
	
	        return ['M', x1, y1, 'L', x2, y1, 'L', x2, y2, 'L', x1, y2, 'Z'];
	      });
	
	      toolbar.addComponent(group);
	      toolbar.addComponent(unigroup);
	      return toolbar;
	    };
	
	    getLogicalSpace (availableWidth, availableHeight) {
	      availableWidth /= 2;
	      var logicalSpace,
	        width = 0,
	        height = 0,
	        i,
	        ln;
	
	      for (i = 0, ln = this.toolbars.length; i < ln; i++) {
	        logicalSpace = this.toolbars[i].getLogicalSpace(availableWidth, availableHeight);
	        width = Math.max(logicalSpace.width, width);
	        height += logicalSpace.height;
	        this.toolbars[i].width = logicalSpace.width;
	        this.toolbars[i].height = logicalSpace.height;
	      }
	      height += this.padding;
	      return {
	        width: width,
	        height: height
	      };
	    };
	
	    placeInCanvas () {
	      var self = this;
	      self.padding = 5;
	      self.spaceManagerInstance.add([{
	        name: function () {
	          return 'standard-period-selector-ext';
	        },
	        ref: function (obj) {
	          return obj['0'];
	        },
	        self: function () {
	          return self;
	        },
	        priority: function () {
	          return 2;
	        },
	        layout: function (obj) {
	          return obj.inline;
	        },
	        orientation: [{
	          type: function (obj) {
	            return obj.horizontal;
	          },
	          position: [{
	            type: function (obj) {
	              return obj.top;
	            },
	            alignment: [{
	              type: function (obj) {
	                return obj.left;
	              },
	              dimensions: [function () {
	                var parent = this.getParentComponentGroup();
	                return self.getLogicalSpace(parent.getWidth(), parent.getHeight());
	              }]
	            }]
	          }]
	        }]
	      }]);
	    };
	
	    setDrawingConfiguration (x, y, width, height, group) {
	      var mes = this.measurement;
	      mes.x = x;
	      mes.y = y;
	      mes.width = width;
	      mes.height = height;
	
	      this.parentGroup = group;
	
	      return this;
	    };
	
	    draw (x, y, width, height, group) {
	      var measurement = this.measurement,
	        toolbars = this.toolbars,
	        ln,
	        i,
	        toolbar,
	        boundElement,
	        bBox,
	        x1,
	        x2,
	        y2;
	
	      x = x === undefined ? measurement.x : x;
	      y = y === undefined ? measurement.y : y;
	      width = width === undefined ? measurement.width : width;
	      height = height === undefined ? measurement.height : height;
	      group = group === undefined ? this.parentGroup : group;
	      if (width && height) {
	        for (i = 0, ln = toolbars.length; i < ln; i++) {
	          toolbar = toolbars[i];
	          toolbar.draw(x, y, group);
	        }
	      }
	      console.log(toolbars);
	      for (let i = 0, ii = toolbars[0].componentGroups[1].symbolList; i < ii.length; i++) {
	        if (ii[i].symbol === this.clickedId) {
	          boundElement = ii[i].getBoundElement();
	          bBox = boundElement.getBBox();
	          x1 = bBox.x;
	          x2 = bBox.x2;
	          y2 = bBox.y2;
	
	          this.graphics.paper.path({
	            path: ['M', x1, y2 - 2 / 2, 'L', x2, y2 - 2 / 2],
	            'stroke': '#ff0000'
	          }).toFront();
	          // this._parentGroup.setState(this);
	        }
	      }
	    };
	  }
	  return StandardPeriodSelector;
	};


/***/ }
/******/ ]);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMzRkNmRjZGI1Zjk2M2M1YzY3OWUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDdENBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsMEZBQXlGLGlCQUFpQjtBQUMxRyxJQUFHO0FBQ0gsRUFBQzs7Ozs7OztBQ3RCRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWUsNkJBQTZCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWCxVQUFTLE9BQU87QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBLHNCQUFxQiw0Q0FBNEM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZSwyQ0FBMkM7QUFDMUQsa0JBQWlCLDBEQUEwRDtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVUsMkJBQTJCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZSwyQkFBMkI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBYyxPQUFPO0FBQ3JCLGVBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZUFBYyxPQUFPO0FBQ3JCLGVBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0EsZ0JBQWUsMkNBQTJDO0FBQzFELHlFQUF3RSxRQUFRO0FBQ2hGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNDQUFxQyxRQUFRO0FBQzdDO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLG9DQUFtQyxRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBOztBQUVBLG9CQUFtQiwwQ0FBMEM7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDJDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2IsWUFBVztBQUNYLFVBQVM7QUFDVCxRQUFPO0FBQ1AsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFtRSxlQUFlO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBaUIsNkJBQTZCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYixZQUFXLE9BQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBLHdCQUF1Qiw0Q0FBNEM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBaUIsMkNBQTJDO0FBQzVELG9CQUFtQiwwREFBMEQ7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFZLDJCQUEyQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCLDJCQUEyQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0IsT0FBTztBQUN2QixpQkFBZ0IsT0FBTztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWdCLE9BQU87QUFDdkIsaUJBQWdCLE9BQU87QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDtBQUNBLGtCQUFpQiwyQ0FBMkM7QUFDNUQsMkVBQTBFLFFBQVE7QUFDbEY7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0Esc0NBQXFDLFFBQVE7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsc0JBQXFCLDBDQUEwQztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFFBQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmLGNBQWE7QUFDYixZQUFXO0FBQ1gsVUFBUztBQUNULFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUF5QyxRQUFRO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBcUUsZUFBZTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InN0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1lczYubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMzRkNmRjZGI1Zjk2M2M1YzY3OWUiLCIndXNlIHN0cmljdCc7XG5jb25zdCBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gcmVxdWlyZSgnLi9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InKTtcblxud2luZG93LnN0UFMgPSBuZXcgU3RhbmRhcmRQZXJpb2RTZWxlY3RvcigpO1xuXG47KGZ1bmN0aW9uIChlbnYsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBlbnYuZG9jdW1lbnRcbiAgICAgICA/IGZhY3RvcnkoZW52KSA6IGZ1bmN0aW9uICh3aW4pIHtcbiAgICAgICAgIGlmICghd2luLmRvY3VtZW50KSB7XG4gICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV2luZG93IHdpdGggZG9jdW1lbnQgbm90IHByZXNlbnQnKTtcbiAgICAgICAgIH1cbiAgICAgICAgIHJldHVybiBmYWN0b3J5KHdpbiwgdHJ1ZSk7XG4gICAgICAgfTtcbiAgfSBlbHNlIHtcbiAgICBlbnYuU3RhbmRhcmRQZXJpb2RTZWxlY3RvciA9IGZhY3RvcnkoZW52LCB0cnVlKTtcbiAgfVxufSkodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiAoX3dpbmRvdywgd2luZG93RXhpc3RzKSB7XG4gIHZhciBGQyA9IF93aW5kb3cuRnVzaW9uQ2hhcnRzO1xuICBGQy5yZWdpc3RlcignZXh0ZW5zaW9uJywgWydwcml2YXRlJywgJ1N0YW5kYXJkUGVyaW9kU2VsZWN0b3InLCBmdW5jdGlvbiAoKSB7XG4gICAgRkMucmVnaXN0ZXJDb21wb25lbnQoJ2V4dGVuc2lvbnMnLCAnU3RhbmRhcmRQZXJpb2RTZWxlY3RvcicsIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Ioe0Z1c2lvbkNoYXJ0czogRkN9KSk7XG4gIH1dKTtcbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENsYXNzIGRlZmluaXRpb24gb2YgU3RhbmRhcmRQZXJpb2RTZWxlY3RvclxuICovXG5cbmNsYXNzIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Ige1xuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLnJhdGlvID0gODtcbiAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuICAgIHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIgPSB0aGlzLnRvb2xib3guSG9yaXpvbnRhbFRvb2xiYXI7XG4gICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcbiAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuICAgIHRoaXMuYWxsID0gMTtcbiAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSAwO1xuICAgIC8vIHRoaXMuZW5kRGF0YXNldCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSAwO1xuICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gMTtcbiAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuICAgIHRoaXMuc3RhcnRQb2ludFVuaXQgPSAwO1xuICAgIHRoaXMuc3RhcnRQb2ludE11bHRpcGxpZXIgPSAwO1xuICAgIHRoaXMuY2xpY2tlZElkO1xuICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IDA7XG4gICAgdGhpcy50aW1lUGVyaW9kcyA9IFt7XG4gICAgICAnbmFtZSc6ICdzZWNvbmQnLFxuICAgICAgJ21pbGxpc2Vjb25kcyc6IDEwMDAsXG4gICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAndG90YWwnOiA2MCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnc2VjJyxcbiAgICAgICdkZXNjcmlwdGlvbic6ICdTRUNPTkQnLFxuICAgICAgJ3BhcmVudCc6ICdtaW51dGUnLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDUsIDE1LCAzMF1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICdtaW51dGUnLFxuICAgICAgJ21pbGxpc2Vjb25kcyc6IDYwMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ3RvdGFsJzogNjAsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ21pbicsXG4gICAgICAnZGVzY3JpcHRpb24nOiAnTUlOVVRFJyxcbiAgICAgICdwYXJlbnQnOiAnaG91cicsXG4gICAgICAnbXVsdGlwbGllcnMnOiBbMSwgNSwgMTUsIDMwXVxuICAgIH0sIHtcbiAgICAgICduYW1lJzogJ2hvdXInLFxuICAgICAgJ21pbGxpc2Vjb25kcyc6IDM2MDAwMDAsXG4gICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAndG90YWwnOiAyNCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnaHInLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0hPVVInLFxuICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxuICAgIH0sIHtcbiAgICAgICduYW1lJzogJ2RheScsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAndG90YWwnOiAzMCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnRCcsXG4gICAgICAnZGVzY3JpcHRpb24nOiAnREFZJyxcbiAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDcsIDE1XVxuICAgIH0sIHtcbiAgICAgICduYW1lJzogJ21vbnRoJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ3RvdGFsJzogMTIsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ00nLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01PTlRIJyxcbiAgICAgICdwYXJlbnQnOiAneWVhcicsXG4gICAgICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNl1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICd5ZWFyJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiAzMTEwNDAwMDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG4gICAgICAnZGVzY3JpcHRpb24nOiAnWUVBUicsXG4gICAgICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNV1cbiAgICB9XTtcbiAgICB0aGlzLnRkQnV0dG9ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgJ25hbWUnOiAnWVREJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdZVEQnLFxuICAgICAgICAncGFyZW50JzogJ3llYXInLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdZZWFyIHRvIERhdGUnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAnbmFtZSc6ICdRVEQnLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1FURCcsXG4gICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAnbXVsdGlwbGllcic6IDMsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiA3Nzc2MDAwMDAwLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ25hbWUnOiAnTVREJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdNVEQnLFxuICAgICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdNb250aCB0byBEYXRlJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ25hbWUnOiAnV1REJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdXVEQnLFxuICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICdtdWx0aXBsaWVyJzogNyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDYwNDgwMDAwMCxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICduYW1lJzogJ1knLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llc3RlcmRheSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICduYW1lJzogJ1QnLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1QnLFxuICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1RvZGF5J1xuICAgICAgfVxuICAgIF07XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICBhbmNob3JQb3NpdGlvbnM6ICdyaWdodCcsXG4gICAgICBhbGw6ICcxJyxcbiAgICAgIGNvbnRleHR1YWw6ICcxJyxcbiAgICAgIGNhbGN1bGF0ZWQ6ICcxJyxcbiAgICAgIHRlcnRpYXJ5VGltZVBlcmlvZHM6IHt9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjYWxjdWxhdGVkIGJ1dHRvbnMgdXNpbmdcbiAgICogdGhlIGFjdGl2ZSByYW5nZSBhbmQgdGhlIGxvY2F0aW9uIG9mIHRoZSBhY3RpdmUgcmFuZ2VcbiAgICovXG4gIGdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMgKCkge1xuICAgIHZhciB0YXJnZXRCbG9jayA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydERhdGFzZXQsXG4gICAgICBpID0gMCxcbiAgICAgIGogPSAwLFxuICAgICAgYWN0aXZlV2luZG93ID0gdGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93LFxuICAgICAgY291bnQgPSAwO1xuICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIGFwcGxpY2FibGUgZm9yIHRoZSBjdXJyZW50IHRhcmdldCBibG9ja1xuICAgICAgaWYgKHRhcmdldEJsb2NrIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMgPj0gMSkge1xuICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIG9mIHRoZSBoaWdoZXIgb3JkZXIgYW5kIG9ubHkgbXVsdGlwbGllciAxIGlzIGFwcGxpY2FibGVcbiAgICAgICAgaWYgKE1hdGguZmxvb3IoKGFjdGl2ZVdpbmRvdykgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcykgPCAxKSB7XG4gICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLFxuICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyxcbiAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFsxXVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgeyAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG4gICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLFxuICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyxcbiAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFtdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgaWYgKGFjdGl2ZVdpbmRvdyAvIHRoaXMucmF0aW8gPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW3RoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGggLSAxXS5tdWx0aXBsaWVycy5wdXNoKFxuICAgICAgICAgICAgICAgIHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBJbmZpbml0eTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICsrY291bnQ7XG4gICAgICAgIGlmICh0aGlzLm5vQ2FsY0J1dHRvbnMgPiBpKSB7XG4gICAgICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gaTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY291bnQgPD0gNCkge1xuICAgICAgICAgIHRoaXMuc3RhcnRQb2ludE11bHRpcGxpZXIgPSBqO1xuICAgICAgICAgIHRoaXMuc3RhcnRQb2ludFVuaXQgPSBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjb250ZXh0dWFsIGJ1dHRvbnMgdXNpbmdcbiAgICogdGhlIGVuZCBwb2ludCBvZiB0aGUgdGltZS1zY2FsZVxuICAgKi9cbiAgZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucyAoKSB7XG4gICAgLy8gZ2VuZXJhdGluZyBhbiBhcnJheSB3aXRoIGFwcGxpY2FibGUgVEQgYnV0dG9uc1xuICAgIHZhciBidXR0b25zID0gW10sXG4gICAgICBpID0gMCxcbiAgICAgIGVuZFN0YW1wID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ10sXG4gICAgICBkYXRlU3RhcnQgPSBlbmRTdGFtcCAtIDIsXG4gICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG4gICAgICByZWxhdGl2ZVREQnV0dG9uID0ge307XG4gICAgZm9yICg7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoZW5kU3RhbXApO1xuICAgICAgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZVEQnKSB7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnTVREJykge1xuICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdRVEQnKSB7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgxMSAtIChkYXRlU3RhcnQuZ2V0TW9udGgoKSAlIDQpKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZShkYXRlU3RhcnQuZ2V0RGF0ZSgpIC0gZGF0ZVN0YXJ0LmdldERheSgpKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZJykge1xuICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnVCcpIHtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRlRW5kIDwgZGF0ZVN0YXJ0KSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50ZEJ1dHRvbnNbaV0uZGF0ZVN0YXJ0ID0gZGF0ZVN0YXJ0LnZhbHVlT2YoKTtcbiAgICAgICAgdGhpcy50ZEJ1dHRvbnNbaV0uZGF0ZUVuZCA9IGRhdGVFbmQudmFsdWVPZigpO1xuICAgICAgICBidXR0b25zLnB1c2godGhpcy50ZEJ1dHRvbnNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IEluZmluaXR5O1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKE1hdGguYWJzKHRoaXMudGRCdXR0b25zW2ldLm1pbGxpc2Vjb25kcyAtICh0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cpKSA8IHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzKSB7XG4gICAgICAgIHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzID0gdGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzO1xuICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm5hbWUgPSB0aGlzLnRkQnV0dG9uc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMgPSBidXR0b25zO1xuICAgIC8vIHRoaXMuZHJhd0J1dHRvbnNDb250ZXh0dWFsKHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIHNldCB0aGUgYWN0aXZlIHBlcmlvZCdzXG4gICAqIHN0YXJ0IGFuZCBlbmQgcG9pbnRcbiAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIHN0YXJ0IHBvaW50IG9mIGFjdGl2ZSBwZXJpb2RcbiAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG4gICAqL1xuICBzZXRBY3RpdmVQZXJpb2QgKCkge1xuICAgIHZhciBzdGFydCxcbiAgICAgIGVuZDtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgZW5kID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcbiAgICAgIHN0YXJ0ID0gZW5kIC0gYXJndW1lbnRzWzBdO1xuICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgc3RhcnQgPSBhcmd1bWVudHNbMF07XG4gICAgICBlbmQgPSBhcmd1bWVudHNbMV07XG4gICAgfVxuXG4gICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IHN0YXJ0O1xuICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gZW5kO1xuICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXSA9IHRoaXMuc3RhcnRBY3RpdmVXaW5kb3c7XG4gICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXSA9IHRoaXMuZW5kQWN0aXZlV2luZG93O1xuICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgKiBlbnRpcmUgdGltZS1saW5lXG4gICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICovXG4gIHNldFRpbWVsaW5lIChzdGFydCwgZW5kKSB7XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSBzdGFydDtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSBlbmQ7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0QWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLnN0YXJ0RGF0YXNldCk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmREYXRhc2V0KTtcbiAgICB0aGlzLmdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIHNldCB0aGUgb2JqZWN0IHRvIHNldCB0aGUgdXNlciBwcmVmZXJlbmNlc1xuICAgKi9cbiAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIC8qKlxuICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuICAgKi9cbiAgaW5pdCAocmVxdWlyZSkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgcmVxdWlyZShbXG4gICAgICAneEF4aXMnLFxuICAgICAgJ3lBeGlzJyxcbiAgICAgICdncmFwaGljcycsXG4gICAgICAnY2hhcnQnLFxuICAgICAgJ2RhdGFzZXQnLFxuICAgICAgJ1Bsb3RNYW5hZ2VyJyxcbiAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgJ01hcmtlck1hbmFnZXInLFxuICAgICAgJ3JlYWN0aXZlTW9kZWwnLFxuICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgJ3NwYWNlTWFuYWdlckluc3RhbmNlJyxcbiAgICAgICdzbWFydExhYmVsJyxcbiAgICAgIGZ1bmN0aW9uIChcbiAgICAgICAgICAgIHhBeGlzLFxuICAgICAgICAgICAgeUF4aXMsXG4gICAgICAgICAgICBncmFwaGljcyxcbiAgICAgICAgICAgIGNoYXJ0LFxuICAgICAgICAgICAgZGF0YXNldCxcbiAgICAgICAgICAgIHBsb3RNYW5hZ2VyLFxuICAgICAgICAgICAgY2FudmFzQ29uZmlnLFxuICAgICAgICAgICAgbWFya2VyTWFuYWdlcixcbiAgICAgICAgICAgIHJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICBnbG9iYWxSZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgc3BhY2VNYW5hZ2VySW5zdGFuY2UsXG4gICAgICAgICAgICBzbWFydExhYmVsKSB7XG4gICAgICAgIGluc3RhbmNlLnhBeGlzID0geEF4aXM7XG4gICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG4gICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gZ3JhcGhpY3M7XG4gICAgICAgIGluc3RhbmNlLmNoYXJ0ID0gY2hhcnQ7XG4gICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuICAgICAgICBpbnN0YW5jZS5wbG90TWFuYWdlciA9IHBsb3RNYW5hZ2VyO1xuICAgICAgICBpbnN0YW5jZS5tYXJrZXJNYW5hZ2VyID0gbWFya2VyTWFuYWdlcjtcbiAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuICAgICAgICBpbnN0YW5jZS5yZWFjdGl2ZU1vZGVsID0gcmVhY3RpdmVNb2RlbDtcbiAgICAgICAgaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICAgIGluc3RhbmNlLnNtYXJ0TGFiZWwgPSBzbWFydExhYmVsO1xuICAgICAgfVxuICAgIF0pO1xuICAgIHRoaXMuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG4gICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG4gICAgdGhpcy5zZXRBY3RpdmVQZXJpb2QodGhpcy5zdGFydEFjdGl2ZVdpbmRvdywgdGhpcy5lbmRBY3RpdmVXaW5kb3cpO1xuICAgIC8vIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ194LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddICs9IDEyNDQxNjAwMDAwMDtcbiAgICB0aGlzLnNldEFjdGl2ZVBlcmlvZCh0aGlzLnN0YXJ0QWN0aXZlV2luZG93LCB0aGlzLmVuZEFjdGl2ZVdpbmRvdyk7XG5cbiAgICB0aGlzLnRvb2xiYXJzID0gW107XG5cbiAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG5cbiAgICB0aGlzLnRvb2xiYXJzLnB1c2godGhpcy5jcmVhdGVUb29sYmFyKCkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIGNyZWF0ZVRvb2xiYXIgKCkge1xuICAgIHZhciB1bmlncm91cCxcbiAgICAgIHRvb2xiYXIsXG4gICAgICBjYWxjdWxhdGVkQnV0dG9ucyxcbiAgICAgIGNvbnRleHR1YWxCdXR0b25zLFxuICAgICAgYWxsQnV0dG9uLFxuICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICBlbmRBY3RpdmUgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLFxuICAgICAgZGVkdWN0b3JBciA9IFtdLFxuICAgICAgc3RhcnRNdWx0aXBsaWVyLFxuICAgICAgZGVkdWN0b3IsXG4gICAgICBpLFxuICAgICAgaixcbiAgICAgIG1hcmdpbixcbiAgICAgIGZyb21EYXRlTGFiZWwsXG4gICAgICBncm91cDtcblxuICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG4gICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgfSk7XG5cbiAgICB1bmlncm91cCA9IG5ldyB0aGlzLnRvb2xib3guVW5pU2VsZWN0Q29tcG9uZW50R3JvdXAoe1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0pO1xuICAgIHVuaWdyb3VwLnNldENvbmZpZyh7XG4gICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICB9KTtcbiAgICBncm91cC5zZXRDb25maWcoe1xuICAgICAgZmlsbDogJyNmZmYnLFxuICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgfSk7XG4gICAgdG9vbGJhciA9IG5ldyB0aGlzLkhvcml6b250YWxUb29sYmFyKHtcbiAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICB9KTtcbiAgICB0b29sYmFyLnNldENvbmZpZyh7XG4gICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICB9KTtcbiAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnWm9vbTonLCB7XG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuICAgIH0sIHtcbiAgICAgIHRleHQ6IHtcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAnZm9udC1zaXplJzogJzE1JyxcbiAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG4gICAgYWxsQnV0dG9uID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2woJ0FMTCcsIHRydWUsIHtcbiAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICB9LCB7XG4gICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAnMicsXG4gICAgICBzeW1ib2xTdHJva2U6ICcjMDAwMDAwJyxcbiAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICBob3ZlckZpbGw6ICcjN2Y3ZjdmJyxcbiAgICAgIHJhZGl1czogMSxcbiAgICAgIG1hcmdpbjoge1xuICAgICAgICByaWdodDogNVxuICAgICAgfVxuICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgICAgIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICBzZWxmLmNsaWNrZWRJZCA9ICdBTEwnO1xuICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHVuaWdyb3VwLmFkZFN5bWJvbChhbGxCdXR0b24pO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvciAoaiA9IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICBkZWR1Y3RvckFyLnB1c2goc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gc2VsZi5zdGFydFBvaW50VW5pdDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGlmIChpID09PSBzZWxmLnN0YXJ0UG9pbnRVbml0KSB7XG4gICAgICAgIHN0YXJ0TXVsdGlwbGllciA9IHNlbGYuc3RhcnRQb2ludE11bHRpcGxpZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGogPSBzdGFydE11bHRpcGxpZXI7IGogPj0gMDsgai0tKSB7XG4gICAgICAgIG1hcmdpbiA9IChpID09PSBzZWxmLm5vQ2FsY0J1dHRvbnMgJiYgaiA9PT0gMCkgPyA1IDogMDtcbiAgICAgICAgY29uc29sZS5sb2coZW5kQWN0aXZlLCBpLCBzZWxmLm5vQ2FsY0J1dHRvbnMsIGosIG1hcmdpbik7XG4gICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zW2ldID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2woc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbiwgdHJ1ZSwge1xuICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgICAgfSwge1xuICAgICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcbiAgICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICAgIHN5bWJvbFN0cm9rZTogJyMwMDAwMDAnLFxuICAgICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICAgICAgaG92ZXJGaWxsOiAnIzdmN2Y3ZicsXG4gICAgICAgICAgcmFkaXVzOiAxLFxuICAgICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgICAgcmlnaHQ6IG1hcmdpblxuICAgICAgICAgIH1cbiAgICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGVkdWN0b3IgPSAoc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICBzZWxmLmNsaWNrZWRJZCA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChkZWR1Y3Rvcik7XG4gICAgICAgICAgICB0b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAgIHNlbGYuZHJhdygpO1xuICAgICAgICAgICAgLy8gdGhpcy50b29sYmFyc1t0aGlzLnRvb2xiYXJzLmxlbmd0aCAtIDFdID0gdGhpcy5jcmVhdGVUb29sYmFyKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGNhbGN1bGF0ZWRCdXR0b25zW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb250ZXh0dWFsQnV0dG9ucyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29udGV4dHVhbEJ1dHRvbnNbaV0gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSwge1xuICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICBzeW1ib2xTdHJva2U6ICcjMDAwMDAwJyxcbiAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcbiAgICAgICAgaG92ZXJGaWxsOiAnIzdmN2Y3ZicsXG4gICAgICAgIHJhZGl1czogMSxcbiAgICAgICAgbWFyZ2luOiB7XG4gICAgICAgICAgcmlnaHQ6IDBcbiAgICAgICAgfVxuICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgICdjbGljayc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kYXRlU3RhcnQsIHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmRhdGVFbmQpO1xuICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgc2VsZi50b29sYmFycy5wdXNoKHNlbGYuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgICAgICBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgIHNlbGYuZHJhdygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChjb250ZXh0dWFsQnV0dG9uc1tpXSk7XG4gICAgfVxuXG4gICAgICAvLyBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKTtcbiAgICAgIC8vIGJ0bi5pZCA9IHN0YW5kYXJkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAvLyBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgIC8vIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50QnRuLmJpbmQodGhpcywgc3RhbmRhcmRQZXJpb2RzW2ldKSk7XG4gICAgICAvLyBjb250ZXh0dWFsQnV0dG9ucy5hcHBlbmRDaGlsZChidG4pO1xuXG4gICAgdGhpcy5TeW1ib2xTdG9yZS5yZWdpc3RlcigndGV4dEJveEljb24nLCBmdW5jdGlvbiAoeCwgeSwgcmFkLCB3LCBoLCBwYWRYLCBwYWRZKSB7XG4gICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcbiAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcbiAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcbiAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblxuICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcbiAgICB9KTtcblxuICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KGdyb3VwKTtcbiAgICB0b29sYmFyLmFkZENvbXBvbmVudCh1bmlncm91cCk7XG4gICAgcmV0dXJuIHRvb2xiYXI7XG4gIH07XG5cbiAgZ2V0TG9naWNhbFNwYWNlIChhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KSB7XG4gICAgYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICB2YXIgbG9naWNhbFNwYWNlLFxuICAgICAgd2lkdGggPSAwLFxuICAgICAgaGVpZ2h0ID0gMCxcbiAgICAgIGksXG4gICAgICBsbjtcblxuICAgIGZvciAoaSA9IDAsIGxuID0gdGhpcy50b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICBsb2dpY2FsU3BhY2UgPSB0aGlzLnRvb2xiYXJzW2ldLmdldExvZ2ljYWxTcGFjZShhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICAgIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG4gICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICAgIHRoaXMudG9vbGJhcnNbaV0ud2lkdGggPSBsb2dpY2FsU3BhY2Uud2lkdGg7XG4gICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgfVxuICAgIGhlaWdodCArPSB0aGlzLnBhZGRpbmc7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgfTtcbiAgfTtcblxuICBwbGFjZUluQ2FudmFzICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICBzZWxmLnNwYWNlTWFuYWdlckluc3RhbmNlLmFkZChbe1xuICAgICAgbmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1leHQnO1xuICAgICAgfSxcbiAgICAgIHJlZjogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICB9LFxuICAgICAgc2VsZjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgIH0sXG4gICAgICBwcmlvcml0eTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMjtcbiAgICAgIH0sXG4gICAgICBsYXlvdXQ6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iai5pbmxpbmU7XG4gICAgICB9LFxuICAgICAgb3JpZW50YXRpb246IFt7XG4gICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqLmhvcml6b250YWw7XG4gICAgICAgIH0sXG4gICAgICAgIHBvc2l0aW9uOiBbe1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmoudG9wO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYWxpZ25tZW50OiBbe1xuICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLmxlZnQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGltZW5zaW9uczogW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0TG9naWNhbFNwYWNlKHBhcmVudC5nZXRXaWR0aCgpLCBwYXJlbnQuZ2V0SGVpZ2h0KCkpO1xuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV1cbiAgICB9XSk7XG4gIH07XG5cbiAgc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG4gICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG4gICAgbWVzLnggPSB4O1xuICAgIG1lcy55ID0geTtcbiAgICBtZXMud2lkdGggPSB3aWR0aDtcbiAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgdGhpcy5wYXJlbnRHcm91cCA9IGdyb3VwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgZHJhdyAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuICAgICAgbG4sXG4gICAgICBpLFxuICAgICAgdG9vbGJhcixcbiAgICAgIGJvdW5kRWxlbWVudCxcbiAgICAgIGJCb3gsXG4gICAgICB4MSxcbiAgICAgIHgyLFxuICAgICAgeTI7XG5cbiAgICB4ID0geCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueCA6IHg7XG4gICAgeSA9IHkgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnkgOiB5O1xuICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG4gICAgaGVpZ2h0ID0gaGVpZ2h0ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC5oZWlnaHQgOiBoZWlnaHQ7XG4gICAgZ3JvdXAgPSBncm91cCA9PT0gdW5kZWZpbmVkID8gdGhpcy5wYXJlbnRHcm91cCA6IGdyb3VwO1xuICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxuID0gdG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuICAgICAgICB0b29sYmFyID0gdG9vbGJhcnNbaV07XG4gICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKHRvb2xiYXJzKTtcbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0b29sYmFyc1swXS5jb21wb25lbnRHcm91cHNbMV0uc3ltYm9sTGlzdDsgaSA8IGlpLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaWlbaV0uc3ltYm9sID09PSB0aGlzLmNsaWNrZWRJZCkge1xuICAgICAgICBib3VuZEVsZW1lbnQgPSBpaVtpXS5nZXRCb3VuZEVsZW1lbnQoKTtcbiAgICAgICAgYkJveCA9IGJvdW5kRWxlbWVudC5nZXRCQm94KCk7XG4gICAgICAgIHgxID0gYkJveC54O1xuICAgICAgICB4MiA9IGJCb3gueDI7XG4gICAgICAgIHkyID0gYkJveC55MjtcblxuICAgICAgICB0aGlzLmdyYXBoaWNzLnBhcGVyLnBhdGgoe1xuICAgICAgICAgIHBhdGg6IFsnTScsIHgxLCB5MiAtIDIgLyAyLCAnTCcsIHgyLCB5MiAtIDIgLyAyXSxcbiAgICAgICAgICAnc3Ryb2tlJzogJyNmZjAwMDAnXG4gICAgICAgIH0pLnRvRnJvbnQoKTtcbiAgICAgICAgLy8gdGhpcy5fcGFyZW50R3JvdXAuc2V0U3RhdGUodGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cyA9IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG59IGVsc2Uge1xuICB3aW5kb3cuU3RhbmRhcmRQZXJpb2QgPSBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChkZXApIHtcbiAgY2xhc3MgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgLyoqXG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICovXG4gICAgICB0aGlzLnJhdGlvID0gODtcbiAgICAgIHRoaXMudG9vbGJveCA9IEZ1c2lvbkNoYXJ0cy5nZXRDb21wb25lbnQoJ2FwaScsICd0b29sYm94Jyk7XG4gICAgICB0aGlzLkhvcml6b250YWxUb29sYmFyID0gdGhpcy50b29sYm94Lkhvcml6b250YWxUb29sYmFyO1xuICAgICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcbiAgICAgIHRoaXMuU3ltYm9sU3RvcmUgPSB0aGlzLnRvb2xib3guU3ltYm9sU3RvcmU7XG4gICAgICB0aGlzLmFsbCA9IDE7XG4gICAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IDA7XG4gICAgICAvLyB0aGlzLmVuZERhdGFzZXQgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSAwO1xuICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSAxO1xuICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuICAgICAgdGhpcy5zdGFydFBvaW50VW5pdCA9IDA7XG4gICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gMDtcbiAgICAgIHRoaXMuY2xpY2tlZElkO1xuICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gMDtcbiAgICAgIHRoaXMudGltZVBlcmlvZHMgPSBbe1xuICAgICAgICAnbmFtZSc6ICdzZWNvbmQnLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogMTAwMCxcbiAgICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgICAndG90YWwnOiA2MCxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdzZWMnLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnU0VDT05EJyxcbiAgICAgICAgJ3BhcmVudCc6ICdtaW51dGUnLFxuICAgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgNSwgMTUsIDMwXVxuICAgICAgfSwge1xuICAgICAgICAnbmFtZSc6ICdtaW51dGUnLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogNjAwMDAsXG4gICAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICAgJ3RvdGFsJzogNjAsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnbWluJyxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01JTlVURScsXG4gICAgICAgICdwYXJlbnQnOiAnaG91cicsXG4gICAgICAgICdtdWx0aXBsaWVycyc6IFsxLCA1LCAxNSwgMzBdXG4gICAgICB9LCB7XG4gICAgICAgICduYW1lJzogJ2hvdXInLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzYwMDAwMCxcbiAgICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgICAndG90YWwnOiAyNCxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdocicsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdIT1VSJyxcbiAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNiwgMTJdXG4gICAgICB9LCB7XG4gICAgICAgICduYW1lJzogJ2RheScsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgICAndG90YWwnOiAzMCxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdEJyxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG4gICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgNywgMTVdXG4gICAgICB9LCB7XG4gICAgICAgICduYW1lJzogJ21vbnRoJyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICAgJ3RvdGFsJzogMTIsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnTScsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdNT05USCcsXG4gICAgICAgICdwYXJlbnQnOiAneWVhcicsXG4gICAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAzLCA2XVxuICAgICAgfSwge1xuICAgICAgICAnbmFtZSc6ICd5ZWFyJyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuICAgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdZRUFSJyxcbiAgICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDVdXG4gICAgICB9XTtcbiAgICAgIHRoaXMudGRCdXR0b25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnWVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1lURCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llYXIgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1FURCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAgICdtdWx0aXBsaWVyJzogMyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnTVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdXVEQnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ211bHRpcGxpZXInOiA3LFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1knLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVzdGVyZGF5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnVCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcbiAgICAgICAgfVxuICAgICAgXTtcbiAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICBhbmNob3JQb3NpdGlvbnM6ICdyaWdodCcsXG4gICAgICAgIGFsbDogJzEnLFxuICAgICAgICBjb250ZXh0dWFsOiAnMScsXG4gICAgICAgIGNhbGN1bGF0ZWQ6ICcxJyxcbiAgICAgICAgdGVydGlhcnlUaW1lUGVyaW9kczoge31cbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY2FsY3VsYXRlZCBidXR0b25zIHVzaW5nXG4gICAgICogdGhlIGFjdGl2ZSByYW5nZSBhbmQgdGhlIGxvY2F0aW9uIG9mIHRoZSBhY3RpdmUgcmFuZ2VcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zICgpIHtcbiAgICAgIHZhciB0YXJnZXRCbG9jayA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydERhdGFzZXQsXG4gICAgICAgIGkgPSAwLFxuICAgICAgICBqID0gMCxcbiAgICAgICAgYWN0aXZlV2luZG93ID0gdGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93LFxuICAgICAgICBjb3VudCA9IDA7XG4gICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgYXBwbGljYWJsZSBmb3IgdGhlIGN1cnJlbnQgdGFyZ2V0IGJsb2NrXG4gICAgICAgIGlmICh0YXJnZXRCbG9jayAvIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzID49IDEpIHtcbiAgICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIG9mIHRoZSBoaWdoZXIgb3JkZXIgYW5kIG9ubHkgbXVsdGlwbGllciAxIGlzIGFwcGxpY2FibGVcbiAgICAgICAgICBpZiAoTWF0aC5mbG9vcigoYWN0aXZlV2luZG93KSAvIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKSA8IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5wdXNoKHtcbiAgICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLFxuICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMsXG4gICAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFsxXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHsgLy8gaWYgdGhlIHVuaXQgaXMgb2YgdGhlIG9yZGVyIG9mIHRoZSB0YXJnZXQgYmxvY2sgYW5kIGNhbGN1bGF0aW5nIHRoZSBtdWx0aXBsaWVyc1xuICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyB0aGlzLnJhdGlvIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW3RoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGggLSAxXS5tdWx0aXBsaWVycy5wdXNoKFxuICAgICAgICAgICAgICAgICAgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gSW5maW5pdHk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICArK2NvdW50O1xuICAgICAgICAgIGlmICh0aGlzLm5vQ2FsY0J1dHRvbnMgPiBpKSB7XG4gICAgICAgICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY291bnQgPD0gNCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IGo7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gaTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjb250ZXh0dWFsIGJ1dHRvbnMgdXNpbmdcbiAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG4gICAgICovXG4gICAgZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucyAoKSB7XG4gICAgICAvLyBnZW5lcmF0aW5nIGFuIGFycmF5IHdpdGggYXBwbGljYWJsZSBURCBidXR0b25zXG4gICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgZW5kU3RhbXAgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXSxcbiAgICAgICAgZGF0ZVN0YXJ0ID0gZW5kU3RhbXAgLSAyLFxuICAgICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG4gICAgICAgIHJlbGF0aXZlVERCdXR0b24gPSB7fTtcbiAgICAgIGZvciAoOyBpIDwgdGhpcy50ZEJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoZW5kU3RhbXApO1xuICAgICAgICBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1lURCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdRVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDExIC0gKGRhdGVTdGFydC5nZXRNb250aCgpICUgNCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKGRhdGVTdGFydC5nZXREYXRlKCkgLSBkYXRlU3RhcnQuZ2V0RGF5KCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnWScpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdUJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRlRW5kIDwgZGF0ZVN0YXJ0KSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50ZEJ1dHRvbnNbaV0uZGF0ZVN0YXJ0ID0gZGF0ZVN0YXJ0LnZhbHVlT2YoKTtcbiAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG4gICAgICAgICAgYnV0dG9ucy5wdXNoKHRoaXMudGRCdXR0b25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMgPSBJbmZpbml0eTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzIC0gKHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdykpIDwgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMpIHtcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IHRoaXMudGRCdXR0b25zW2ldLm1pbGxpc2Vjb25kcztcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm5hbWUgPSB0aGlzLnRkQnV0dG9uc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMgPSBidXR0b25zO1xuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NvbnRleHR1YWwodGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBhY3RpdmUgcGVyaW9kJ3NcbiAgICAgKiBzdGFydCBhbmQgZW5kIHBvaW50XG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIHN0YXJ0IHBvaW50IG9mIGFjdGl2ZSBwZXJpb2RcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIGFjdGl2ZSBwZXJpb2RcbiAgICAgKi9cbiAgICBzZXRBY3RpdmVQZXJpb2QgKCkge1xuICAgICAgdmFyIHN0YXJ0LFxuICAgICAgICBlbmQ7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBlbmQgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuICAgICAgICBzdGFydCA9IGVuZCAtIGFyZ3VtZW50c1swXTtcbiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBzdGFydCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgZW5kID0gYXJndW1lbnRzWzFdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGVuZDtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddID0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgICAqIGVudGlyZSB0aW1lLWxpbmVcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgdGltZS1saW5lXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICAgKi9cbiAgICBzZXRUaW1lbGluZSAoc3RhcnQsIGVuZCkge1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBzdGFydDtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGVuZDtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5zdGFydERhdGFzZXQpO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmREYXRhc2V0KTtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBvYmplY3QgdG8gc2V0IHRoZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICovXG4gICAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAgICovXG4gICAgaW5pdCAocmVxdWlyZSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHJlcXVpcmUoW1xuICAgICAgICAneEF4aXMnLFxuICAgICAgICAneUF4aXMnLFxuICAgICAgICAnZ3JhcGhpY3MnLFxuICAgICAgICAnY2hhcnQnLFxuICAgICAgICAnZGF0YXNldCcsXG4gICAgICAgICdQbG90TWFuYWdlcicsXG4gICAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAgICdyZWFjdGl2ZU1vZGVsJyxcbiAgICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgICAnc21hcnRMYWJlbCcsXG4gICAgICAgIGZ1bmN0aW9uIChcbiAgICAgICAgICAgICAgeEF4aXMsXG4gICAgICAgICAgICAgIHlBeGlzLFxuICAgICAgICAgICAgICBncmFwaGljcyxcbiAgICAgICAgICAgICAgY2hhcnQsXG4gICAgICAgICAgICAgIGRhdGFzZXQsXG4gICAgICAgICAgICAgIHBsb3RNYW5hZ2VyLFxuICAgICAgICAgICAgICBjYW52YXNDb25maWcsXG4gICAgICAgICAgICAgIG1hcmtlck1hbmFnZXIsXG4gICAgICAgICAgICAgIHJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICAgIGdsb2JhbFJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICAgIHNwYWNlTWFuYWdlckluc3RhbmNlLFxuICAgICAgICAgICAgICBzbWFydExhYmVsKSB7XG4gICAgICAgICAgaW5zdGFuY2UueEF4aXMgPSB4QXhpcztcbiAgICAgICAgICBpbnN0YW5jZS55QXhpcyA9IHlBeGlzO1xuICAgICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gZ3JhcGhpY3M7XG4gICAgICAgICAgaW5zdGFuY2UuY2hhcnQgPSBjaGFydDtcbiAgICAgICAgICBpbnN0YW5jZS5kYXRhc2V0ID0gZGF0YXNldDtcbiAgICAgICAgICBpbnN0YW5jZS5wbG90TWFuYWdlciA9IHBsb3RNYW5hZ2VyO1xuICAgICAgICAgIGluc3RhbmNlLm1hcmtlck1hbmFnZXIgPSBtYXJrZXJNYW5hZ2VyO1xuICAgICAgICAgIGluc3RhbmNlLmNhbnZhc0NvbmZpZyA9IGNhbnZhc0NvbmZpZztcbiAgICAgICAgICBpbnN0YW5jZS5yZWFjdGl2ZU1vZGVsID0gcmVhY3RpdmVNb2RlbDtcbiAgICAgICAgICBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gZ2xvYmFsUmVhY3RpdmVNb2RlbDtcbiAgICAgICAgICBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IHNwYWNlTWFuYWdlckluc3RhbmNlO1xuICAgICAgICAgIGluc3RhbmNlLnNtYXJ0TGFiZWwgPSBzbWFydExhYmVsO1xuICAgICAgICB9XG4gICAgICBdKTtcbiAgICAgIHRoaXMuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG4gICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5lbmREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy5zZXRBY3RpdmVQZXJpb2QodGhpcy5zdGFydEFjdGl2ZVdpbmRvdywgdGhpcy5lbmRBY3RpdmVXaW5kb3cpO1xuICAgICAgLy8gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsnX3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gKz0gMTI0NDE2MDAwMDAwO1xuICAgICAgdGhpcy5zZXRBY3RpdmVQZXJpb2QodGhpcy5zdGFydEFjdGl2ZVdpbmRvdywgdGhpcy5lbmRBY3RpdmVXaW5kb3cpO1xuXG4gICAgICB0aGlzLnRvb2xiYXJzID0gW107XG5cbiAgICAgIHRoaXMubWVhc3VyZW1lbnQgPSB7fTtcblxuICAgICAgdGhpcy50b29sYmFycy5wdXNoKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBjcmVhdGVUb29sYmFyICgpIHtcbiAgICAgIHZhciB1bmlncm91cCxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMsXG4gICAgICAgIGNvbnRleHR1YWxCdXR0b25zLFxuICAgICAgICBhbGxCdXR0b24sXG4gICAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgICBlbmRBY3RpdmUgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLFxuICAgICAgICBkZWR1Y3RvckFyID0gW10sXG4gICAgICAgIHN0YXJ0TXVsdGlwbGllcixcbiAgICAgICAgZGVkdWN0b3IsXG4gICAgICAgIGksXG4gICAgICAgIGosXG4gICAgICAgIG1hcmdpbixcbiAgICAgICAgZnJvbURhdGVMYWJlbCxcbiAgICAgICAgZ3JvdXA7XG5cbiAgICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuXG4gICAgICB1bmlncm91cCA9IG5ldyB0aGlzLnRvb2xib3guVW5pU2VsZWN0Q29tcG9uZW50R3JvdXAoe1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9KTtcbiAgICAgIHVuaWdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIGdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIHRvb2xiYXIgPSBuZXcgdGhpcy5Ib3Jpem9udGFsVG9vbGJhcih7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuICAgICAgdG9vbGJhci5zZXRDb25maWcoe1xuICAgICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgICAgfSk7XG4gICAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnWm9vbTonLCB7XG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcbiAgICAgIH0sIHtcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAnZm9udC1zaXplJzogJzE1JyxcbiAgICAgICAgICAgICdmb250RmFtaWx5JzogJ015cmlhZFBybydcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgZ3JvdXAuYWRkU3ltYm9sKGZyb21EYXRlTGFiZWwpO1xuICAgICAgYWxsQnV0dG9uID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2woJ0FMTCcsIHRydWUsIHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSwge1xuICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICBzeW1ib2xTdHJva2U6ICcjMDAwMDAwJyxcbiAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcbiAgICAgICAgaG92ZXJGaWxsOiAnIzdmN2Y3ZicsXG4gICAgICAgIHJhZGl1czogMSxcbiAgICAgICAgbWFyZ2luOiB7XG4gICAgICAgICAgcmlnaHQ6IDVcbiAgICAgICAgfVxuICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChhbGxCdXR0b24pO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmb3IgKGogPSB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICBkZWR1Y3RvckFyLnB1c2goc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSBzZWxmLnN0YXJ0UG9pbnRVbml0OyBpID49IDA7IGktLSkge1xuICAgICAgICBpZiAoaSA9PT0gc2VsZi5zdGFydFBvaW50VW5pdCkge1xuICAgICAgICAgIHN0YXJ0TXVsdGlwbGllciA9IHNlbGYuc3RhcnRQb2ludE11bHRpcGxpZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RhcnRNdWx0aXBsaWVyID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0TXVsdGlwbGllcjsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICBtYXJnaW4gPSAoaSA9PT0gc2VsZi5ub0NhbGNCdXR0b25zICYmIGogPT09IDApID8gNSA6IDA7XG4gICAgICAgICAgY29uc29sZS5sb2coZW5kQWN0aXZlLCBpLCBzZWxmLm5vQ2FsY0J1dHRvbnMsIGosIG1hcmdpbik7XG4gICAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnNbaV0gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLCB0cnVlLCB7XG4gICAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmlsbDogJyNmZmZmZmYnLFxuICAgICAgICAgICAgbGFiZWxGaWxsOiAnIzY5Njk2OScsXG4gICAgICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICAgICAgc3ltYm9sU3Ryb2tlOiAnIzAwMDAwMCcsXG4gICAgICAgICAgICBzdHJva2VXaWR0aDogJzEnLFxuICAgICAgICAgICAgaG92ZXJGaWxsOiAnIzdmN2Y3ZicsXG4gICAgICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgcmlnaHQ6IG1hcmdpblxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBkZWR1Y3RvciA9IChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChkZWR1Y3Rvcik7XG4gICAgICAgICAgICAgIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgICBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAgICAgLy8gdGhpcy50b29sYmFyc1t0aGlzLnRvb2xiYXJzLmxlbmd0aCAtIDFdID0gdGhpcy5jcmVhdGVUb29sYmFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGNhbGN1bGF0ZWRCdXR0b25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb250ZXh0dWFsQnV0dG9ucyA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnRleHR1YWxCdXR0b25zW2ldID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2wodGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLCB0cnVlLCB7XG4gICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgICB9LCB7XG4gICAgICAgICAgZmlsbDogJyNmZmZmZmYnLFxuICAgICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuICAgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAnMicsXG4gICAgICAgICAgc3ltYm9sU3Ryb2tlOiAnIzAwMDAwMCcsXG4gICAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcbiAgICAgICAgICBob3ZlckZpbGw6ICcjN2Y3ZjdmJyxcbiAgICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgICAgbWFyZ2luOiB7XG4gICAgICAgICAgICByaWdodDogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uZGF0ZVN0YXJ0LCBzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kYXRlRW5kKTtcbiAgICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgICAgc2VsZi50b29sYmFycy5wdXNoKHNlbGYuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgICAgICAgIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG4gICAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB1bmlncm91cC5hZGRTeW1ib2woY29udGV4dHVhbEJ1dHRvbnNbaV0pO1xuICAgICAgfVxuXG4gICAgICAgIC8vIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpO1xuICAgICAgICAvLyBidG4uaWQgPSBzdGFuZGFyZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAvLyBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgLy8gYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnRCdG4uYmluZCh0aGlzLCBzdGFuZGFyZFBlcmlvZHNbaV0pKTtcbiAgICAgICAgLy8gY29udGV4dHVhbEJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnRuKTtcblxuICAgICAgdGhpcy5TeW1ib2xTdG9yZS5yZWdpc3RlcigndGV4dEJveEljb24nLCBmdW5jdGlvbiAoeCwgeSwgcmFkLCB3LCBoLCBwYWRYLCBwYWRZKSB7XG4gICAgICAgIHZhciB4MSA9IHggLSB3IC8gMiArIHBhZFggLyAyLFxuICAgICAgICAgIHgyID0geCArIHcgLyAyIC0gcGFkWCAvIDIsXG4gICAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcbiAgICAgICAgICB5MiA9IHkgKyBoIC8gMiAtIHBhZFkgLyAyO1xuXG4gICAgICAgIHJldHVybiBbJ00nLCB4MSwgeTEsICdMJywgeDIsIHkxLCAnTCcsIHgyLCB5MiwgJ0wnLCB4MSwgeTIsICdaJ107XG4gICAgICB9KTtcblxuICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQoZ3JvdXApO1xuICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQodW5pZ3JvdXApO1xuICAgICAgcmV0dXJuIHRvb2xiYXI7XG4gICAgfTtcblxuICAgIGdldExvZ2ljYWxTcGFjZSAoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCkge1xuICAgICAgYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICAgIHZhciBsb2dpY2FsU3BhY2UsXG4gICAgICAgIHdpZHRoID0gMCxcbiAgICAgICAgaGVpZ2h0ID0gMCxcbiAgICAgICAgaSxcbiAgICAgICAgbG47XG5cbiAgICAgIGZvciAoaSA9IDAsIGxuID0gdGhpcy50b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgIGxvZ2ljYWxTcGFjZSA9IHRoaXMudG9vbGJhcnNbaV0uZ2V0TG9naWNhbFNwYWNlKGF2YWlsYWJsZVdpZHRoLCBhdmFpbGFibGVIZWlnaHQpO1xuICAgICAgICB3aWR0aCA9IE1hdGgubWF4KGxvZ2ljYWxTcGFjZS53aWR0aCwgd2lkdGgpO1xuICAgICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICAgICAgdGhpcy50b29sYmFyc1tpXS53aWR0aCA9IGxvZ2ljYWxTcGFjZS53aWR0aDtcbiAgICAgICAgdGhpcy50b29sYmFyc1tpXS5oZWlnaHQgPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuICAgICAgfVxuICAgICAgaGVpZ2h0ICs9IHRoaXMucGFkZGluZztcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHBsYWNlSW5DYW52YXMgKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICAgIHNlbGYuc3BhY2VNYW5hZ2VySW5zdGFuY2UuYWRkKFt7XG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1leHQnO1xuICAgICAgICB9LFxuICAgICAgICByZWY6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGY6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpb3JpdHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgfSxcbiAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIG9iai5pbmxpbmU7XG4gICAgICAgIH0sXG4gICAgICAgIG9yaWVudGF0aW9uOiBbe1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmouaG9yaXpvbnRhbDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvc2l0aW9uOiBbe1xuICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLnRvcDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG4gICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmxlZnQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRpbWVuc2lvbnM6IFtmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRMb2dpY2FsU3BhY2UocGFyZW50LmdldFdpZHRoKCksIHBhcmVudC5nZXRIZWlnaHQoKSk7XG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dXG4gICAgICAgIH1dXG4gICAgICB9XSk7XG4gICAgfTtcblxuICAgIHNldERyYXdpbmdDb25maWd1cmF0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG4gICAgICBtZXMueCA9IHg7XG4gICAgICBtZXMueSA9IHk7XG4gICAgICBtZXMud2lkdGggPSB3aWR0aDtcbiAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgIHRoaXMucGFyZW50R3JvdXAgPSBncm91cDtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIGRyYXcgKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG4gICAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG4gICAgICAgIGxuLFxuICAgICAgICBpLFxuICAgICAgICB0b29sYmFyLFxuICAgICAgICBib3VuZEVsZW1lbnQsXG4gICAgICAgIGJCb3gsXG4gICAgICAgIHgxLFxuICAgICAgICB4MixcbiAgICAgICAgeTI7XG5cbiAgICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcbiAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcbiAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcbiAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcbiAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKHRvb2xiYXJzKTtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHRvb2xiYXJzWzBdLmNvbXBvbmVudEdyb3Vwc1sxXS5zeW1ib2xMaXN0OyBpIDwgaWkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGlpW2ldLnN5bWJvbCA9PT0gdGhpcy5jbGlja2VkSWQpIHtcbiAgICAgICAgICBib3VuZEVsZW1lbnQgPSBpaVtpXS5nZXRCb3VuZEVsZW1lbnQoKTtcbiAgICAgICAgICBiQm94ID0gYm91bmRFbGVtZW50LmdldEJCb3goKTtcbiAgICAgICAgICB4MSA9IGJCb3gueDtcbiAgICAgICAgICB4MiA9IGJCb3gueDI7XG4gICAgICAgICAgeTIgPSBiQm94LnkyO1xuXG4gICAgICAgICAgdGhpcy5ncmFwaGljcy5wYXBlci5wYXRoKHtcbiAgICAgICAgICAgIHBhdGg6IFsnTScsIHgxLCB5MiAtIDIgLyAyLCAnTCcsIHgyLCB5MiAtIDIgLyAyXSxcbiAgICAgICAgICAgICdzdHJva2UnOiAnI2ZmMDAwMCdcbiAgICAgICAgICB9KS50b0Zyb250KCk7XG4gICAgICAgICAgLy8gdGhpcy5fcGFyZW50R3JvdXAuc2V0U3RhdGUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXX0=

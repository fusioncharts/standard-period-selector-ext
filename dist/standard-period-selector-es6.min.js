(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false };modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports;}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0);})([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1);},function(module,exports,__webpack_require__){'use strict';const StandardPeriodSelector=__webpack_require__(2);window.stPS=new StandardPeriodSelector();window.timePeriods=[{'name':'minute','milliseconds':60000,'startingPoint':0,'abbreviation':'min','description':'MINUTE','parent':'hour','multipliers':[1,15,30]},{'name':'hour','milliseconds':3600000,'startingPoint':0,'abbreviation':'hr','description':'HOUR','parent':'day','multipliers':[1,3,6,12]},{'name':'day','milliseconds':86400000,'startingPoint':0,'abbreviation':'D','description':'DAY','parent':'month','multipliers':[1,7,15]},{'name':'month','milliseconds':2592000000,'startingPoint':0,'abbreviation':'M','description':'MONTH','parent':'year','multipliers':[1,3,6]},{'name':'year','milliseconds':31104000000,'startingPoint':0,'abbreviation':'Y','description':'YEAR','multipliers':[1,3,5]}];},function(module,exports){'use strict';class StandardPeriodSelector{constructor(){this.all=1;this.calculatedPeriods=[];this.startDataset=0;this.endDataset=7999999999999;this.startActiveWindow=55000000;this.endActiveWindow=60000000;this.standardPeriods=[];this.timePeriods=[{'name':'minute','milliseconds':60000,'startingPoint':0,'abbreviation':'min','description':'MINUTE','parent':'hour','multipliers':[1,15,30]},{'name':'hour','milliseconds':3600000,'startingPoint':0,'abbreviation':'hr','description':'HOUR','parent':'day','multipliers':[1,3,6,12]},{'name':'day','milliseconds':86400000,'startingPoint':0,'abbreviation':'D','description':'DAY','parent':'month','multipliers':[1,7,15]},{'name':'month','milliseconds':2592000000,'startingPoint':0,'abbreviation':'M','description':'MONTH','parent':'year','multipliers':[1,3,6]},{'name':'year','milliseconds':31104000000,'startingPoint':0,'abbreviation':'Y','description':'YEAR','multipliers':[1,3,5]}];this.config={}}calculateApplicableUnitPeriods(){var targetBlock=this.endActiveWindow-this.startDataset;var i=0;var j=0;var activeWindow=this.endActiveWindow-this.startActiveWindow;this.standardPeriods=[];console.log('activeWindow',activeWindow);for(i=0;i<this.timePeriods.length;i+=1){if(targetBlock/this.timePeriods[i].milliseconds>=1){if(Math.floor((activeWindow)/this.timePeriods[i].milliseconds)<1){this.standardPeriods.push({'abbreviation':this.timePeriods[i].abbreviation,'description':this.timePeriods[i].description,'milliseconds':this.timePeriods[i].milliseconds,'multipliers':[1]})}else{this.standardPeriods.push({'abbreviation':this.timePeriods[i].abbreviation,'description':this.timePeriods[i].description,'milliseconds':this.timePeriods[i].milliseconds,'multipliers':[]});for(j=0;j<this.timePeriods[i].multipliers.length;j+=1){if(activeWindow/10<this.timePeriods[i].multipliers[j]*this.timePeriods[i].milliseconds){this.standardPeriods[this.standardPeriods.length-1].multipliers.push(this.timePeriods[i].multipliers[j])}}}}}this.drawButtons(this.standardPeriods);return this.standardPeriods}calculateApplicableStandardPeriods(){var applicableStandardUnitPeriod=this.calculateApplicableStandardPeriods();return applicableStandardUnitPeriod}setActivePeriod(start,end){console.log(start,end);this.startActiveWindow=start;this.endActiveWindow=end;document.getElementById('startActiveRange').innerHTML=new Date(this.startActiveWindow);document.getElementById('endActiveRange').innerHTML=new Date(this.endActiveWindow);this.calculateApplicableUnitPeriods()}setTimeline(start,end){console.log(start,end);this.startDataset=start;this.endDataset=end;document.getElementById('startActiveRange').innerHTML=new Date(this.startDataset);document.getElementById('endActiveRange').innerHTML=new Date(this.endDataset);this.calculateApplicableUnitPeriods()}setActivePeriodStart(start){this.startActiveWindow=this.endActiveWindow-start;this.calculateApplicableUnitPeriods()}setActivePeriodEnd(end){this.endActiveWindow=this.startActiveWindow+end;this.calculateApplicableUnitPeriods()}drawButtons(standardPeriods){var calculatedButtons=document.getElementById('calculated');var btn;var i=0;var j=0;var multiplierValue=0;var self=this;calculatedButtons.innerHTML='';for(i=standardPeriods.length-1;i>=0;i-=1){for(j=standardPeriods[i].multipliers.length-1;j>=0;j-=1){btn=document.createElement('BUTTON');btn.id=standardPeriods[i].multipliers[j]+standardPeriods[i].abbreviation;btn.innerHTML=standardPeriods[i].multipliers[j]+standardPeriods[i].abbreviation;multiplierValue=standardPeriods[i].multipliers[j]*standardPeriods[i].milliseconds;btn.multiplierValue=multiplierValue;btn.addEventListener('click',function(event){self.setActivePeriod(self.endActiveWindow-event.srcElement.multiplierValue,self.endActiveWindow)});calculatedButtons.appendChild(btn)}}this.standardPeriods=[]}setChartRangeObButtonClick(){}configure(config){this.config=config}init(require){require('X-Axis','Y-Axis','graphics','chart','extensionData','dateFormatter',function(x,y,graphics,chart,extData,dateFormatter){})}placeInCanvas(){}draw(){}dispose(){}}if(typeof module!=='undefined'&&typeof module.exports!=='undefined'){module.exports=StandardPeriodSelector}else{window.StandardPeriod=StandardPeriodSelector}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgODA5MTdmYzQ1ZTczODJkMWEzZTgiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDdENBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUMsR0FBRzs7Ozs7OztBQ3hESjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWUsNkJBQTZCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWCxVQUFTLE9BQU87QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBLHNCQUFxQiw0Q0FBNEM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXdDLFFBQVE7QUFDaEQsMERBQXlELFFBQVE7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLFFBQU87QUFDUDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0EiLCJmaWxlIjoic3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA4MDkxN2ZjNDVlNzM4MmQxYTNlOCIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSByZXF1aXJlKCcuL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3RvcicpO1xuXG53aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG53aW5kb3cudGltZVBlcmlvZHMgPSBbe1xuICAnbmFtZSc6ICdtaW51dGUnLFxuICAnbWlsbGlzZWNvbmRzJzogNjAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdtaW4nLFxuICAnZGVzY3JpcHRpb24nOiAnTUlOVVRFJyxcbiAgJ3BhcmVudCc6ICdob3VyJyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDE1LCAzMF1cbn0sIHtcbiAgJ25hbWUnOiAnaG91cicsXG4gICdtaWxsaXNlY29uZHMnOiAzNjAwMDAwLFxuICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICdhYmJyZXZpYXRpb24nOiAnaHInLFxuICAnZGVzY3JpcHRpb24nOiAnSE9VUicsXG4gICdwYXJlbnQnOiAnZGF5JyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxufSwge1xuICAnbmFtZSc6ICdkYXknLFxuICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdEJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG4gICdwYXJlbnQnOiAnbW9udGgnLFxuICAnbXVsdGlwbGllcnMnOiBbMSwgNywgMTVdXG59LCB7XG4gICduYW1lJzogJ21vbnRoJyxcbiAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdNJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ01PTlRIJyxcbiAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDZdXG59LCB7XG4gICduYW1lJzogJ3llYXInLFxuICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdZJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ1lFQVInLFxuICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNV1cbn1dO1xuXG4vLyB2YXIgZmMgPSBuZXcgRnVzaW9uQ2hhcnRzKCk7XG5cbi8qIEZ1c2lvbkNoYXJ0cy5yZWdpc3RlcignZXh0ZW5zaW9uJywgWydzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InLCBmdW5jdGlvbiAoaWQpIHtcbiAgdmFyIGdsb2JhbCA9IHRoaXM7XG4gIHZhciBleHRBUEkgPSBnbG9iYWwuZXh0QVBJO1xuXG4gIC8vIHZhciBvdGhlckFQSSA9IEZ1c2lvbkNoYXJ0cy5nZXRFeHRDb21wb25lbnQoaWQsICdhcGknLCAnbGVnYWN5ZXh0YXBpJyk7XG4gIC8vIHZhciB0b29sQm94QXBpID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcblxuICB3aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG4gIGV4dEFQSSh3aW5kb3cuc3RQUyk7XG59XSk7ICovXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbmNsYXNzIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Ige1xuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgdGhpcy5hbGwgPSAxO1xuICAgIHRoaXMuY2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IDA7XG4gICAgdGhpcy5lbmREYXRhc2V0ID0gNzk5OTk5OTk5OTk5OTtcbiAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gNTUwMDAwMDA7XG4gICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSA2MDAwMDAwMDtcbiAgICB0aGlzLnN0YW5kYXJkUGVyaW9kcyA9IFtdO1xuICAgIHRoaXMudGltZVBlcmlvZHMgPSBbe1xuICAgICAgJ25hbWUnOiAnbWludXRlJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiA2MDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnbWluJyxcbiAgICAgICdkZXNjcmlwdGlvbic6ICdNSU5VVEUnLFxuICAgICAgJ3BhcmVudCc6ICdob3VyJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAxNSwgMzBdXG4gICAgfSwge1xuICAgICAgJ25hbWUnOiAnaG91cicsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogMzYwMDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnaHInLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0hPVVInLFxuICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxuICAgIH0sIHtcbiAgICAgICduYW1lJzogJ2RheScsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ0QnLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG4gICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCA3LCAxNV1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICdtb250aCcsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogMjU5MjAwMDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICdhYmJyZXZpYXRpb24nOiAnTScsXG4gICAgICAnZGVzY3JpcHRpb24nOiAnTU9OVEgnLFxuICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAzLCA2XVxuICAgIH0sIHtcbiAgICAgICduYW1lJzogJ3llYXInLFxuICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ2FiYnJldmlhdGlvbic6ICdZJyxcbiAgICAgICdkZXNjcmlwdGlvbic6ICdZRUFSJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAzLCA1XVxuICAgIH1dO1xuICAgIHRoaXMuY29uZmlnID0ge307XG4gIH1cblxuICBjYWxjdWxhdGVBcHBsaWNhYmxlVW5pdFBlcmlvZHMgKCkge1xuICAgIHZhciB0YXJnZXRCbG9jayA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydERhdGFzZXQ7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBqID0gMDtcbiAgICB2YXIgYWN0aXZlV2luZG93ID0gdGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93O1xuICAgIHRoaXMuc3RhbmRhcmRQZXJpb2RzID0gW107XG4gICAgY29uc29sZS5sb2coJ2FjdGl2ZVdpbmRvdycsIGFjdGl2ZVdpbmRvdyk7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMudGltZVBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgYXBwbGljYWJsZSBmb3IgdGhlIGN1cnJlbnQgdGFyZ2V0IGJsb2NrXG4gICAgICBpZiAodGFyZ2V0QmxvY2sgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyA+PSAxKSB7XG4gICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgb2YgdGhlIGhpZ2hlciBvcmRlciBhbmQgb25seSBtdWx0aXBsaWVyIDEgaXMgYXBwbGljYWJsZVxuICAgICAgICBpZiAoTWF0aC5mbG9vcigoYWN0aXZlV2luZG93KSAvIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKSA8IDEpIHtcbiAgICAgICAgICB0aGlzLnN0YW5kYXJkUGVyaW9kcy5wdXNoKHtcbiAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbixcbiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMsXG4gICAgICAgICAgICAnbXVsdGlwbGllcnMnOiBbMV1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHsgLy8gaWYgdGhlIHVuaXQgaXMgb2YgdGhlIG9yZGVyIG9mIHRoZSB0YXJnZXQgYmxvY2sgYW5kIGNhbGN1bGF0aW5nIHRoZSBtdWx0aXBsaWVyc1xuICAgICAgICAgIHRoaXMuc3RhbmRhcmRQZXJpb2RzLnB1c2goe1xuICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLFxuICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyxcbiAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFtdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgaWYgKGFjdGl2ZVdpbmRvdyAvIDEwIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRQZXJpb2RzW3RoaXMuc3RhbmRhcmRQZXJpb2RzLmxlbmd0aCAtIDFdLm11bHRpcGxpZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZHJhd0J1dHRvbnModGhpcy5zdGFuZGFyZFBlcmlvZHMpO1xuICAgIHJldHVybiB0aGlzLnN0YW5kYXJkUGVyaW9kcztcbiAgfVxuXG4gIGNhbGN1bGF0ZUFwcGxpY2FibGVTdGFuZGFyZFBlcmlvZHMgKCkge1xuICAgIHZhciBhcHBsaWNhYmxlU3RhbmRhcmRVbml0UGVyaW9kID0gdGhpcy5jYWxjdWxhdGVBcHBsaWNhYmxlU3RhbmRhcmRQZXJpb2RzKCk7XG4gICAgcmV0dXJuIGFwcGxpY2FibGVTdGFuZGFyZFVuaXRQZXJpb2Q7XG4gIH1cblxuICBzZXRBY3RpdmVQZXJpb2QgKHN0YXJ0LCBlbmQpIHtcbiAgICBjb25zb2xlLmxvZyhzdGFydCwgZW5kKTtcbiAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG4gICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSBlbmQ7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0QWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLnN0YXJ0QWN0aXZlV2luZG93KTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZW5kQWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLmVuZEFjdGl2ZVdpbmRvdyk7XG4gICAgdGhpcy5jYWxjdWxhdGVBcHBsaWNhYmxlVW5pdFBlcmlvZHMoKTtcbiAgfVxuXG4gIHNldFRpbWVsaW5lIChzdGFydCwgZW5kKSB7XG4gICAgY29uc29sZS5sb2coc3RhcnQsIGVuZCk7XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSBzdGFydDtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSBlbmQ7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0QWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLnN0YXJ0RGF0YXNldCk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmREYXRhc2V0KTtcbiAgICB0aGlzLmNhbGN1bGF0ZUFwcGxpY2FibGVVbml0UGVyaW9kcygpO1xuICB9XG5cbiAgc2V0QWN0aXZlUGVyaW9kU3RhcnQgKHN0YXJ0KSB7XG4gICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gc3RhcnQ7XG4gICAgdGhpcy5jYWxjdWxhdGVBcHBsaWNhYmxlVW5pdFBlcmlvZHMoKTtcbiAgfVxuXG4gIHNldEFjdGl2ZVBlcmlvZEVuZCAoZW5kKSB7XG4gICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ICsgZW5kO1xuICAgIHRoaXMuY2FsY3VsYXRlQXBwbGljYWJsZVVuaXRQZXJpb2RzKCk7XG4gIH1cblxuICBkcmF3QnV0dG9ucyAoc3RhbmRhcmRQZXJpb2RzKSB7XG4gICAgdmFyIGNhbGN1bGF0ZWRCdXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbGN1bGF0ZWQnKTtcbiAgICB2YXIgYnRuO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgaiA9IDA7XG4gICAgdmFyIG11bHRpcGxpZXJWYWx1ZSA9IDA7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGNhbGN1bGF0ZWRCdXR0b25zLmlubmVySFRNTCA9ICcnO1xuICAgIGZvciAoaSA9IHN0YW5kYXJkUGVyaW9kcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgZm9yIChqID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpO1xuICAgICAgICBidG4uaWQgPSBzdGFuZGFyZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzdGFuZGFyZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgbXVsdGlwbGllclZhbHVlID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc3RhbmRhcmRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcztcbiAgICAgICAgYnRuLm11bHRpcGxpZXJWYWx1ZSA9IG11bHRpcGxpZXJWYWx1ZTtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5lbmRBY3RpdmVXaW5kb3cgLSBldmVudC5zcmNFbGVtZW50Lm11bHRpcGxpZXJWYWx1ZSwgc2VsZi5lbmRBY3RpdmVXaW5kb3cpO1xuICAgICAgICB9KTtcbiAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnRuKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zdGFuZGFyZFBlcmlvZHMgPSBbXTtcbiAgfVxuXG4gIHNldENoYXJ0UmFuZ2VPYkJ1dHRvbkNsaWNrICgpIHt9XG5cbiAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIGluaXQgKHJlcXVpcmUpIHtcbiAgICByZXF1aXJlKCdYLUF4aXMnLCAnWS1BeGlzJywgJ2dyYXBoaWNzJywgJ2NoYXJ0JywgJ2V4dGVuc2lvbkRhdGEnLCAnZGF0ZUZvcm1hdHRlcicsXG4gICAgICBmdW5jdGlvbiAoeCwgeSwgZ3JhcGhpY3MsIGNoYXJ0LCBleHREYXRhLCBkYXRlRm9ybWF0dGVyKSB7XG5cbiAgICAgIH0pO1xuICB9XG5cbiAgcGxhY2VJbkNhbnZhcyAoKSB7fVxuXG4gIGRyYXcgKCkge1xuICAgIC8vIGRyYXdpbmcgb2YgdGhlIHN0YW5kYXJkIHRpbWUgcGVyaW9kcyBoYXBwZW5zIGhlcmVcbiAgfVxuXG4gIGRpc3Bvc2UgKCkge31cbn1cblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yO1xufSBlbHNlIHtcbiAgd2luZG93LlN0YW5kYXJkUGVyaW9kID0gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXX0=
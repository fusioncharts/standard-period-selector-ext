/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(1);


/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	const StandardPeriodSelector = __webpack_require__(2);
	
	window.stPS = new StandardPeriodSelector();
	
	;(function (env, factory) {
	  if (typeof module === 'object' && module.exports) {
	    module.exports = env.document
	       ? factory(env) : function (win) {
	         if (!win.document) {
	           throw new Error('Window with document not present');
	         }
	         return factory(win, true);
	       };
	  } else {
	    env.StandardPeriodSelector = factory(env, true);
	  }
	})(typeof window !== 'undefined' ? window : this, function (_window, windowExists) {
	  var FC = _window.FusionCharts;
	  FC.register('extension', ['private', 'StandardPeriodSelector', function () {
	    FC.registerComponent('extensions', 'StandardPeriodSelector', StandardPeriodSelector({FusionCharts: FC}));
	  }]);
	});


/***/ },
/* 2 */
/***/ function(module, exports) {

	'use strict';
	
	/**
	 * Class definition of StandardPeriodSelector
	 */
	
	module.exports = function (dep) {
	  class StandardPeriodSelector {
	    constructor () {
	      /**
	       * @private
	       */
	      this.ratio = 8;
	      this.toolbox = FusionCharts.getComponent('api', 'toolbox');
	      this.HorizontalToolbar = this.toolbox.HorizontalToolbar;
	      this.ComponentGroup = this.toolbox.ComponentGroup;
	      this.SymbolStore = this.toolbox.SymbolStore;
	      this.all = 1;
	      this.calculatedPeriods = [];
	      this.startDataset = 0;
	      // this.endDataset = this.globalReactiveModel.model['x-axis-absolute-range-end'];
	      this.startActiveWindow = 0;
	      this.endActiveWindow = 1;
	      this.standardCalculatedPeriods = [];
	      this.standardContexualPeriods = [];
	      this.startPointUnit = 0;
	      this.startPointMultiplier = 0;
	      this.clickedId = 'ALL';
	      this.noCalcButtons = 0;
	      this.timePeriods = [{
	        'name': 'second',
	        'milliseconds': 1000,
	        'startingPoint': 0,
	        'total': 60,
	        'abbreviation': 's',
	        'description': 'SECOND',
	        'parent': 'minute',
	        'multipliers': [1, 5, 15, 30]
	      }, {
	        'name': 'minute',
	        'milliseconds': 60000,
	        'startingPoint': 0,
	        'total': 60,
	        'abbreviation': 'm',
	        'description': 'MINUTE',
	        'parent': 'hour',
	        'multipliers': [1, 5, 15, 30]
	      }, {
	        'name': 'hour',
	        'milliseconds': 3600000,
	        'startingPoint': 0,
	        'total': 24,
	        'abbreviation': 'h',
	        'description': 'HOUR',
	        'parent': 'day',
	        'multipliers': [1, 3, 6, 12]
	      }, {
	        'name': 'day',
	        'milliseconds': 86400000,
	        'startingPoint': 0,
	        'total': 30,
	        'abbreviation': 'D',
	        'description': 'DAY',
	        'parent': 'month',
	        'multipliers': [1, 7, 15]
	      }, {
	        'name': 'month',
	        'milliseconds': 2592000000,
	        'startingPoint': 0,
	        'total': 12,
	        'abbreviation': 'M',
	        'description': 'MONTH',
	        'parent': 'year',
	        'multipliers': [1, 3, 6]
	      }, {
	        'name': 'year',
	        'milliseconds': 31104000000,
	        'startingPoint': 0,
	        'abbreviation': 'Y',
	        'description': 'YEAR',
	        'multipliers': [1]
	      }];
	      this.tdButtons = [
	        {
	          'name': 'YTD',
	          'abbreviation': 'YTD',
	          'parent': 'year',
	          'milliseconds': 31104000000,
	          'description': 'Year to Date'
	        },
	        {
	          'name': 'QTD',
	          'abbreviation': 'QTD',
	          'parent': 'month',
	          'multiplier': 3,
	          'milliseconds': 7776000000,
	          'description': 'Quarter to Date'
	        },
	        {
	          'name': 'MTD',
	          'abbreviation': 'MTD',
	          'parent': 'month',
	          'milliseconds': 2592000000,
	          'description': 'Month to Date'
	        },
	        {
	          'name': 'WTD',
	          'abbreviation': 'WTD',
	          'parent': 'day',
	          'multiplier': 7,
	          'milliseconds': 604800000,
	          'description': 'Week to Date'
	        },
	        {
	          'name': 'Y',
	          'abbreviation': 'Y',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Yesterday'
	        },
	        {
	          'name': 'T',
	          'abbreviation': 'T',
	          'parent': 'day',
	          'milliseconds': 86400000,
	          'description': 'Today'
	        }
	      ];
	      this.config = {
	        anchorPositions: 'right',
	        all: '1',
	        contextual: '1',
	        calculated: '1',
	        tertiaryTimePeriods: {}
	      };
	    }
	
	    /**
	     * A function to generate the calculated buttons using
	     * the active range and the location of the active range
	     */
	    generateCalculatedButtons () {
	      var targetBlock = this.endActiveWindow - this.startDataset,
	        i = 0,
	        j = 0,
	        activeWindow = this.endActiveWindow - this.startActiveWindow,
	        count = 0;
	      this.standardCalculatedPeriods = [];
	      for (i = 0; i < this.timePeriods.length; i++) {
	        // checking whether the unit is applicable for the current target block
	        if (targetBlock / this.timePeriods[i].milliseconds >= 1) {
	          // checking whether the unit is of the higher order and only multiplier 1 is applicable
	          if (Math.floor((activeWindow) / this.timePeriods[i].milliseconds) < 1) {
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].milliseconds,
	              'name': this.timePeriods[i].name,
	              'multipliers': [1]
	            });
	          } else { // if the unit is of the order of the target block and calculating the multipliers
	            this.standardCalculatedPeriods.push({
	              'abbreviation': this.timePeriods[i].abbreviation,
	              'description': this.timePeriods[i].description,
	              'milliseconds': this.timePeriods[i].milliseconds,
	              'name': this.timePeriods[i].name,
	              'multipliers': []
	            });
	            // calculating and populating the applicable multpliers of each unit
	            for (j = 0; j < this.timePeriods[i].multipliers.length; j++) {
	              if (activeWindow / this.ratio < this.timePeriods[i].multipliers[j] * this.timePeriods[i].milliseconds) {
	                this.standardCalculatedPeriods[this.standardCalculatedPeriods.length - 1].multipliers.push(
	                  this.timePeriods[i].multipliers[j]
	                  );
	              }
	            }
	          }
	        }
	      }
	      this.noCalcButtons = Infinity;
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = 0; j < this.standardCalculatedPeriods[i].multipliers.length; j++) {
	          ++count;
	          if (this.noCalcButtons > i) {
	            this.noCalcButtons = i;
	          }
	          if (count <= 4) {
	            this.startPointMultiplier = j;
	            this.startPointUnit = i;
	          }
	        }
	      }
	
	      // this.drawButtonsCalculated(this.standardCalculatedPeriods);
	    }
	
	    /**
	     * A function to generate the contextual buttons using
	     * the end point of the time-scale
	     */
	    generateContextualButtons () {
	      // generating an array with applicable TD buttons
	      var buttons = [],
	        i = 0,
	        endStamp = this.globalReactiveModel.model['x-axis-absolute-range-end'],
	        dateStart = endStamp - 2,
	        dateEnd = endStamp,
	        relativeTDButton = {};
	      for (; i < this.tdButtons.length; i++) {
	        dateStart = new Date(endStamp);
	        if (this.tdButtons[i].name === 'YTD') {
	          dateStart.setMonth(0);
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'MTD') {
	          dateStart.setDate(1);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'QTD') {
	          dateStart.setMonth(11 - (dateStart.getMonth() % 4));
	          dateStart.setDate(0);
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'WTD') {
	          dateStart.setDate(dateStart.getDate() - dateStart.getDay());
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        } else if (this.tdButtons[i].name === 'Y') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	          dateStart -= 86400000;
	        } else if (this.tdButtons[i].name === 'T') {
	          dateStart.setHours(0);
	          dateStart.setMinutes(0);
	          dateStart.setSeconds(0);
	        }
	
	        if (dateEnd < dateStart) {
	          continue;
	        } else {
	          this.tdButtons[i].dateStart = dateStart.valueOf();
	          this.tdButtons[i].dateEnd = dateEnd.valueOf();
	          buttons.push(this.tdButtons[i]);
	        }
	      }
	      relativeTDButton.milliseconds = Infinity;
	      for (i = 0; i < this.tdButtons.length; i++) {
	        if (Math.abs(this.tdButtons[i].milliseconds - (this.endActiveWindow - this.startActiveWindow)) < relativeTDButton.milliseconds) {
	          relativeTDButton.milliseconds = this.tdButtons[i].milliseconds;
	          relativeTDButton.name = this.tdButtons[i].abbreviation;
	        }
	      }
	
	      this.standardContexualPeriods = buttons;
	      // this.drawButtonsContextual(this.standardContexualPeriods);
	    }
	
	    /**
	     * A function to set the active period's
	     * start and end point
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of active period
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of active period
	     */
	    setActivePeriod () {
	      var start,
	        end;
	      if (arguments.length === 1) {
	        end = this.globalReactiveModel.model['x-axis-visible-range-end'];
	        start = end - arguments[0];
	      } else if (arguments.length === 2) {
	        start = arguments[0];
	        end = arguments[1];
	      }
	
	      this.startActiveWindow = start;
	      this.endActiveWindow = end;
	      this.generateCalculatedButtons();
	      this.globalReactiveModel.model['x-axis-visible-range-start'] = this.startActiveWindow;
	      this.globalReactiveModel.model['x-axis-visible-range-end'] = this.endActiveWindow;
	      this.generateContextualButtons();
	    }
	
	    /**
	     * A function to set the start and end point of the
	     * entire time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the start point of time-line
	     * @param  {number} date stamp - A UNIX timestamp to be set as the end point of time-line
	     */
	    setTimeline (start, end) {
	      this.startDataset = start;
	      this.endDataset = end;
	      document.getElementById('startActiveRange').innerHTML = new Date(this.startDataset);
	      document.getElementById('endActiveRange').innerHTML = new Date(this.endDataset);
	      this.generateCalculatedButtons();
	    }
	
	    /**
	     * A function to set the object to set the user preferences
	     */
	    configure (config) {
	      this.config = config;
	    }
	
	    /**
	     * Fusioncharts life cycle method for extension
	     */
	    init (require) {
	      var instance = this;
	      require([
	        'xAxis',
	        'yAxis',
	        'graphics',
	        'chart',
	        'dataset',
	        'PlotManager',
	        'canvasConfig',
	        'MarkerManager',
	        'reactiveModel',
	        'globalReactiveModel',
	        'spaceManagerInstance',
	        'smartLabel',
	        'extData',
	        'chartInstance',
	        function (
	              xAxis,
	              yAxis,
	              graphics,
	              chart,
	              dataset,
	              plotManager,
	              canvasConfig,
	              markerManager,
	              reactiveModel,
	              globalReactiveModel,
	              spaceManagerInstance,
	              smartLabel,
	              extData,
	              chartInstance) {
	          instance.xAxis = xAxis;
	          instance.yAxis = yAxis;
	          instance.graphics = graphics;
	          instance.chart = chart;
	          instance.dataset = dataset;
	          instance.plotManager = plotManager;
	          instance.markerManager = markerManager;
	          instance.canvasConfig = canvasConfig;
	          instance.reactiveModel = reactiveModel;
	          instance.globalReactiveModel = globalReactiveModel;
	          instance.spaceManagerInstance = spaceManagerInstance;
	          instance.smartLabel = smartLabel;
	          instance.extData = extData;
	          instance.chartInstance = chartInstance;
	        }
	      ]);
	      this.spaceManagerInstance = instance.spaceManagerInstance;
	      this.globalReactiveModel = instance.globalReactiveModel;
	      this.endActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-end'];
	      this.startActiveWindow = instance.globalReactiveModel.model['x-axis-visible-range-start'];
	      this.startDataset = instance.globalReactiveModel.model['x-axis-absolute-range-start'];
	      this.endDataset = instance.globalReactiveModel.model['x-axis-absolute-range-end'];
	      this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	      // instance.globalReactiveModel.model['_x-axis-visible-range-start'] += 124416000000;
	      this.setActivePeriod(this.startActiveWindow, this.endActiveWindow);
	      this.timeRules = this.chartInstance.apiInstance.getComponentStore();
	      this.timeRules = this.timeRules.getCanvasByIndex(0).composition.impl;
	      this.timeRules = this.timeRules.getDataAggregator();
	      this.timeRules = this.timeRules.getAggregationTimeRules();
	      this.toolbars = [];
	      this.measurement = {};
	
	      this.toolbars.push(this.createToolbar());
	      return this;
	    };
	
	    createToolbar () {
	      var unigroup,
	        toolbar,
	        calculatedButtons,
	        contextualButtons,
	        allButton,
	        self = this,
	        endActive = this.globalReactiveModel.model['x-axis-visible-range-end'],
	        deductorAr = [],
	        startMultiplier,
	        deductor,
	        i,
	        j,
	        margin,
	        fromDateLabel,
	        group;
	
	      group = new this.toolbox.ComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	
	      unigroup = new this.toolbox.UniSelectComponentGroup({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      unigroup.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      group.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      toolbar = new this.HorizontalToolbar({
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      });
	      toolbar.setConfig({
	        fill: '#fff',
	        borderThickness: 0
	      });
	      fromDateLabel = new this.toolbox.Label('Zoom:', {
	        smartLabel: this.smartLabel,
	        paper: this.graphics.paper
	      }, {
	        text: {
	          style: {
	            'font-family': '"Lucida Grande", sans-serif',
	            'font-size': '13',
	            'fill': '#696969'
	          }
	        },
	        container: {
	          height: 22
	        }
	      });
	      group.addSymbol(fromDateLabel);
	      allButton = new this.toolbox.Symbol('ALL', true, {
	        paper: this.graphics.paper,
	        chart: this.chart,
	        smartLabel: this.smartLabel,
	        chartContainer: this.graphics.container
	      }, {
	        fill: '#ffffff',
	        labelFill: '#696969',
	        symbolStrokeWidth: '2',
	        stroke: '#ced5d4',
	        strokeWidth: '1',
	        hoverFill: '#ced5d4',
	        height: 22,
	        radius: 1,
	        margin: {
	          right: 5
	        },
	        btnTextStyle: {
	          'fontFamily': '"Lucida Grande", sans-serif',
	          'fontSize': '13',
	          'fill': '#696969',
	          'line-height': '1',
	          'letter-spacing': '-0.04em'
	        }
	      }).attachEventHandlers({
	        click: function () {
	          self.setActivePeriod(self.startDataset, self.endDataset);
	          toolbar.dispose();
	          self.clickedId = 'ALL';
	          self.toolbars.pop();
	          self.toolbars.push(self.createToolbar());
	          self.getLogicalSpace();
	          self.draw();
	          // self._ref.reAllocate(self.parentGroup);
	        },
	        tooltext: 'ALL'
	      });
	
	      unigroup.addSymbol(allButton);
	      for (i = 0; i < this.standardCalculatedPeriods.length; i++) {
	        for (j = this.standardCalculatedPeriods[i].multipliers.length - 1; j >= 0; j--) {
	          deductorAr.push(self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	        }
	      }
	
	      calculatedButtons = [];
	      for (let i = self.startPointUnit; i >= 0; i--) {
	        if (i === self.startPointUnit) {
	          startMultiplier = self.startPointMultiplier;
	        } else {
	          startMultiplier = self.standardCalculatedPeriods[i].multipliers.length - 1;
	        }
	        for (let j = startMultiplier; j >= 0; j--) {
	          margin = (i === self.noCalcButtons && j === 0) ? 5 : 0;
	          calculatedButtons[i] = new this.toolbox.Symbol(self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation, true, {
	            paper: this.graphics.paper,
	            chart: this.chart,
	            smartLabel: this.smartLabel,
	            chartContainer: this.graphics.container
	          }, {
	            fill: '#ffffff',
	            labelFill: '#696969',
	            symbolStrokeWidth: '2',
	            stroke: '#ced5d4',
	            strokeWidth: '1',
	            hoverFill: '#ced5d4',
	            height: 22,
	            radius: 1,
	            margin: {
	              right: margin
	            },
	            btnTextStyle: {
	              'fontFamily': '"Lucida Grande", sans-serif',
	              'fontSize': '13',
	              'fill': '#696969',
	              'line-height': '1',
	              'letter-spacing': '-0.04em'
	            }
	          }).attachEventHandlers({
	            'click': function () {
	              deductor = (self.standardCalculatedPeriods[i].multipliers[j] * self.standardCalculatedPeriods[i].milliseconds);
	              self.clickedId = self.standardCalculatedPeriods[i].multipliers[j] + self.standardCalculatedPeriods[i].abbreviation;
	              self.setActivePeriod(deductor);
	              toolbar.dispose();
	              self.toolbars.pop();
	              self.toolbars.push(self.createToolbar());
	              self.getLogicalSpace();
	              self.draw();
	              // self._ref.reAllocate(self.parentGroup);
	              // this.toolbars[this.toolbars.length - 1] = this.createToolbar();
	            },
	            tooltext: self.standardCalculatedPeriods[i].multipliers[j] + ' ' + self.standardCalculatedPeriods[i].description
	          });
	          unigroup.addSymbol(calculatedButtons[i]);
	        }
	      }
	
	      contextualButtons = [];
	
	      for (let i = 0; i < this.standardContexualPeriods.length; i++) {
	        contextualButtons[i] = new this.toolbox.Symbol(this.standardContexualPeriods[i].abbreviation, true, {
	          paper: this.graphics.paper,
	          chart: this.chart,
	          smartLabel: this.smartLabel,
	          chartContainer: this.graphics.container
	        }, {
	          fill: '#ffffff',
	          labelFill: '#696969',
	          symbolStrokeWidth: '2',
	          stroke: '#ced5d4',
	          strokeWidth: '1',
	          height: 22,
	          hoverFill: '#ced5d4',
	          radius: 1,
	          margin: {
	            right: 0
	          },
	          btnTextStyle: {
	            'fontFamily': '"Lucida Grande", sans-serif',
	            'fontSize': '13',
	            'fill': '#696969',
	            'line-height': '1',
	            'letter-spacing': '-0.04em'
	          }
	        }).attachEventHandlers({
	          'click': function () {
	            self.setActivePeriod(self.standardContexualPeriods[i].dateStart, self.standardContexualPeriods[i].dateEnd);
	            self.clickedId = self.standardContexualPeriods[i].abbreviation;
	            toolbar.dispose();
	            self.toolbars.pop();
	            self.toolbars.push(self.createToolbar());
	            self.getLogicalSpace();
	            self.draw();
	            // self._ref.reAllocate(self.parentGroup);
	          },
	          tooltext: this.standardContexualPeriods[i].description
	        });
	        unigroup.addSymbol(contextualButtons[i]);
	      }
	
	        // btn = document.createElement('BUTTON');
	        // btn.id = standardPeriods[i].abbreviation;
	        // btn.innerHTML = standardPeriods[i].abbreviation;
	        // btn.addEventListener('click', eventBtn.bind(this, standardPeriods[i]));
	        // contextualButtons.appendChild(btn);
	
	      this.SymbolStore.register('textBoxIcon', function (x, y, rad, w, h, padX, padY) {
	        var x1 = x - w / 2 + padX / 2,
	          x2 = x + w / 2 - padX / 2,
	          y1 = y - h / 2 + padY / 2,
	          y2 = y + h / 2 - padY / 2;
	
	        return ['M', x1, y1, 'L', x2, y1, 'L', x2, y2, 'L', x1, y2, 'Z'];
	      });
	
	      toolbar.addComponent(group);
	      toolbar.addComponent(unigroup);
	      return toolbar;
	    };
	
	    getLogicalSpace (availableWidth = this._pWidth, availableHeight = this._pHeight) {
	      // availableWidth /= 2;
	      var logicalSpace,
	        width = 420, // width hardcoded; TODO: make it dynamic
	        height = 0,
	        i,
	        ln;
	
	      for (i = 0, ln = this.toolbars.length; i < ln; i++) {
	        logicalSpace = this.toolbars[i].getLogicalSpace(availableWidth, availableHeight);
	        // width = Math.max(logicalSpace.width, width);
	        height += logicalSpace.height;
	        this.toolbars[i].width = logicalSpace.width;
	        this.toolbars[i].height = logicalSpace.height;
	      }
	      height += this.padding;
	      return {
	        width: width,
	        height: height
	      };
	    };
	
	    getDefaultGroup () {
	      return this.parentGroup;
	    }
	
	    placeInCanvas () {
	      var self = this;
	      self.padding = 5;
	      self.spaceManagerInstance.add([{
	        name: function () {
	          return 'standard-period-selector-ext';
	        },
	        ref: function (obj) {
	          return obj['0'];
	        },
	        self: function () {
	          return self;
	        },
	        priority: function () {
	          return 2;
	        },
	        layout: function (obj) {
	          return obj.inline;
	        },
	        orientation: [{
	          type: function (obj) {
	            return obj.horizontal;
	          },
	          position: [{
	            type: function (obj) {
	              return obj.top;
	            },
	            alignment: [{
	              type: function (obj) {
	                return obj.left;
	              },
	              dimensions: [function () {
	                var parent = this.getParentComponentGroup();
	                self._ref = this;
	                return self.getLogicalSpace((self._pWidth = parent.getWidth()), (self._pHeight = parent.getHeight()));
	              }]
	            }]
	          }]
	        }]
	      }]);
	    };
	
	    setDrawingConfiguration (x, y, width, height, group) {
	      var mes = this.measurement;
	      mes.x = x;
	      mes.y = y;
	      mes.width = width;
	      mes.height = height;
	
	      this.parentGroup = group;
	
	      return this;
	    };
	
	    draw (x, y, width, height, group) {
	      var measurement = this.measurement,
	        toolbars = this.toolbars,
	        ln,
	        i,
	        toolbar,
	        boundElement,
	        bBox,
	        x1,
	        x2,
	        y2,
	        selectLine;
	
	      selectLine = this.saveSelectLine || this.graphics.paper.path({
	        'stroke': '#c95a5a',
	        'stroke-width': '2px'
	      }).toFront();
	      x = x === undefined ? measurement.x : x;
	      y = y === undefined ? measurement.y : y;
	      width = width === undefined ? measurement.width : width;
	      height = height === undefined ? measurement.height : height;
	      group = group === undefined ? this.parentGroup : group;
	      if (width && height) {
	        for (i = 0, ln = toolbars.length; i < ln; i++) {
	          toolbar = toolbars[i];
	          toolbar.draw(x, y, group);
	        }
	      }
	      this.saveSelectLine = selectLine;
	
	      for (let i = 0, ii = toolbars[0].componentGroups[1].symbolList; i < ii.length; i++) {
	        if (ii[i].symbol === this.clickedId) {
	          boundElement = ii[i].getBoundElement();
	          bBox = boundElement.getBBox();
	          x1 = bBox.x;
	          x2 = bBox.x2;
	          y2 = bBox.y2;
	
	          selectLine.attr({
	            path: ['M', x1 - 0.5, y2 - 0.5, 'L', x2 + 0.5, y2 - 0.5]
	          });
	        }
	      }
	    };
	  }
	  return StandardPeriodSelector;
	};


/***/ }
/******/ ]);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMjgwYzhjNGFlMjNjNDM4MWU5YTciLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDdENBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsMEZBQXlGLGlCQUFpQjtBQUMxRyxJQUFHO0FBQ0gsRUFBQzs7Ozs7OztBQ3RCRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FB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cUUsZUFBZTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAyODBjOGM0YWUyM2M0MzgxZTlhNyIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSByZXF1aXJlKCcuL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3RvcicpO1xuXG53aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG5cbjsoZnVuY3Rpb24gKGVudiwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGVudi5kb2N1bWVudFxuICAgICAgID8gZmFjdG9yeShlbnYpIDogZnVuY3Rpb24gKHdpbikge1xuICAgICAgICAgaWYgKCF3aW4uZG9jdW1lbnQpIHtcbiAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaW5kb3cgd2l0aCBkb2N1bWVudCBub3QgcHJlc2VudCcpO1xuICAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIGZhY3Rvcnkod2luLCB0cnVlKTtcbiAgICAgICB9O1xuICB9IGVsc2Uge1xuICAgIGVudi5TdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gZmFjdG9yeShlbnYsIHRydWUpO1xuICB9XG59KSh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uIChfd2luZG93LCB3aW5kb3dFeGlzdHMpIHtcbiAgdmFyIEZDID0gX3dpbmRvdy5GdXNpb25DaGFydHM7XG4gIEZDLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3ByaXZhdGUnLCAnU3RhbmRhcmRQZXJpb2RTZWxlY3RvcicsIGZ1bmN0aW9uICgpIHtcbiAgICBGQy5yZWdpc3RlckNvbXBvbmVudCgnZXh0ZW5zaW9ucycsICdTdGFuZGFyZFBlcmlvZFNlbGVjdG9yJywgU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcih7RnVzaW9uQ2hhcnRzOiBGQ30pKTtcbiAgfV0pO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ2xhc3MgZGVmaW5pdGlvbiBvZiBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZGVwKSB7XG4gIGNsYXNzIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Ige1xuICAgIGNvbnN0cnVjdG9yICgpIHtcbiAgICAgIC8qKlxuICAgICAgICogQHByaXZhdGVcbiAgICAgICAqL1xuICAgICAgdGhpcy5yYXRpbyA9IDg7XG4gICAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuICAgICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcbiAgICAgIHRoaXMuQ29tcG9uZW50R3JvdXAgPSB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXA7XG4gICAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuICAgICAgdGhpcy5hbGwgPSAxO1xuICAgICAgdGhpcy5jYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSAwO1xuICAgICAgLy8gdGhpcy5lbmREYXRhc2V0ID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG4gICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gMDtcbiAgICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gMTtcbiAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuICAgICAgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMgPSBbXTtcbiAgICAgIHRoaXMuc3RhcnRQb2ludFVuaXQgPSAwO1xuICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IDA7XG4gICAgICB0aGlzLmNsaWNrZWRJZCA9ICdBTEwnO1xuICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gMDtcbiAgICAgIHRoaXMudGltZVBlcmlvZHMgPSBbe1xuICAgICAgICAnbmFtZSc6ICdzZWNvbmQnLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogMTAwMCxcbiAgICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgICAndG90YWwnOiA2MCxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdzJyxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1NFQ09ORCcsXG4gICAgICAgICdwYXJlbnQnOiAnbWludXRlJyxcbiAgICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDUsIDE1LCAzMF1cbiAgICAgIH0sIHtcbiAgICAgICAgJ25hbWUnOiAnbWludXRlJyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDYwMDAwLFxuICAgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAgICd0b3RhbCc6IDYwLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ20nLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnTUlOVVRFJyxcbiAgICAgICAgJ3BhcmVudCc6ICdob3VyJyxcbiAgICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDUsIDE1LCAzMF1cbiAgICAgIH0sIHtcbiAgICAgICAgJ25hbWUnOiAnaG91cicsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiAzNjAwMDAwLFxuICAgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAgICd0b3RhbCc6IDI0LFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ2gnLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnSE9VUicsXG4gICAgICAgICdwYXJlbnQnOiAnZGF5JyxcbiAgICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxuICAgICAgfSwge1xuICAgICAgICAnbmFtZSc6ICdkYXknLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICAgJ3RvdGFsJzogMzAsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnRCcsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdEQVknLFxuICAgICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDcsIDE1XVxuICAgICAgfSwge1xuICAgICAgICAnbmFtZSc6ICdtb250aCcsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuICAgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAgICd0b3RhbCc6IDEyLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ00nLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnTU9OVEgnLFxuICAgICAgICAncGFyZW50JzogJ3llYXInLFxuICAgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNl1cbiAgICAgIH0sIHtcbiAgICAgICAgJ25hbWUnOiAneWVhcicsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiAzMTEwNDAwMDAwMCxcbiAgICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnWUVBUicsXG4gICAgICAgICdtdWx0aXBsaWVycyc6IFsxXVxuICAgICAgfV07XG4gICAgICB0aGlzLnRkQnV0dG9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1lURCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdZVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAneWVhcicsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdZZWFyIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdRVEQnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnUVREJyxcbiAgICAgICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICAgICAnbXVsdGlwbGllcic6IDMsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDc3NzYwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1F1YXJ0ZXIgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ01URCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdNVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdNb250aCB0byBEYXRlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnV1REJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1dURCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtdWx0aXBsaWVyJzogNyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogNjA0ODAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdXZWVrIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdZJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuICAgICAgICAgICdwYXJlbnQnOiAnZGF5JyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llc3RlcmRheSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1QnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnVCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnVG9kYXknXG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgICAgYW5jaG9yUG9zaXRpb25zOiAncmlnaHQnLFxuICAgICAgICBhbGw6ICcxJyxcbiAgICAgICAgY29udGV4dHVhbDogJzEnLFxuICAgICAgICBjYWxjdWxhdGVkOiAnMScsXG4gICAgICAgIHRlcnRpYXJ5VGltZVBlcmlvZHM6IHt9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNhbGN1bGF0ZWQgYnV0dG9ucyB1c2luZ1xuICAgICAqIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgYWN0aXZlIHJhbmdlXG4gICAgICovXG4gICAgZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucyAoKSB7XG4gICAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuICAgICAgICBpID0gMCxcbiAgICAgICAgaiA9IDAsXG4gICAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyxcbiAgICAgICAgY291bnQgPSAwO1xuICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50aW1lUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIGFwcGxpY2FibGUgZm9yIHRoZSBjdXJyZW50IHRhcmdldCBibG9ja1xuICAgICAgICBpZiAodGFyZ2V0QmxvY2sgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyA+PSAxKSB7XG4gICAgICAgICAgLy8gY2hlY2tpbmcgd2hldGhlciB0aGUgdW5pdCBpcyBvZiB0aGUgaGlnaGVyIG9yZGVyIGFuZCBvbmx5IG11bHRpcGxpZXIgMSBpcyBhcHBsaWNhYmxlXG4gICAgICAgICAgaWYgKE1hdGguZmxvb3IoKGFjdGl2ZVdpbmRvdykgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcykgPCAxKSB7XG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbixcbiAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogWzFdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgeyAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbixcbiAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyB0aGlzLnJhdGlvIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW3RoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGggLSAxXS5tdWx0aXBsaWVycy5wdXNoKFxuICAgICAgICAgICAgICAgICAgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gSW5maW5pdHk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICArK2NvdW50O1xuICAgICAgICAgIGlmICh0aGlzLm5vQ2FsY0J1dHRvbnMgPiBpKSB7XG4gICAgICAgICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY291bnQgPD0gNCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IGo7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gaTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjb250ZXh0dWFsIGJ1dHRvbnMgdXNpbmdcbiAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG4gICAgICovXG4gICAgZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucyAoKSB7XG4gICAgICAvLyBnZW5lcmF0aW5nIGFuIGFycmF5IHdpdGggYXBwbGljYWJsZSBURCBidXR0b25zXG4gICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgZW5kU3RhbXAgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXSxcbiAgICAgICAgZGF0ZVN0YXJ0ID0gZW5kU3RhbXAgLSAyLFxuICAgICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG4gICAgICAgIHJlbGF0aXZlVERCdXR0b24gPSB7fTtcbiAgICAgIGZvciAoOyBpIDwgdGhpcy50ZEJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoZW5kU3RhbXApO1xuICAgICAgICBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1lURCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdRVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDExIC0gKGRhdGVTdGFydC5nZXRNb250aCgpICUgNCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKGRhdGVTdGFydC5nZXREYXRlKCkgLSBkYXRlU3RhcnQuZ2V0RGF5KCkpO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnWScpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdUJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRlRW5kIDwgZGF0ZVN0YXJ0KSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50ZEJ1dHRvbnNbaV0uZGF0ZVN0YXJ0ID0gZGF0ZVN0YXJ0LnZhbHVlT2YoKTtcbiAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG4gICAgICAgICAgYnV0dG9ucy5wdXNoKHRoaXMudGRCdXR0b25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMgPSBJbmZpbml0eTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzIC0gKHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdykpIDwgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMpIHtcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IHRoaXMudGRCdXR0b25zW2ldLm1pbGxpc2Vjb25kcztcbiAgICAgICAgICByZWxhdGl2ZVREQnV0dG9uLm5hbWUgPSB0aGlzLnRkQnV0dG9uc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMgPSBidXR0b25zO1xuICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NvbnRleHR1YWwodGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBhY3RpdmUgcGVyaW9kJ3NcbiAgICAgKiBzdGFydCBhbmQgZW5kIHBvaW50XG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIHN0YXJ0IHBvaW50IG9mIGFjdGl2ZSBwZXJpb2RcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIGFjdGl2ZSBwZXJpb2RcbiAgICAgKi9cbiAgICBzZXRBY3RpdmVQZXJpb2QgKCkge1xuICAgICAgdmFyIHN0YXJ0LFxuICAgICAgICBlbmQ7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBlbmQgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuICAgICAgICBzdGFydCA9IGVuZCAtIGFyZ3VtZW50c1swXTtcbiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBzdGFydCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgZW5kID0gYXJndW1lbnRzWzFdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGVuZDtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddID0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgICAqIGVudGlyZSB0aW1lLWxpbmVcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgdGltZS1saW5lXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICAgKi9cbiAgICBzZXRUaW1lbGluZSAoc3RhcnQsIGVuZCkge1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBzdGFydDtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGVuZDtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5zdGFydERhdGFzZXQpO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmREYXRhc2V0KTtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBvYmplY3QgdG8gc2V0IHRoZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICovXG4gICAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAgICovXG4gICAgaW5pdCAocmVxdWlyZSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHJlcXVpcmUoW1xuICAgICAgICAneEF4aXMnLFxuICAgICAgICAneUF4aXMnLFxuICAgICAgICAnZ3JhcGhpY3MnLFxuICAgICAgICAnY2hhcnQnLFxuICAgICAgICAnZGF0YXNldCcsXG4gICAgICAgICdQbG90TWFuYWdlcicsXG4gICAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAgICdyZWFjdGl2ZU1vZGVsJyxcbiAgICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgICAnc21hcnRMYWJlbCcsXG4gICAgICAgICdleHREYXRhJyxcbiAgICAgICAgJ2NoYXJ0SW5zdGFuY2UnLFxuICAgICAgICBmdW5jdGlvbiAoXG4gICAgICAgICAgICAgIHhBeGlzLFxuICAgICAgICAgICAgICB5QXhpcyxcbiAgICAgICAgICAgICAgZ3JhcGhpY3MsXG4gICAgICAgICAgICAgIGNoYXJ0LFxuICAgICAgICAgICAgICBkYXRhc2V0LFxuICAgICAgICAgICAgICBwbG90TWFuYWdlcixcbiAgICAgICAgICAgICAgY2FudmFzQ29uZmlnLFxuICAgICAgICAgICAgICBtYXJrZXJNYW5hZ2VyLFxuICAgICAgICAgICAgICByZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBnbG9iYWxSZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBzcGFjZU1hbmFnZXJJbnN0YW5jZSxcbiAgICAgICAgICAgICAgc21hcnRMYWJlbCxcbiAgICAgICAgICAgICAgZXh0RGF0YSxcbiAgICAgICAgICAgICAgY2hhcnRJbnN0YW5jZSkge1xuICAgICAgICAgIGluc3RhbmNlLnhBeGlzID0geEF4aXM7XG4gICAgICAgICAgaW5zdGFuY2UueUF4aXMgPSB5QXhpcztcbiAgICAgICAgICBpbnN0YW5jZS5ncmFwaGljcyA9IGdyYXBoaWNzO1xuICAgICAgICAgIGluc3RhbmNlLmNoYXJ0ID0gY2hhcnQ7XG4gICAgICAgICAgaW5zdGFuY2UuZGF0YXNldCA9IGRhdGFzZXQ7XG4gICAgICAgICAgaW5zdGFuY2UucGxvdE1hbmFnZXIgPSBwbG90TWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5tYXJrZXJNYW5hZ2VyID0gbWFya2VyTWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5jYW52YXNDb25maWcgPSBjYW52YXNDb25maWc7XG4gICAgICAgICAgaW5zdGFuY2UucmVhY3RpdmVNb2RlbCA9IHJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBzcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgICAgICBpbnN0YW5jZS5zbWFydExhYmVsID0gc21hcnRMYWJlbDtcbiAgICAgICAgICBpbnN0YW5jZS5leHREYXRhID0gZXh0RGF0YTtcbiAgICAgICAgICBpbnN0YW5jZS5jaGFydEluc3RhbmNlID0gY2hhcnRJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgXSk7XG4gICAgICB0aGlzLnNwYWNlTWFuYWdlckluc3RhbmNlID0gaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc2V0QWN0aXZlUGVyaW9kKHRoaXMuc3RhcnRBY3RpdmVXaW5kb3csIHRoaXMuZW5kQWN0aXZlV2luZG93KTtcbiAgICAgIC8vIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ194LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddICs9IDEyNDQxNjAwMDAwMDtcbiAgICAgIHRoaXMuc2V0QWN0aXZlUGVyaW9kKHRoaXMuc3RhcnRBY3RpdmVXaW5kb3csIHRoaXMuZW5kQWN0aXZlV2luZG93KTtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy5jaGFydEluc3RhbmNlLmFwaUluc3RhbmNlLmdldENvbXBvbmVudFN0b3JlKCk7XG4gICAgICB0aGlzLnRpbWVSdWxlcyA9IHRoaXMudGltZVJ1bGVzLmdldENhbnZhc0J5SW5kZXgoMCkuY29tcG9zaXRpb24uaW1wbDtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0RGF0YUFnZ3JlZ2F0b3IoKTtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMoKTtcbiAgICAgIHRoaXMudG9vbGJhcnMgPSBbXTtcbiAgICAgIHRoaXMubWVhc3VyZW1lbnQgPSB7fTtcblxuICAgICAgdGhpcy50b29sYmFycy5wdXNoKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBjcmVhdGVUb29sYmFyICgpIHtcbiAgICAgIHZhciB1bmlncm91cCxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMsXG4gICAgICAgIGNvbnRleHR1YWxCdXR0b25zLFxuICAgICAgICBhbGxCdXR0b24sXG4gICAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgICBlbmRBY3RpdmUgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLFxuICAgICAgICBkZWR1Y3RvckFyID0gW10sXG4gICAgICAgIHN0YXJ0TXVsdGlwbGllcixcbiAgICAgICAgZGVkdWN0b3IsXG4gICAgICAgIGksXG4gICAgICAgIGosXG4gICAgICAgIG1hcmdpbixcbiAgICAgICAgZnJvbURhdGVMYWJlbCxcbiAgICAgICAgZ3JvdXA7XG5cbiAgICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuXG4gICAgICB1bmlncm91cCA9IG5ldyB0aGlzLnRvb2xib3guVW5pU2VsZWN0Q29tcG9uZW50R3JvdXAoe1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9KTtcbiAgICAgIHVuaWdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIGdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIHRvb2xiYXIgPSBuZXcgdGhpcy5Ib3Jpem9udGFsVG9vbGJhcih7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuICAgICAgdG9vbGJhci5zZXRDb25maWcoe1xuICAgICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgICAgfSk7XG4gICAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnWm9vbTonLCB7XG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcbiAgICAgIH0sIHtcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAnZm9udC1mYW1pbHknOiAnXCJMdWNpZGEgR3JhbmRlXCIsIHNhbnMtc2VyaWYnLFxuICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxMycsXG4gICAgICAgICAgICAnZmlsbCc6ICcjNjk2OTY5J1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udGFpbmVyOiB7XG4gICAgICAgICAgaGVpZ2h0OiAyMlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZUxhYmVsKTtcbiAgICAgIGFsbEJ1dHRvbiA9IG5ldyB0aGlzLnRvb2xib3guU3ltYm9sKCdBTEwnLCB0cnVlLCB7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0sIHtcbiAgICAgICAgZmlsbDogJyNmZmZmZmYnLFxuICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcbiAgICAgICAgc3Ryb2tlOiAnI2NlZDVkNCcsXG4gICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICAgIGhvdmVyRmlsbDogJyNjZWQ1ZDQnLFxuICAgICAgICBoZWlnaHQ6IDIyLFxuICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgIHJpZ2h0OiA1XG4gICAgICAgIH0sXG4gICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgICdmb250RmFtaWx5JzogJ1wiTHVjaWRhIEdyYW5kZVwiLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICAnZm9udFNpemUnOiAnMTMnLFxuICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuICAgICAgICAgICdsaW5lLWhlaWdodCc6ICcxJyxcbiAgICAgICAgICAnbGV0dGVyLXNwYWNpbmcnOiAnLTAuMDRlbSdcbiAgICAgICAgfVxuICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9vbHRleHQ6ICdBTEwnXG4gICAgICB9KTtcblxuICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGFsbEJ1dHRvbik7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICAgIGRlZHVjdG9yQXIucHVzaChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjYWxjdWxhdGVkQnV0dG9ucyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IHNlbGYuc3RhcnRQb2ludFVuaXQ7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGlmIChpID09PSBzZWxmLnN0YXJ0UG9pbnRVbml0KSB7XG4gICAgICAgICAgc3RhcnRNdWx0aXBsaWVyID0gc2VsZi5zdGFydFBvaW50TXVsdGlwbGllcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRNdWx0aXBsaWVyOyBqID49IDA7IGotLSkge1xuICAgICAgICAgIG1hcmdpbiA9IChpID09PSBzZWxmLm5vQ2FsY0J1dHRvbnMgJiYgaiA9PT0gMCkgPyA1IDogMDtcbiAgICAgICAgICBjYWxjdWxhdGVkQnV0dG9uc1tpXSA9IG5ldyB0aGlzLnRvb2xib3guU3ltYm9sKHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcbiAgICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAnMicsXG4gICAgICAgICAgICBzdHJva2U6ICcjY2VkNWQ0JyxcbiAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICAgICAgICBob3ZlckZpbGw6ICcjY2VkNWQ0JyxcbiAgICAgICAgICAgIGhlaWdodDogMjIsXG4gICAgICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgcmlnaHQ6IG1hcmdpblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgICAgICdmb250U2l6ZSc6ICcxMycsXG4gICAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuICAgICAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG4gICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZyc6ICctMC4wNGVtJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBkZWR1Y3RvciA9IChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChkZWR1Y3Rvcik7XG4gICAgICAgICAgICAgIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgICBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgICAgICAgIC8vIHRoaXMudG9vbGJhcnNbdGhpcy50b29sYmFycy5sZW5ndGggLSAxXSA9IHRoaXMuY3JlYXRlVG9vbGJhcigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvb2x0ZXh0OiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyAnICcgKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uZGVzY3JpcHRpb25cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB1bmlncm91cC5hZGRTeW1ib2woY2FsY3VsYXRlZEJ1dHRvbnNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnRleHR1YWxCdXR0b25zID0gW107XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29udGV4dHVhbEJ1dHRvbnNbaV0gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcbiAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBmaWxsOiAnI2ZmZmZmZicsXG4gICAgICAgICAgbGFiZWxGaWxsOiAnIzY5Njk2OScsXG4gICAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcbiAgICAgICAgICBzdHJva2U6ICcjY2VkNWQ0JyxcbiAgICAgICAgICBzdHJva2VXaWR0aDogJzEnLFxuICAgICAgICAgIGhlaWdodDogMjIsXG4gICAgICAgICAgaG92ZXJGaWxsOiAnI2NlZDVkNCcsXG4gICAgICAgICAgcmFkaXVzOiAxLFxuICAgICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgICAgcmlnaHQ6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgICAgJ2ZvbnRGYW1pbHknOiAnXCJMdWNpZGEgR3JhbmRlXCIsIHNhbnMtc2VyaWYnLFxuICAgICAgICAgICAgJ2ZvbnRTaXplJzogJzEzJyxcbiAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuICAgICAgICAgICAgJ2xpbmUtaGVpZ2h0JzogJzEnLFxuICAgICAgICAgICAgJ2xldHRlci1zcGFjaW5nJzogJy0wLjA0ZW0nXG4gICAgICAgICAgfVxuICAgICAgICB9KS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kYXRlU3RhcnQsIHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmRhdGVFbmQpO1xuICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgICB0b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgICBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAgIHNlbGYuZHJhdygpO1xuICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b29sdGV4dDogdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uZGVzY3JpcHRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChjb250ZXh0dWFsQnV0dG9uc1tpXSk7XG4gICAgICB9XG5cbiAgICAgICAgLy8gYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyk7XG4gICAgICAgIC8vIGJ0bi5pZCA9IHN0YW5kYXJkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgIC8vIGJ0bi5pbm5lckhUTUwgPSBzdGFuZGFyZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAvLyBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudEJ0bi5iaW5kKHRoaXMsIHN0YW5kYXJkUGVyaW9kc1tpXSkpO1xuICAgICAgICAvLyBjb250ZXh0dWFsQnV0dG9ucy5hcHBlbmRDaGlsZChidG4pO1xuXG4gICAgICB0aGlzLlN5bWJvbFN0b3JlLnJlZ2lzdGVyKCd0ZXh0Qm94SWNvbicsIGZ1bmN0aW9uICh4LCB5LCByYWQsIHcsIGgsIHBhZFgsIHBhZFkpIHtcbiAgICAgICAgdmFyIHgxID0geCAtIHcgLyAyICsgcGFkWCAvIDIsXG4gICAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcbiAgICAgICAgICB5MSA9IHkgLSBoIC8gMiArIHBhZFkgLyAyLFxuICAgICAgICAgIHkyID0geSArIGggLyAyIC0gcGFkWSAvIDI7XG5cbiAgICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcbiAgICAgIH0pO1xuXG4gICAgICB0b29sYmFyLmFkZENvbXBvbmVudChncm91cCk7XG4gICAgICB0b29sYmFyLmFkZENvbXBvbmVudCh1bmlncm91cCk7XG4gICAgICByZXR1cm4gdG9vbGJhcjtcbiAgICB9O1xuXG4gICAgZ2V0TG9naWNhbFNwYWNlIChhdmFpbGFibGVXaWR0aCA9IHRoaXMuX3BXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0ID0gdGhpcy5fcEhlaWdodCkge1xuICAgICAgLy8gYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICAgIHZhciBsb2dpY2FsU3BhY2UsXG4gICAgICAgIHdpZHRoID0gNDIwLCAvLyB3aWR0aCBoYXJkY29kZWQ7IFRPRE86IG1ha2UgaXQgZHluYW1pY1xuICAgICAgICBoZWlnaHQgPSAwLFxuICAgICAgICBpLFxuICAgICAgICBsbjtcblxuICAgICAgZm9yIChpID0gMCwgbG4gPSB0aGlzLnRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgbG9naWNhbFNwYWNlID0gdGhpcy50b29sYmFyc1tpXS5nZXRMb2dpY2FsU3BhY2UoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIC8vIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG4gICAgICAgIGhlaWdodCArPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgICB9XG4gICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICBoZWlnaHQ6IGhlaWdodFxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgZ2V0RGVmYXVsdEdyb3VwICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhcmVudEdyb3VwO1xuICAgIH1cblxuICAgIHBsYWNlSW5DYW52YXMgKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICAgIHNlbGYuc3BhY2VNYW5hZ2VySW5zdGFuY2UuYWRkKFt7XG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1leHQnO1xuICAgICAgICB9LFxuICAgICAgICByZWY6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGY6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpb3JpdHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgfSxcbiAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIG9iai5pbmxpbmU7XG4gICAgICAgIH0sXG4gICAgICAgIG9yaWVudGF0aW9uOiBbe1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmouaG9yaXpvbnRhbDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvc2l0aW9uOiBbe1xuICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLnRvcDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG4gICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmxlZnQ7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRpbWVuc2lvbnM6IFtmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9yZWYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldExvZ2ljYWxTcGFjZSgoc2VsZi5fcFdpZHRoID0gcGFyZW50LmdldFdpZHRoKCkpLCAoc2VsZi5fcEhlaWdodCA9IHBhcmVudC5nZXRIZWlnaHQoKSkpO1xuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV0pO1xuICAgIH07XG5cbiAgICBzZXREcmF3aW5nQ29uZmlndXJhdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuICAgICAgbWVzLnggPSB4O1xuICAgICAgbWVzLnkgPSB5O1xuICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG4gICAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBkcmF3ICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lYXN1cmVtZW50ID0gdGhpcy5tZWFzdXJlbWVudCxcbiAgICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuICAgICAgICBsbixcbiAgICAgICAgaSxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgYm91bmRFbGVtZW50LFxuICAgICAgICBiQm94LFxuICAgICAgICB4MSxcbiAgICAgICAgeDIsXG4gICAgICAgIHkyLFxuICAgICAgICBzZWxlY3RMaW5lO1xuXG4gICAgICBzZWxlY3RMaW5lID0gdGhpcy5zYXZlU2VsZWN0TGluZSB8fCB0aGlzLmdyYXBoaWNzLnBhcGVyLnBhdGgoe1xuICAgICAgICAnc3Ryb2tlJzogJyNjOTVhNWEnLFxuICAgICAgICAnc3Ryb2tlLXdpZHRoJzogJzJweCdcbiAgICAgIH0pLnRvRnJvbnQoKTtcbiAgICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcbiAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcbiAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcbiAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcbiAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc2F2ZVNlbGVjdExpbmUgPSBzZWxlY3RMaW5lO1xuXG4gICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0b29sYmFyc1swXS5jb21wb25lbnRHcm91cHNbMV0uc3ltYm9sTGlzdDsgaSA8IGlpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpaVtpXS5zeW1ib2wgPT09IHRoaXMuY2xpY2tlZElkKSB7XG4gICAgICAgICAgYm91bmRFbGVtZW50ID0gaWlbaV0uZ2V0Qm91bmRFbGVtZW50KCk7XG4gICAgICAgICAgYkJveCA9IGJvdW5kRWxlbWVudC5nZXRCQm94KCk7XG4gICAgICAgICAgeDEgPSBiQm94Lng7XG4gICAgICAgICAgeDIgPSBiQm94LngyO1xuICAgICAgICAgIHkyID0gYkJveC55MjtcblxuICAgICAgICAgIHNlbGVjdExpbmUuYXR0cih7XG4gICAgICAgICAgICBwYXRoOiBbJ00nLCB4MSAtIDAuNSwgeTIgLSAwLjUsICdMJywgeDIgKyAwLjUsIHkyIC0gMC41XVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl19

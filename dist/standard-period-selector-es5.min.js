!function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(2);!function(a,n){"object"===t(e)&&e.exports?e.exports=a.document?n(a):function(e){if(!e.document)throw new Error("Window with document not present");return n(e,!0)}:a.StandardPeriodSelector=n(a,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var a=e.FusionCharts;a.register("extension",["private","standard-period-selector",function(){a.registerComponent("extensions","standard-period-selector",n({FusionCharts:a}))}])})}).call(t,a(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();e.exports=function(e){var t=function(){function e(){a(this,e);var t=this;t.ratio=8,t.toolbox=FusionCharts.getComponent("api","toolbox"),t.HorizontalToolbar=t.toolbox.HorizontalToolbar,t.ComponentGroup=t.toolbox.ComponentGroup,t.SymbolStore=t.toolbox.SymbolStore,t.all=1,t.calculatedPeriods=[],t.startDataset=0,t.startActiveWindow=0,t.endActiveWindow=1,t.standardCalculatedPeriods=[],t.standardContexualPeriods=[],t.startPointUnit=0,t.startPointMultiplier=0,t.noCalcButtons=0,t.minimumBucket=1,t.buttonGroup={},t.toolbar={},t.categoryClicked,t.btns={contextualObj:{},calculatedObj:{}},t.tdButtons=[{name:"YTD",abbreviation:"YTD",parent:"year",milliseconds:31104e6,description:"Year to Date"},{name:"QTD",abbreviation:"QTD",parent:"month",multiplier:3,milliseconds:7776e6,description:"Quarter to Date"},{name:"MTD",abbreviation:"MTD",parent:"month",milliseconds:2592e6,description:"Month to Date"},{name:"WTD",abbreviation:"WTD",parent:"day",multiplier:7,milliseconds:6048e5,description:"Week to Date"},{name:"Y",abbreviation:"Y",parent:"day",milliseconds:864e5,description:"Yesterday"},{name:"T",abbreviation:"T",parent:"day",milliseconds:864e5,description:"Today"}],t.config={anchorPositions:"right",all:"1",contextual:"1",calculated:"1",tertiaryTimePeriods:{}},t._babTimer=0,t.propsChangeListener=function(e,a){t.startActiveWindow=e[1],t.endActiveWindow=a[1],t._babTimer?t.updatePending||(t.updatePending=!0,setTimeout(function(){t.updatePending=!1,t.onActiveRangeChange()},t._babTimer)):(t._babTimer=200,t.onActiveRangeChange())}}return n(e,[{key:"hideAllCalcBtns",value:function(){var e,t=this,a=t.btns.calculatedObj;for(e in a)a[e].btn.hide()}},{key:"showApplicableCalculatedButtons",value:function(){var e,t,a,n,i=this,o=0,r=0,s=0,l=0,c=i.endActiveWindow-i.startActiveWindow,d=i.anchorPositions,u=i.btns.calculatedObj,p=i.timePeriods,b=0,g=[],m=i.minimumBucket,h=i.maximumBucket;for("right"===d?e=i.endActiveWindow-i.startDataset:"left"===d&&(e=i.endDataset-i.startActiveWindow),i.hideAllCalcBtns(),o=0,r=p.length;o<r;o++)if(b=p[o].interval,a=p[o].name,n=p[o].abbreviation.single,e/b>=1)if(Math.floor(c/b)<1)g.push({name:a,abbreviation:n,multipliers:[1]});else for(g.push({name:a,abbreviation:n,multipliers:[]}),s=0,l=p[o].multipliers.length;s<l;s++)c/i.ratio<p[o].multipliers[s]*b&&p[o].multipliers[s]*b>m&&p[o].multipliers[s]*b<h&&g[g.length-1].multipliers.push(p[o].multipliers[s]);for(o=0,r=g.length;o<r;o++)for(s=0,l=g[o].multipliers.length;s<l;s++)t=g[o].multipliers[s]+g[o].name,u[t]&&u[t].btn&&u[t].btn.show();i.standardCalculatedPeriods=g,i.toolbar&&i.toolbar.redraw(),i.state?i.buttonGroup.setState&&i.buttonGroup.setState(i.state):i.buttonGroup.setState&&i.buttonGroup.setState(null)}},{key:"highlightActiveRange",value:function(){var e,t=this,a=t.clickedId,n=t.btns.contextualObj,i=t.btns.calculatedObj;e=n[a]||i[a]||t.btns[a],e&&e.btn&&(t.buttonGroup.setState(e.btn),t.state=e.btn)}},{key:"onActiveRangeChange",value:function(){var e,t,a,n=this,i=n.categoryClicked,o=n.clickedId,r=n.startDataset,s=n.endDataset,l=n.startActiveWindow,c=n.endActiveWindow,d=n.btns.contextualObj,u=n.btns.calculatedObj;if("ALL"===i)r===l&&s===c||(delete n.clickedId,delete n.categoryClicked);else if("contextual"===i)a=d[o],!a||l===a.contextStart&&c===a.contextEnd||(delete n.clickedId,delete n.categoryClicked);else if("calculated"===i)a=u[o],a&&c-l!==a.interval&&(delete n.clickedId,delete n.categoryClicked);else if(r===l&&s===c)n.clickedId="ALL",n.categoryClicked="ALL";else{for(e in d)a=d[e],l===a.contextStart&&c===a.contextEnd&&(n.clickedId=e,n.categoryClicked="contextual",t=!0);if(!t)for(e in u)a=u[e],c-l===a.interval&&(n.clickedId=e,n.categoryClicked="calculated");t||delete n.state}n.toolbarDrawn&&(n.showApplicableCalculatedButtons(),n.highlightActiveRange())}},{key:"processMultipliers",value:function(e,t){for(var a=0,n=e.length;a<n;a++){var i=e[a].possibleFactors.length,o=e[a]&&e[a].name,r=e&&e[a];r.multipliers=[],void 0===t&&(t={}),t[o]?r.multipliers=t[o]:1===i?r.multipliers.push(r.possibleFactors[0]):2===i?(r.multipliers.push(r.possibleFactors[0]),r.multipliers.push(r.possibleFactors[i-1])):(r.multipliers.push(r.possibleFactors[0]),r.multipliers.push(Math.floor(r.possibleFactors[i-1]/2)),r.multipliers.push(r.possibleFactors[i-1]))}return e}},{key:"createCalculatedButtons",value:function(e){for(var t,a=this,n=a.btns.calculatedObj,i=a.anchorPositions,o=a.minimumBucket,r=a.maximumBucket,s=a.globalReactiveModel.model,l={},c=a.timePeriods.length-1;c>=0;c--)for(var d=function(d){var u=a.timePeriods[c].multipliers[d]+a.timePeriods[c].abbreviation.single,p=a.timePeriods[c].multipliers[d]+a.timePeriods[c].name,b=a.timePeriods[c].multipliers[d]*a.timePeriods[c].interval;b>o&&b<r&&(t=n[p]={interval:b,fn:function(){a.clickedId=p,a.categoryClicked="calculated",a.highlightActiveRange(),"right"===i?s["x-axis-absolute-range-start"]>a.endActiveWindow-b?a.globalReactiveModel.lock().prop("x-axis-visible-range-end",s["x-axis-absolute-range-start"]+b).prop("x-axis-visible-range-start",a.startDataset).unlock():s["x-axis-visible-range-start"]=a.endActiveWindow-b:s["x-axis-absolute-range-end"]<a.startActiveWindow+b?a.globalReactiveModel.lock().prop("x-axis-visible-range-end",a.endDataset).prop("x-axis-visible-range-start",s["x-axis-absolute-range-end"]-b).unlock():s["x-axis-visible-range-end"]=a.startActiveWindow+b},shortKey:u},l[p]={text:u,config:{height:22,radius:1,margin:{left:-4.5}},group:e,eventListeners:{click:t.fn}},a.btns[p]=t)},u=a.timePeriods[c].multipliers.length-1;u>=0;u--)d(u);a.createD3Buttons(l)}},{key:"generateCtxBtnList",value:function(){var e=this,t=e.standardContexualPeriods,a=0,n=0,i=e.globalReactiveModel.model["x-axis-absolute-range-end"],o=i-2,r=i,s={},l=e.tdButtons,c=e.minimumBucket||1,d=e.startActiveWindow,u=e.endActiveWindow;for(n=l.length;a<n;a++)o=new Date(i),"YTD"===l[a].name?(o.setMonth(0),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"MTD"===l[a].name?(o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"QTD"===l[a].name?(o.setMonth(11-o.getMonth()%4),o.setDate(0),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"WTD"===l[a].name?(o.setDate(o.getDate()-o.getDay()),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"Y"===l[a].name?(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o-=864e5):"T"===l[a].name&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),i===+o&&(o=+o-864e5)),r<o&&r-o<c||(l[a].dateStart=o.valueOf(),l[a].dateEnd=r.valueOf(),t.push(l[a]));for(s.milliseconds=1/0,a=0,n=l.length;a<n;a++)Math.abs(l[a].milliseconds-(u-d))<s.milliseconds&&(s.milliseconds=l[a].milliseconds,s.name=l[a].abbreviation)}},{key:"createContextualButtons",value:function(e){var t,a,n=this,i=n.btns.contextualObj,o=0,r={};n.generateCtxBtnList();for(var s=function(s,l){return n.standardContexualPeriods[s].dateEnd-n.standardContexualPeriods[s].dateStart>=n.minimumBucket&&n.standardContexualPeriods[s].dateStart>n.startDataset?(a=n.standardContexualPeriods[s].abbreviation,t=i[a]={contextStart:n.standardContexualPeriods[s].dateStart,contextEnd:n.standardContexualPeriods[s].dateEnd,fn:function(){n.categoryClicked="contextual",n.clickedId=n.standardContexualPeriods[s].abbreviation,n.highlightActiveRange(),n.globalReactiveModel.lock().prop("x-axis-visible-range-end",n.standardContexualPeriods[s].dateEnd).prop("x-axis-visible-range-start",n.standardContexualPeriods[s].dateStart).unlock()}},r[n.standardContexualPeriods[s].abbreviation]={text:n.standardContexualPeriods[s].abbreviation,config:{height:22,radius:1,margin:{left:o}},group:e,eventListeners:{click:t.fn}},o=-5,void(n.btns[n.standardContexualPeriods[s].abbreviation]=t)):"continue"},l=0,c=this.standardContexualPeriods.length;l<c;l++){s(l,c)}n.createD3Buttons(r)}},{key:"addCssRules",value:function(e,t){var a,n,i=this.graphics.paper;for(a in e)switch(n=e[a],a){case"container":t.container&&i.cssAddRule("."+n,t.container.style);break;case"text":t.text&&i.cssAddRule("."+n,t.text.style)}}},{key:"createD3Buttons",value:function(e){var t,a,n,i,o,r,s,l=this.extData.button,c=this.graphics.paper,d=c.getInstances().d3,u=this;for(t in e){a=e[t],n=a.text,i=a.config,s=u.btns[t].btn=d.button(n).setConfig(i),s.namespace("fusioncharts"),s.appendSelector("standarperiodselector"),u.addCssRules(s.getIndividualClassNames(s.getClassName()),l),o=l.states;for(r in o)u.addCssRules(s.getIndividualClassNames(s.config.states[r]),l.states[r]);a.eventListeners&&s.attachEventHandlers({click:a.eventListeners.click.bind(s)}),a.group.addSymbol(s)}}},{key:"createD3Labels",value:function(e){var t,a,n,i,o=this.extData.label,r=this,s={paper:r.graphics.paper,chart:r.chart,smartLabel:r.smartLabel,chartContainer:r.graphics.container};for(t in e)a=e[t],n=a.text,i=a.config,r[t]=new r.toolbox.Label(n,s,i),r.addCssRules(r[t].getIndividualClassNames(r[t].getClassName()),o),a.group.addSymbol(r[t])}},{key:"createToolbar",value:function(){var e,t,a,n,i,o,r,s,l=this,c={paper:l.graphics.paper,chart:l.chart,smartLabel:l.smartLabel,chartContainer:l.graphics.container};t=new l.HorizontalToolbar(c),t.setConfig({fill:"#fff",borderThickness:0}),r=new l.toolbox.ComponentGroup(c),e=new l.toolbox.UniSelectComponentGroup(c),e.defineStateIndicator(function(e){var t=e.getBBox(),a=t.x,n=a+t.width,i=t.y+t.height;return{type:"path",attrs:{d:["M",a+1,i-1.2,"L",n,i-1.2].join(" "),"stroke-width":2,stroke:"#c95a5a"}}}),s=new l.toolbox.ComponentGroup(c),e.setConfig({fill:"#fff",borderThickness:0}),r.setConfig({fill:"#fff",borderThickness:0}),n={ZOOM:{text:"Zoom:",config:{height:22,margin:{right:-12}},group:r}},l.createD3Labels(n),a=l.allButtonShow&&{fn:function(){l.clickedId="ALL",l.categoryClicked="ALL",l.highlightActiveRange(),l.globalReactiveModel.lock().prop("x-axis-visible-range-end",l.endDataset).prop("x-axis-visible-range-start",l.startDataset).unlock()}},o={ALL:{text:"ALL",config:{height:22,radius:1,margin:{right:10}},group:e,eventListeners:{click:a.fn}}},i={dummy:{text:"___",config:{height:22,radius:1},group:s}},a&&(l.btns.ALL=a,l.createD3Buttons(o));for(var d=0;d<6;d++)l.btns.dummy={},l.createD3Buttons(i);return t.addComponent(r),t.addComponent(e),t.addComponent(s),l.toolbar=t,l.dummyButtonGroup=s,l.buttonGroup=e,t}},{key:"init",value:function(e){var t=this;return e(["graphics","chart","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","extData","chartInstance",function(e,a,n,i,o,r,s,l,c,d){t.graphics=e,t.chart=a,t.markerManager=i,t.canvasConfig=n,t.reactiveModel=o,t.globalReactiveModel=r,t.spaceManagerInstance=s,t.smartLabel=l,t.extDataUser=c,t.chartInstance=d}]),t.extData={disabled:!1,"default-select":"ALL","all-button":!0,"contextual-button":!0,"calculated-button":!0,posWrtCanvas:"top","anchor-align":"right",layout:"inline",alignment:"left",orientation:"horizontal",customMultipliers:{millisecond:[1,500],second:[1,5,15,30],minute:[1,5,15,30],hour:[1,3,6,12],day:[1,7,15],month:[1,3,6],year:[1,3,5]},button:{height:22,radius:1,className:"standard-period-selector",container:{style:{fill:"#FFFFFF","stroke-width":"1px",stroke:"#CED5D4",labelFill:"#4b4b4b",strokeWidth:"1px"}},text:{style:{fontFamily:'"Lucida Grande", sans-serif',"font-size":"13px",fill:"#4b4b4b","line-height":"1px","letter-spacing":"-0.04em"}},states:{hover:{className:"standard-period-selector-state-hover",container:{style:{cursor:"pointer",fill:"#f7f7f7"}}}}},label:{height:22,className:"standard-period-selector-label",text:{style:{"font-family":'"Lucida Grande", sans-serif',"font-size":"13px",fill:"#4b4b4b"}}}},Object.assign(t.extData,t.extDataUser),t.endActiveWindow=t.globalReactiveModel.model["x-axis-visible-range-end"],t.startActiveWindow=t.globalReactiveModel.model["x-axis-visible-range-start"],t.startDataset=t.globalReactiveModel.model["x-axis-absolute-range-start"],t.endDataset=t.globalReactiveModel.model["x-axis-absolute-range-end"],t.maximumBucket=t.endDataset-t.startDataset,t.timeRules=t.chartInstance.apiInstance.getComponentStore(),t.timeRules=t.timeRules.getCanvasByIndex(0).composition.impl,t.timeRules=t.timeRules.getDataAggregator(),t.timeRules=t.timeRules.getAggregationTimeRules(),t.timePeriods=t.processMultipliers(t.timeRules,t.extData.customMultipliers),t.allButtonShow=t.extData["all-button"],t.calculatedButtonShow=t.extData["calculated-button"],t.contextualButtonShow=t.extData["contextual-button"],t.anchorPositions=t.extData["anchor-align"],t.customMultipliers=t.extData.customMultipliers,t.keySelect=t.extData["default-select"],t.measurement={},t.flag=!0,t.toolbars=[],t.toolbars.push(t.createToolbar()),t.globalReactiveModel.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],t.propsChangeListener),t.globalReactiveModel.onPropChange("x-axis-absolute-range-end",function(e){"contextual"===t.categoryClicked&&(t.globalReactiveModel.model["x-axis-visible-range-end"]=t.globalReactiveModel.model["x-axis-absolute-range-end"])}),t}},{key:"getLogicalSpace",value:function(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._pWidth,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pHeight,o=0,r=0,s=this;for(t=0,a=s.toolbars.length;t<a;t++)e=s.toolbars[t].getLogicalSpace(n,i),o=Math.max(e.width,o),r+=e.height,s.toolbars[t].width=e.width,s.toolbars[t].height=e.height;return r+=s.padding,{width:o,height:r}}},{key:"getDefaultGroup",value:function(){return this.parentGroup}},{key:"placeInCanvas",value:function(){var e=this;e.padding=5,e.spaceManagerInstance.add([{name:function(){return"standard-period-selector-ext"},ref:function(e){return e[0]},self:function(){return e},priority:function(){return 2},layout:function(t){return t[e.extData.layout]||"inline"},orientation:[{type:function(t){return t[e.extData.orientation]||"horizontal"},position:[{type:function(t){return t[e.extData.posWrtCanvas]||"top"},alignment:[{type:function(t){return t[e.extData.alignment]||"left"},dimensions:[function(){var t=this.getParentComponentGroup();return e._ref=this,e.getLogicalSpace(e._pWidth=t.getWidth(),e._pHeight=t.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,a,n,i){var o=this.measurement;return o.x=e,o.y=t,o.width=a,o.height=n,this.parentGroup=i,this}},{key:"draw",value:function(e,t,a,n,i){var o,r,s,l,c,d,u=this,p=u.measurement,b=u.toolbars,g=u.btns.contextualObj,m=u.btns.calculatedObj,h=u.clickedId,f=u.globalReactiveModel.model,v=u.minimumBucket,x=u.buttonGroup;if(v=f["minimum-consecutive-datestamp-diff"]*f["x-axis-maximum-allowed-ticks"],u.minimumBucket=v,u.dummyButtonGroup.dispose(),b[0].removeComponent(u.dummyButtonGroup),u.calculatedButtonShow&&u.createCalculatedButtons(x),u.contextualButtonShow&&u.createContextualButtons(x),x.getLogicalSpace(),u.keySelect){if("ALL"===u.keySelect)u.clickedId="ALL";else if(g[u.keySelect])u.clickedId=u.keySelect;else{c=!0;for(d in m)c&&m[d].shortKey===u.keySelect&&(u.clickedId=d,c=!1)}delete u.keySelect,h=u.clickedId}if(e=void 0===e?p.x:e,t=void 0===t?p.y:t,a=void 0===a?p.width:a,n=void 0===n?p.height:n,i=void 0===i?this.parentGroup:i,a&&n){for(r=0,o=b.length;r<o;r++)s=b[r],s.draw(e,t,i),u.toolbarDrawn=!0;h?(l=m[h]||g[h]||u.btns[h],l?l.fn&&l.fn():u.onActiveRangeChange()):u.onActiveRangeChange()}}}]),e}();return t}}]);
//# sourceMappingURL=standard-period-selector-es5.min.js.map
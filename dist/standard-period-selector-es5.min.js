!function(t){function e(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return t[a].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(2);window.stPS=new a,function(i,a){"object"===e(t)&&t.exports?t.exports=i.document?a(i):function(t){if(!t.document)throw new Error("Window with document not present");return a(t,!0)}:i.StandardPeriodSelector=a(i,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var i=t.FusionCharts;i.register("extension",["private","StandardPeriodSelector",function(){i.registerComponent("extensions","StandardPeriodSelector",a({FusionCharts:i}))}])})}).call(e,i(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();t.exports=function(t){var e=function(){function t(){i(this,t),this.ratio=8,this.toolbox=FusionCharts.getComponent("api","toolbox"),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.all=1,this.calculatedPeriods=[],this.startDataset=0,this.startActiveWindow=0,this.endActiveWindow=1,this.standardCalculatedPeriods=[],this.standardContexualPeriods=[],this.startPointUnit=0,this.startPointMultiplier=0,this.clickedId="ALL",this.noCalcButtons=0,this.calculatedButtonObj={},this.tdButtons=[{name:"YTD",abbreviation:"YTD",parent:"year",milliseconds:31104e6,description:"Year to Date"},{name:"QTD",abbreviation:"QTD",parent:"month",multiplier:3,milliseconds:7776e6,description:"Quarter to Date"},{name:"MTD",abbreviation:"MTD",parent:"month",milliseconds:2592e6,description:"Month to Date"},{name:"WTD",abbreviation:"WTD",parent:"day",multiplier:7,milliseconds:6048e5,description:"Week to Date"},{name:"Y",abbreviation:"Y",parent:"day",milliseconds:864e5,description:"Yesterday"},{name:"T",abbreviation:"T",parent:"day",milliseconds:864e5,description:"Today"}],this.config={anchorPositions:"right",all:"1",contextual:"1",calculated:"1",tertiaryTimePeriods:{}}}return a(t,[{key:"generateCalculatedButtons",value:function(){var t=this.endActiveWindow-this.startDataset,e=0,i=0,a=this.endActiveWindow-this.startActiveWindow,s=0;for(this.standardCalculatedPeriods=[],e=0;e<this.timePeriods.length;e++)if(t/this.timePeriods[e].interval>=1)if(Math.floor(a/this.timePeriods[e].interval)<1)this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation.single,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].interval,name:this.timePeriods[e].name,multipliers:[1]});else for(this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation.single,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].interval,name:this.timePeriods[e].name,multipliers:[]}),i=0;i<this.timePeriods[e].multipliers.length;i++)a/this.ratio<this.timePeriods[e].multipliers[i]*this.timePeriods[e].interval&&this.standardCalculatedPeriods[this.standardCalculatedPeriods.length-1].multipliers.push(this.timePeriods[e].multipliers[i]);for(this.noCalcButtons=1/0,e=0;e<this.standardCalculatedPeriods.length;e++)for(i=0;i<this.standardCalculatedPeriods[e].multipliers.length;i++)++s,this.noCalcButtons>e&&(this.noCalcButtons=e),s<=4&&(this.startPointMultiplier=i,this.startPointUnit=e)}},{key:"generateContextualButtons",value:function(){for(var t=[],e=0,i=this.globalReactiveModel.model["x-axis-absolute-range-end"],a=i-2,s=i,o={};e<this.tdButtons.length;e++)a=new Date(i),"YTD"===this.tdButtons[e].name?(a.setMonth(0),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"MTD"===this.tdButtons[e].name?(a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"QTD"===this.tdButtons[e].name?(a.setMonth(11-a.getMonth()%4),a.setDate(0),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"WTD"===this.tdButtons[e].name?(a.setDate(a.getDate()-a.getDay()),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"Y"===this.tdButtons[e].name?(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a-=864e5):"T"===this.tdButtons[e].name&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),+this.endDataset===+a&&(a=+a-864e5)),s<a||(this.tdButtons[e].dateStart=a.valueOf(),this.tdButtons[e].dateEnd=s.valueOf(),t.push(this.tdButtons[e]));for(o.milliseconds=1/0,e=0;e<this.tdButtons.length;e++)Math.abs(this.tdButtons[e].milliseconds-(this.endActiveWindow-this.startActiveWindow))<o.milliseconds&&(o.milliseconds=this.tdButtons[e].milliseconds,o.name=this.tdButtons[e].abbreviation);this.standardContexualPeriods=t}},{key:"processMultipliers",value:function(t){for(var e=0;e<t.length;e++){var i=t[e].possibleFactors.length;t[e].multipliers=[],1===i?t[e].multipliers.push(t[e].possibleFactors[0]):2===i?(t[e].multipliers.push(t[e].possibleFactors[0]),t[e].multipliers.push(t[e].possibleFactors[i-1])):(t[e].multipliers.push(t[e].possibleFactors[0]),t[e].multipliers.push(Math.floor(t[e].possibleFactors[i-1]/2)),t[e].multipliers.push(t[e].possibleFactors[i-1]))}return t}},{key:"setActivePeriod",value:function(){var t,e;window.performance.now();1===arguments.length?(e=this.globalReactiveModel.model["x-axis-visible-range-end"],t=e-arguments[0]):2===arguments.length&&(t=arguments[0],e=arguments[1]),this.startActiveWindow=t,this.endActiveWindow=e,this.generateCalculatedButtons(),this.globalReactiveModel.model["x-axis-visible-range-start"]=this.startActiveWindow,this.globalReactiveModel.model["x-axis-visible-range-end"]=this.endActiveWindow,this.generateContextualButtons()}},{key:"configure",value:function(t){this.config=t}},{key:"init",value:function(t){var e=this;return t(["xAxis","yAxis","graphics","chart","dataset","PlotManager","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","extData","chartInstance",function(t,i,a,s,o,n,r,l,d,c,h,u,p,m){e.xAxis=t,e.yAxis=i,e.graphics=a,e.chart=s,e.dataset=o,e.plotManager=n,e.markerManager=l,e.canvasConfig=r,e.reactiveModel=d,e.globalReactiveModel=c,e.spaceManagerInstance=h,e.smartLabel=u,e.extData=p,e.chartInstance=m}]),this.spaceManagerInstance=e.spaceManagerInstance,this.globalReactiveModel=e.globalReactiveModel,this.endActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-end"],this.startActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-start"],this.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],this.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],this.timeRules=this.chartInstance.apiInstance.getComponentStore(),this.timeRules=this.timeRules.getCanvasByIndex(0).composition.impl,this.timeRules=this.timeRules.getDataAggregator(),this.timeRules=this.timeRules.getAggregationTimeRules(),this.timePeriods=this.processMultipliers(this.timeRules),this.setActivePeriod(this.startActiveWindow,this.endActiveWindow),this.toolbars=[],this.measurement={},this.flag=!0,this.toolbars.push(this.createToolbar()),this.globalReactiveModel.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],function(t,i){if(e.flag){e.flag=!1,e.setActivePeriod(t[1],i[1]);for(var a=0;a<e.standardCalculatedPeriods.length;a++)for(var s=0;s<e.standardCalculatedPeriods[a].multipliers.length;s++)i[1]-t[1]>=e.timePeriods[a].multipliers[s]*e.timePeriods[a].interval&&(e.clickedId=e.timePeriods[a].multipliers[s]+e.timePeriods[a].abbreviation.single);e.toolbar.dispose(),e.toolbars.pop(),e.toolbars.push(e.createToolbar()),e.getLogicalSpace(),e.draw()}}),this}},{key:"createToolbar",value:function(){var t,e,i,a,s,o,n,r,l,d,c,h,u=this,p=this,m=[];for(h=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t=new this.toolbox.UniSelectComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t.setConfig({fill:"#fff",borderThickness:0}),h.setConfig({fill:"#fff",borderThickness:0}),e=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),e.setConfig({fill:"#fff",borderThickness:0}),c=new this.toolbox.Label("Zoom:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-family":'"Lucida Grande", sans-serif',"font-size":"13",fill:"#696969","font-weight":"bold"}},container:{height:22}}),h.addSymbol(c),s=new this.toolbox.Symbol("ALL",!0,{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{fill:"#ffffff",labelFill:"#696969",symbolStrokeWidth:"2",stroke:"#ced5d4",strokeWidth:"1",hoverFill:"#ced5d4",height:22,radius:1,margin:{right:5},btnTextStyle:{fontFamily:'"Lucida Grande", sans-serif',fontSize:"13",fill:"#696969","line-height":"1","letter-spacing":"-0.04em"}}).attachEventHandlers({click:function(){p.setActivePeriod(p.startDataset,p.endDataset),e.dispose(),p.clickedId="ALL"},tooltext:"ALL"}),t.addSymbol(s),r=0;r<this.standardCalculatedPeriods.length;r++)for(l=this.standardCalculatedPeriods[r].multipliers.length-1;l>=0;l--)m.push(p.standardCalculatedPeriods[r].multipliers[l]*p.standardCalculatedPeriods[r].milliseconds);i={};for(var f in this.calculatedButtonObj)this.calculatedButtonObj[f].hide();for(var b=function(e){o=e===p.startPointUnit?p.startPointMultiplier:p.standardCalculatedPeriods[e].multipliers.length-1;for(var a=function(a){d=e===p.noCalcButtons&&0===a?5:0;var s=p.standardCalculatedPeriods[e].multipliers[a]+p.standardCalculatedPeriods[e].abbreviation;void 0===u.calculatedButtonObj[s]&&(i=new u.toolbox.Symbol(s,!0,{paper:u.graphics.paper,chart:u.chart,smartLabel:u.smartLabel,chartContainer:u.graphics.container},{fill:"#ffffff",labelFill:"#696969",symbolStrokeWidth:"2",stroke:"#ced5d4",strokeWidth:"1",hoverFill:"#ced5d4",height:22,radius:1,margin:{right:0},btnTextStyle:{fontFamily:'"Lucida Grande", sans-serif',fontSize:"13",fill:"#696969","line-height":"1","letter-spacing":"-0.04em"}}).attachEventHandlers({click:function(){n=p.standardCalculatedPeriods[e].multipliers[a]*p.standardCalculatedPeriods[e].milliseconds,p.clickedId=p.standardCalculatedPeriods[e].multipliers[a]+p.standardCalculatedPeriods[e].abbreviation,p.setActivePeriod(n)},tooltext:p.standardCalculatedPeriods[e].multipliers[a]+" "+p.standardCalculatedPeriods[e].description}),u.calculatedButtonObj[s]=i),u.calculatedButtonObj[s].show(),t.addSymbol(u.calculatedButtonObj[s])},s=o;s>=0;s--)a(s)},g=p.startPointUnit;g>=0;g--)b(g);a=[];for(var v=function(e){a[e]=new u.toolbox.Symbol(u.standardContexualPeriods[e].abbreviation,!0,{paper:u.graphics.paper,chart:u.chart,smartLabel:u.smartLabel,chartContainer:u.graphics.container},{fill:"#ffffff",labelFill:"#696969",symbolStrokeWidth:"2",stroke:"#ced5d4",strokeWidth:"1",height:22,hoverFill:"#ced5d4",radius:1,margin:{right:0},btnTextStyle:{fontFamily:'"Lucida Grande", sans-serif',fontSize:"13",fill:"#696969","line-height":"1","letter-spacing":"-0.04em"}}).attachEventHandlers({click:function(){p.setActivePeriod(p.standardContexualPeriods[e].dateStart,p.standardContexualPeriods[e].dateEnd),p.clickedId=p.standardContexualPeriods[e].abbreviation},tooltext:u.standardContexualPeriods[e].description}),t.addSymbol(a[e])},x=0;x<this.standardContexualPeriods.length;x++)v(x);return this.SymbolStore.register("textBoxIcon",function(t,e,i,a,s,o,n){var r=t-a/2+o/2,l=t+a/2-o/2,d=e-s/2+n/2,c=e+s/2-n/2;return["M",r,d,"L",l,d,"L",l,c,"L",r,c,"Z"]}),e.addComponent(h),e.addComponent(t),this.toolbar=e,e}},{key:"getLogicalSpace",value:function(){var t,e,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._pWidth,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pHeight,o=420,n=0;for(e=0,i=this.toolbars.length;e<i;e++)t=this.toolbars[e].getLogicalSpace(a,s),n+=t.height,this.toolbars[e].width=t.width,this.toolbars[e].height=t.height;return n+=this.padding,{width:o,height:n}}},{key:"getDefaultGroup",value:function(){return this.parentGroup}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"standard-period-selector-ext"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(t){return t.inline},orientation:[{type:function(t){return t.horizontal},position:[{type:function(t){return t.top},alignment:[{type:function(t){return t.left},dimensions:[function(){var e=this.getParentComponentGroup();return t._ref=this,t.getLogicalSpace(t._pWidth=e.getWidth(),t._pHeight=e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,i,a,s){var o=this.measurement;return o.x=t,o.y=e,o.width=i,o.height=a,this.parentGroup=s,this}},{key:"draw",value:function(t,e,i,a,s){var o,n,r,l,d,c,h,u,p,m=this.measurement,f=this.toolbars;this.globalReactiveModel;if(this.flag=!0,p=this.saveSelectLine||this.graphics.paper.path({stroke:"#c95a5a","stroke-width":"2px"}).toFront(),t=void 0===t?m.x:t,e=void 0===e?m.y:e,i=void 0===i?m.width:i,a=void 0===a?m.height:a,s=void 0===s?this.parentGroup:s,i&&a)for(n=0,o=f.length;n<o;n++)r=f[n],r.draw(t,e,s);this.saveSelectLine=p;for(var b=0,g=f[0].componentGroups[1].symbolList;b<g.length;b++)g[b].symbol===this.clickedId&&(l=g[b].getBoundElement(),d=l.getBBox(),c=d.x,h=d.x2,u=d.y2)}}]),t}();return e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDM4ZGI2OGRjYWE2NmE4ZmI5ZDRiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJTdGFuZGFyZFBlcmlvZFNlbGVjdG9yIiwid2luZG93Iiwic3RQUyIsImVudiIsImZhY3RvcnkiLCJkb2N1bWVudCIsIndpbiIsIkVycm9yIiwidW5kZWZpbmVkIiwiX3dpbmRvdyIsIndpbmRvd0V4aXN0cyIsIkZDIiwiRnVzaW9uQ2hhcnRzIiwicmVnaXN0ZXIiLCJyZWdpc3RlckNvbXBvbmVudCIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIiwiY2hpbGRyZW4iLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsImRlcCIsInRoaXMiLCJyYXRpbyIsInRvb2xib3giLCJnZXRDb21wb25lbnQiLCJIb3Jpem9udGFsVG9vbGJhciIsIkNvbXBvbmVudEdyb3VwIiwiU3ltYm9sU3RvcmUiLCJhbGwiLCJjYWxjdWxhdGVkUGVyaW9kcyIsInN0YXJ0RGF0YXNldCIsInN0YXJ0QWN0aXZlV2luZG93IiwiZW5kQWN0aXZlV2luZG93Iiwic3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyIsInN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyIsInN0YXJ0UG9pbnRVbml0Iiwic3RhcnRQb2ludE11bHRpcGxpZXIiLCJjbGlja2VkSWQiLCJub0NhbGNCdXR0b25zIiwiY2FsY3VsYXRlZEJ1dHRvbk9iaiIsInRkQnV0dG9ucyIsIm5hbWUiLCJhYmJyZXZpYXRpb24iLCJwYXJlbnQiLCJtaWxsaXNlY29uZHMiLCJkZXNjcmlwdGlvbiIsIm11bHRpcGxpZXIiLCJjb25maWciLCJhbmNob3JQb3NpdGlvbnMiLCJjb250ZXh0dWFsIiwiY2FsY3VsYXRlZCIsInRlcnRpYXJ5VGltZVBlcmlvZHMiLCJ2YWx1ZSIsInRhcmdldEJsb2NrIiwiaiIsImFjdGl2ZVdpbmRvdyIsImNvdW50IiwidGltZVBlcmlvZHMiLCJpbnRlcnZhbCIsIk1hdGgiLCJmbG9vciIsInB1c2giLCJzaW5nbGUiLCJtdWx0aXBsaWVycyIsIkluZmluaXR5IiwiYnV0dG9ucyIsImVuZFN0YW1wIiwiZ2xvYmFsUmVhY3RpdmVNb2RlbCIsIm1vZGVsIiwiZGF0ZVN0YXJ0IiwiZGF0ZUVuZCIsInJlbGF0aXZlVERCdXR0b24iLCJEYXRlIiwic2V0TW9udGgiLCJzZXREYXRlIiwic2V0SG91cnMiLCJzZXRNaW51dGVzIiwic2V0U2Vjb25kcyIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldERheSIsImVuZERhdGFzZXQiLCJ2YWx1ZU9mIiwiYWJzIiwidGltZUFyciIsImxlbiIsInBvc3NpYmxlRmFjdG9ycyIsInN0YXJ0IiwiZW5kIiwicGVyZm9ybWFuY2UiLCJub3ciLCJhcmd1bWVudHMiLCJnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zIiwiZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucyIsInJlcXVpcmUiLCJ4QXhpcyIsInlBeGlzIiwiZ3JhcGhpY3MiLCJjaGFydCIsImRhdGFzZXQiLCJwbG90TWFuYWdlciIsImNhbnZhc0NvbmZpZyIsIm1hcmtlck1hbmFnZXIiLCJyZWFjdGl2ZU1vZGVsIiwic3BhY2VNYW5hZ2VySW5zdGFuY2UiLCJzbWFydExhYmVsIiwiZXh0RGF0YSIsImNoYXJ0SW5zdGFuY2UiLCJ0aW1lUnVsZXMiLCJhcGlJbnN0YW5jZSIsImdldENvbXBvbmVudFN0b3JlIiwiZ2V0Q2FudmFzQnlJbmRleCIsImNvbXBvc2l0aW9uIiwiaW1wbCIsImdldERhdGFBZ2dyZWdhdG9yIiwiZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMiLCJwcm9jZXNzTXVsdGlwbGllcnMiLCJzZXRBY3RpdmVQZXJpb2QiLCJ0b29sYmFycyIsIm1lYXN1cmVtZW50IiwiZmxhZyIsImNyZWF0ZVRvb2xiYXIiLCJvblByb3BzQ2hhbmdlIiwidG9vbGJhciIsImRpc3Bvc2UiLCJwb3AiLCJnZXRMb2dpY2FsU3BhY2UiLCJkcmF3IiwidW5pZ3JvdXAiLCJjYWxjdWxhdGVkQnV0dG9ucyIsImNvbnRleHR1YWxCdXR0b25zIiwiYWxsQnV0dG9uIiwic3RhcnRNdWx0aXBsaWVyIiwiZGVkdWN0b3IiLCJtYXJnaW4iLCJmcm9tRGF0ZUxhYmVsIiwiZ3JvdXAiLCJfdGhpcyIsInNlbGYiLCJkZWR1Y3RvckFyIiwicGFwZXIiLCJjaGFydENvbnRhaW5lciIsImNvbnRhaW5lciIsIlVuaVNlbGVjdENvbXBvbmVudEdyb3VwIiwic2V0Q29uZmlnIiwiZmlsbCIsImJvcmRlclRoaWNrbmVzcyIsIkxhYmVsIiwidGV4dCIsInN0eWxlIiwiZm9udC1mYW1pbHkiLCJmb250LXNpemUiLCJmb250LXdlaWdodCIsImhlaWdodCIsImFkZFN5bWJvbCIsImxhYmVsRmlsbCIsInN5bWJvbFN0cm9rZVdpZHRoIiwic3Ryb2tlIiwic3Ryb2tlV2lkdGgiLCJob3ZlckZpbGwiLCJyYWRpdXMiLCJyaWdodCIsImJ0blRleHRTdHlsZSIsImZvbnRGYW1pbHkiLCJmb250U2l6ZSIsImxpbmUtaGVpZ2h0IiwibGV0dGVyLXNwYWNpbmciLCJhdHRhY2hFdmVudEhhbmRsZXJzIiwiY2xpY2siLCJ0b29sdGV4dCIsImhpZGUiLCJfbG9vcCIsIl9sb29wMyIsImtleUFiYiIsInNob3ciLCJfbG9vcDIiLCJ4IiwieSIsInJhZCIsInciLCJoIiwicGFkWCIsInBhZFkiLCJ4MSIsIngyIiwieTEiLCJ5MiIsImFkZENvbXBvbmVudCIsImxvZ2ljYWxTcGFjZSIsImxuIiwiYXZhaWxhYmxlV2lkdGgiLCJfcFdpZHRoIiwiYXZhaWxhYmxlSGVpZ2h0IiwiX3BIZWlnaHQiLCJ3aWR0aCIsInBhZGRpbmciLCJwYXJlbnRHcm91cCIsImFkZCIsInJlZiIsInByaW9yaXR5IiwibGF5b3V0IiwiaW5saW5lIiwib3JpZW50YXRpb24iLCJ0eXBlIiwiaG9yaXpvbnRhbCIsInBvc2l0aW9uIiwidG9wIiwiYWxpZ25tZW50IiwibGVmdCIsImRpbWVuc2lvbnMiLCJnZXRQYXJlbnRDb21wb25lbnRHcm91cCIsIl9yZWYiLCJnZXRXaWR0aCIsImdldEhlaWdodCIsIm1lcyIsImJvdW5kRWxlbWVudCIsImJCb3giLCJzZWxlY3RMaW5lIiwic2F2ZVNlbGVjdExpbmUiLCJwYXRoIiwic3Ryb2tlLXdpZHRoIiwidG9Gcm9udCIsImlpIiwiY29tcG9uZW50R3JvdXBzIiwic3ltYm9sTGlzdCIsInN5bWJvbCIsImdldEJvdW5kRWxlbWVudCIsImdldEJCb3giXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxF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QUN0Q0MsRUFBVTNMLFNBQU4yTCxFQUFrQjFELEVBQVkwRCxFQUFJQSxFQUN0Q2lCLEVBQWtCNU0sU0FBVjRNLEVBQXNCM0UsRUFBWTJFLE1BQVFBLEVBQ2xEekMsRUFBb0JuSyxTQUFYbUssRUFBdUJsQyxFQUFZa0MsT0FBU0EsRUFDckRqQixFQUFrQmxKLFNBQVZrSixFQUFzQm5ILEtBQUsrSyxZQUFjNUQsRUFDN0MwRCxHQUFTekMsRUFDWCxJQUFLaEosRUFBSSxFQUFHb0wsRUFBS3ZFLEVBQVM1RyxPQUFRRCxFQUFJb0wsRUFBSXBMLElBQ3hDa0gsRUFBVUwsRUFBUzdHLEdBQ25Ca0gsRUFBUUksS0FBS2lELEVBQUdDLEVBQUd6QyxFQUd2Qm5ILE1BQUtxTSxlQUFpQkQsQ0FDdEIsS0FBSyxHQUFJaE4sR0FBSSxFQUFHcU4sRUFBS3hHLEVBQVMsR0FBR3lHLGdCQUFnQixHQUFHQyxXQUFZdk4sRUFBSXFOLEVBQUdwTixPQUFRRCxJQUN6RXFOLEVBQUdyTixHQUFHd04sU0FBVzVNLEtBQUtnQixZQUN4QmtMLEVBQWVPLEVBQUdyTixHQUFHeU4sa0JBQ3JCVixFQUFPRCxFQUFhWSxVQUNwQjVDLEVBQUtpQyxFQUFLeEMsRUFDVlEsRUFBS2dDLEVBQUtoQyxHQUNWRSxFQUFLOEIsRUFBSzlCLFFBdHNCWTVNLElBK3NCOUIsT0FBT0EiLCJmaWxlIjoic3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUpIHsndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cdFxuXHR2YXIgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR3aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG5cdFxuXHQ7KGZ1bmN0aW9uIChlbnYsIGZhY3RvcnkpIHtcblx0ICBpZiAoKCBmYWxzZSA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihtb2R1bGUpKSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50ID8gZmFjdG9yeShlbnYpIDogZnVuY3Rpb24gKHdpbikge1xuXHQgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuXHQgICAgICAgIHRocm93IG5ldyBFcnJvcignV2luZG93IHdpdGggZG9jdW1lbnQgbm90IHByZXNlbnQnKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuXHQgICAgfTtcblx0ICB9IGVsc2Uge1xuXHQgICAgZW52LlN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG5cdCAgfVxuXHR9KSh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHVuZGVmaW5lZCwgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuXHQgIHZhciBGQyA9IF93aW5kb3cuRnVzaW9uQ2hhcnRzO1xuXHQgIEZDLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3ByaXZhdGUnLCAnU3RhbmRhcmRQZXJpb2RTZWxlY3RvcicsIGZ1bmN0aW9uICgpIHtcblx0ICAgIEZDLnJlZ2lzdGVyQ29tcG9uZW50KCdleHRlbnNpb25zJywgJ1N0YW5kYXJkUGVyaW9kU2VsZWN0b3InLCBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKHsgRnVzaW9uQ2hhcnRzOiBGQyB9KSk7XG5cdCAgfV0pO1xuXHR9KTtcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMSkobW9kdWxlKSkpXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0XHRtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHRcdH1cblx0XHRyZXR1cm4gbW9kdWxlO1xuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdC8qKlxuXHQgKiBDbGFzcyBkZWZpbml0aW9uIG9mIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Jcblx0ICovXG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRlcCkge1xuXHQgIHZhciBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gU3RhbmRhcmRQZXJpb2RTZWxlY3RvcigpIHtcblx0ICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IpO1xuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAqL1xuXHQgICAgICB0aGlzLnJhdGlvID0gODtcblx0ICAgICAgdGhpcy50b29sYm94ID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcblx0ICAgICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcblx0ICAgICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcblx0ICAgICAgdGhpcy5TeW1ib2xTdG9yZSA9IHRoaXMudG9vbGJveC5TeW1ib2xTdG9yZTtcblx0ICAgICAgdGhpcy5hbGwgPSAxO1xuXHQgICAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG5cdCAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcblx0ICAgICAgLy8gdGhpcy5lbmREYXRhc2V0ID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSAwO1xuXHQgICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IDE7XG5cdCAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuXHQgICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuXHQgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gMDtcblx0ICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IDA7XG5cdCAgICAgIHRoaXMuY2xpY2tlZElkID0gJ0FMTCc7XG5cdCAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IDA7XG5cdCAgICAgIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9iaiA9IHt9O1xuXHQgICAgICB0aGlzLnRkQnV0dG9ucyA9IFt7XG5cdCAgICAgICAgJ25hbWUnOiAnWVREJyxcblx0ICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1lURCcsXG5cdCAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcblx0ICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llYXIgdG8gRGF0ZSdcblx0ICAgICAgfSwge1xuXHQgICAgICAgICduYW1lJzogJ1FURCcsXG5cdCAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuXHQgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuXHQgICAgICAgICdtdWx0aXBsaWVyJzogMyxcblx0ICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcblx0ICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuXHQgICAgICB9LCB7XG5cdCAgICAgICAgJ25hbWUnOiAnTVREJyxcblx0ICAgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG5cdCAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG5cdCAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG5cdCAgICAgIH0sIHtcblx0ICAgICAgICAnbmFtZSc6ICdXVEQnLFxuXHQgICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcblx0ICAgICAgICAncGFyZW50JzogJ2RheScsXG5cdCAgICAgICAgJ211bHRpcGxpZXInOiA3LFxuXHQgICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcblx0ICAgICAgfSwge1xuXHQgICAgICAgICduYW1lJzogJ1knLFxuXHQgICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG5cdCAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuXHQgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcblx0ICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVzdGVyZGF5J1xuXHQgICAgICB9LCB7XG5cdCAgICAgICAgJ25hbWUnOiAnVCcsXG5cdCAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcblx0ICAgICAgICAncGFyZW50JzogJ2RheScsXG5cdCAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuXHQgICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcblx0ICAgICAgfV07XG5cdCAgICAgIHRoaXMuY29uZmlnID0ge1xuXHQgICAgICAgIGFuY2hvclBvc2l0aW9uczogJ3JpZ2h0Jyxcblx0ICAgICAgICBhbGw6ICcxJyxcblx0ICAgICAgICBjb250ZXh0dWFsOiAnMScsXG5cdCAgICAgICAgY2FsY3VsYXRlZDogJzEnLFxuXHQgICAgICAgIHRlcnRpYXJ5VGltZVBlcmlvZHM6IHt9XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjYWxjdWxhdGVkIGJ1dHRvbnMgdXNpbmdcblx0ICAgICAqIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgYWN0aXZlIHJhbmdlXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IsIFt7XG5cdCAgICAgIGtleTogJ2dlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpIHtcblx0ICAgICAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuXHQgICAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgICAgaiA9IDAsXG5cdCAgICAgICAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyxcblx0ICAgICAgICAgICAgY291bnQgPSAwO1xuXHQgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuXHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIGFwcGxpY2FibGUgZm9yIHRoZSBjdXJyZW50IHRhcmdldCBibG9ja1xuXHQgICAgICAgICAgaWYgKHRhcmdldEJsb2NrIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCA+PSAxKSB7XG5cdCAgICAgICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgb2YgdGhlIGhpZ2hlciBvcmRlciBhbmQgb25seSBtdWx0aXBsaWVyIDEgaXMgYXBwbGljYWJsZVxuXHQgICAgICAgICAgICBpZiAoTWF0aC5mbG9vcihhY3RpdmVXaW5kb3cgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSA8IDEpIHtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG5cdCAgICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlLFxuXHQgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcblx0ICAgICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuXHQgICAgICAgICAgICAgICAgJ25hbWUnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm5hbWUsXG5cdCAgICAgICAgICAgICAgICAnbXVsdGlwbGllcnMnOiBbMV1cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG5cdCAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuXHQgICAgICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLnNpbmdsZSxcblx0ICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG5cdCAgICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCxcblx0ICAgICAgICAgICAgICAgICduYW1lJzogdGhpcy50aW1lUGVyaW9kc1tpXS5uYW1lLFxuXHQgICAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAvLyBjYWxjdWxhdGluZyBhbmQgcG9wdWxhdGluZyB0aGUgYXBwbGljYWJsZSBtdWx0cGxpZXJzIG9mIGVhY2ggdW5pdFxuXHQgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoYWN0aXZlV2luZG93IC8gdGhpcy5yYXRpbyA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSB7XG5cdCAgICAgICAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1t0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoIC0gMV0ubXVsdGlwbGllcnMucHVzaCh0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gSW5maW5pdHk7XG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuXHQgICAgICAgICAgICArK2NvdW50O1xuXHQgICAgICAgICAgICBpZiAodGhpcy5ub0NhbGNCdXR0b25zID4gaSkge1xuXHQgICAgICAgICAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IGk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgaWYgKGNvdW50IDw9IDQpIHtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gajtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gaTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNvbnRleHR1YWwgYnV0dG9ucyB1c2luZ1xuXHQgICAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG5cdCAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucycsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUNvbnRleHR1YWxCdXR0b25zKCkge1xuXHQgICAgICAgIC8vIGdlbmVyYXRpbmcgYW4gYXJyYXkgd2l0aCBhcHBsaWNhYmxlIFREIGJ1dHRvbnNcblx0ICAgICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuXHQgICAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgICAgZW5kU3RhbXAgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXSxcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0ID0gZW5kU3RhbXAgLSAyLFxuXHQgICAgICAgICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG5cdCAgICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24gPSB7fTtcblx0ICAgICAgICBmb3IgKDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBkYXRlU3RhcnQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG5cdCAgICAgICAgICBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1lURCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKDEpO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1FURCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDExIC0gZGF0ZVN0YXJ0LmdldE1vbnRoKCkgJSA0KTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZShkYXRlU3RhcnQuZ2V0RGF0ZSgpIC0gZGF0ZVN0YXJ0LmdldERheSgpKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZJykge1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnVCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICAgIGlmICgrdGhpcy5lbmREYXRhc2V0ID09PSArZGF0ZVN0YXJ0KSB7XG5cdCAgICAgICAgICAgICAgZGF0ZVN0YXJ0ID0gK2RhdGVTdGFydCAtIDg2NDAwMDAwO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgaWYgKGRhdGVFbmQgPCBkYXRlU3RhcnQpIHtcblx0ICAgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlU3RhcnQgPSBkYXRlU3RhcnQudmFsdWVPZigpO1xuXHQgICAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG5cdCAgICAgICAgICAgIGJ1dHRvbnMucHVzaCh0aGlzLnRkQnV0dG9uc1tpXSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzID0gSW5maW5pdHk7XG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzIC0gKHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdykpIDwgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMpIHtcblx0ICAgICAgICAgICAgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMgPSB0aGlzLnRkQnV0dG9uc1tpXS5taWxsaXNlY29uZHM7XG5cdCAgICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubmFtZSA9IHRoaXMudGRCdXR0b25zW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gYnV0dG9ucztcblx0ICAgICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ29udGV4dHVhbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyk7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAncHJvY2Vzc011bHRpcGxpZXJzJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NNdWx0aXBsaWVycyh0aW1lQXJyKSB7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lQXJyLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICB2YXIgbGVuID0gdGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnMubGVuZ3RoO1xuXHQgICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycyA9IFtdO1xuXHQgICAgICAgICAgaWYgKGxlbiA9PT0gMSkge1xuXHQgICAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbMF0pO1xuXHQgICAgICAgICAgfSBlbHNlIGlmIChsZW4gPT09IDIpIHtcblx0ICAgICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcblx0ICAgICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzW2xlbiAtIDFdKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG5cdCAgICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaChNYXRoLmZsb29yKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzW2xlbiAtIDFdIC8gMikpO1xuXHQgICAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gdGltZUFycjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBhY3RpdmUgcGVyaW9kJ3Ncblx0ICAgICAgICogc3RhcnQgYW5kIGVuZCBwb2ludFxuXHQgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuXHQgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIGFjdGl2ZSBwZXJpb2Rcblx0ICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdzZXRBY3RpdmVQZXJpb2QnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0QWN0aXZlUGVyaW9kKCkge1xuXHQgICAgICAgIHZhciBzdGFydCxcblx0ICAgICAgICAgICAgZW5kLFxuXHQgICAgICAgICAgICB0ZW1wID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xuXHQgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG5cdCAgICAgICAgICBlbmQgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuXHQgICAgICAgICAgc3RhcnQgPSBlbmQgLSBhcmd1bWVudHNbMF07XG5cdCAgICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG5cdCAgICAgICAgICBzdGFydCA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgICAgIGVuZCA9IGFyZ3VtZW50c1sxXTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IHN0YXJ0O1xuXHQgICAgICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gZW5kO1xuXHQgICAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXSA9IHRoaXMuc3RhcnRBY3RpdmVXaW5kb3c7XG5cdCAgICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXSA9IHRoaXMuZW5kQWN0aXZlV2luZG93O1xuXHQgICAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIHN0YXJ0IGFuZCBlbmQgcG9pbnQgb2YgdGhlXG5cdCAgICAgICAqIGVudGlyZSB0aW1lLWxpbmVcblx0ICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIHN0YXJ0IHBvaW50IG9mIHRpbWUtbGluZVxuXHQgICAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIHRpbWUtbGluZVxuXHQgICAgICAgKi9cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBBIGZ1bmN0aW9uIHRvIHNldCB0aGUgb2JqZWN0IHRvIHNldCB0aGUgdXNlciBwcmVmZXJlbmNlc1xuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2NvbmZpZ3VyZScsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XG5cdCAgICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2luaXQnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdChyZXF1aXJlKSB7XG5cdCAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcblx0ICAgICAgICByZXF1aXJlKFsneEF4aXMnLCAneUF4aXMnLCAnZ3JhcGhpY3MnLCAnY2hhcnQnLCAnZGF0YXNldCcsICdQbG90TWFuYWdlcicsICdjYW52YXNDb25maWcnLCAnTWFya2VyTWFuYWdlcicsICdyZWFjdGl2ZU1vZGVsJywgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLCAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLCAnc21hcnRMYWJlbCcsICdleHREYXRhJywgJ2NoYXJ0SW5zdGFuY2UnLCBmdW5jdGlvbiAoeEF4aXMsIHlBeGlzLCBncmFwaGljcywgY2hhcnQsIGRhdGFzZXQsIHBsb3RNYW5hZ2VyLCBjYW52YXNDb25maWcsIG1hcmtlck1hbmFnZXIsIHJlYWN0aXZlTW9kZWwsIGdsb2JhbFJlYWN0aXZlTW9kZWwsIHNwYWNlTWFuYWdlckluc3RhbmNlLCBzbWFydExhYmVsLCBleHREYXRhLCBjaGFydEluc3RhbmNlKSB7XG5cdCAgICAgICAgICBpbnN0YW5jZS54QXhpcyA9IHhBeGlzO1xuXHQgICAgICAgICAgaW5zdGFuY2UueUF4aXMgPSB5QXhpcztcblx0ICAgICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gZ3JhcGhpY3M7XG5cdCAgICAgICAgICBpbnN0YW5jZS5jaGFydCA9IGNoYXJ0O1xuXHQgICAgICAgICAgaW5zdGFuY2UuZGF0YXNldCA9IGRhdGFzZXQ7XG5cdCAgICAgICAgICBpbnN0YW5jZS5wbG90TWFuYWdlciA9IHBsb3RNYW5hZ2VyO1xuXHQgICAgICAgICAgaW5zdGFuY2UubWFya2VyTWFuYWdlciA9IG1hcmtlck1hbmFnZXI7XG5cdCAgICAgICAgICBpbnN0YW5jZS5jYW52YXNDb25maWcgPSBjYW52YXNDb25maWc7XG5cdCAgICAgICAgICBpbnN0YW5jZS5yZWFjdGl2ZU1vZGVsID0gcmVhY3RpdmVNb2RlbDtcblx0ICAgICAgICAgIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBnbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgICAgaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBzcGFjZU1hbmFnZXJJbnN0YW5jZTtcblx0ICAgICAgICAgIGluc3RhbmNlLnNtYXJ0TGFiZWwgPSBzbWFydExhYmVsO1xuXHQgICAgICAgICAgaW5zdGFuY2UuZXh0RGF0YSA9IGV4dERhdGE7XG5cdCAgICAgICAgICBpbnN0YW5jZS5jaGFydEluc3RhbmNlID0gY2hhcnRJbnN0YW5jZTtcblx0ICAgICAgICB9XSk7XG5cdCAgICAgICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG5cdCAgICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcblx0ICAgICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXTtcblx0ICAgICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1zdGFydCddO1xuXHQgICAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcblx0ICAgICAgICAvLyBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWydfeC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXSArPSAxMjQ0MTYwMDAwMDA7XG5cdCAgICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLmNoYXJ0SW5zdGFuY2UuYXBpSW5zdGFuY2UuZ2V0Q29tcG9uZW50U3RvcmUoKTtcblx0ICAgICAgICB0aGlzLnRpbWVSdWxlcyA9IHRoaXMudGltZVJ1bGVzLmdldENhbnZhc0J5SW5kZXgoMCkuY29tcG9zaXRpb24uaW1wbDtcblx0ICAgICAgICB0aGlzLnRpbWVSdWxlcyA9IHRoaXMudGltZVJ1bGVzLmdldERhdGFBZ2dyZWdhdG9yKCk7XG5cdCAgICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLnRpbWVSdWxlcy5nZXRBZ2dyZWdhdGlvblRpbWVSdWxlcygpO1xuXHQgICAgICAgIHRoaXMudGltZVBlcmlvZHMgPSB0aGlzLnByb2Nlc3NNdWx0aXBsaWVycyh0aGlzLnRpbWVSdWxlcyk7XG5cdCAgICAgICAgdGhpcy5zZXRBY3RpdmVQZXJpb2QodGhpcy5zdGFydEFjdGl2ZVdpbmRvdywgdGhpcy5lbmRBY3RpdmVXaW5kb3cpO1xuXHQgICAgICAgIHRoaXMudG9vbGJhcnMgPSBbXTtcblx0ICAgICAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG5cdCAgICAgICAgdGhpcy5mbGFnID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgdGhpcy50b29sYmFycy5wdXNoKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcblx0XG5cdCAgICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm9uUHJvcHNDaGFuZ2UoWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCcsICd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXSwgZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcblx0ICAgICAgICAgIGlmIChpbnN0YW5jZS5mbGFnKSB7XG5cdCAgICAgICAgICAgIGluc3RhbmNlLmZsYWcgPSBmYWxzZTtcblx0ICAgICAgICAgICAgaW5zdGFuY2Uuc2V0QWN0aXZlUGVyaW9kKHN0YXJ0WzFdLCBlbmRbMV0pO1xuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluc3RhbmNlLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluc3RhbmNlLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcblx0ICAgICAgICAgICAgICAgIGlmIChlbmRbMV0gLSBzdGFydFsxXSA+PSBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIGluc3RhbmNlLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSB7XG5cdCAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmNsaWNrZWRJZCA9IGluc3RhbmNlLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgaW5zdGFuY2UudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLnNpbmdsZTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgaW5zdGFuY2UudG9vbGJhci5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgIGluc3RhbmNlLnRvb2xiYXJzLnBvcCgpO1xuXHQgICAgICAgICAgICBpbnN0YW5jZS50b29sYmFycy5wdXNoKGluc3RhbmNlLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdCAgICAgICAgICAgIGluc3RhbmNlLmdldExvZ2ljYWxTcGFjZSgpO1xuXHQgICAgICAgICAgICBpbnN0YW5jZS5kcmF3KCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnY3JlYXRlVG9vbGJhcicsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVUb29sYmFyKCkge1xuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgIHZhciB1bmlncm91cCxcblx0ICAgICAgICAgICAgdG9vbGJhcixcblx0ICAgICAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMsXG5cdCAgICAgICAgICAgIGNvbnRleHR1YWxCdXR0b25zLFxuXHQgICAgICAgICAgICBhbGxCdXR0b24sXG5cdCAgICAgICAgICAgIHNlbGYgPSB0aGlzLFxuXHQgICAgICAgICAgICBkZWR1Y3RvckFyID0gW10sXG5cdCAgICAgICAgICAgIHN0YXJ0TXVsdGlwbGllcixcblx0ICAgICAgICAgICAgZGVkdWN0b3IsXG5cdCAgICAgICAgICAgIGksXG5cdCAgICAgICAgICAgIGosXG5cdCAgICAgICAgICAgIG1hcmdpbixcblx0ICAgICAgICAgICAgZnJvbURhdGVMYWJlbCxcblx0ICAgICAgICAgICAgZ3JvdXA7XG5cdFxuXHQgICAgICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG5cdCAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcblx0ICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHVuaWdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5VbmlTZWxlY3RDb21wb25lbnRHcm91cCh7XG5cdCAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcblx0ICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdW5pZ3JvdXAuc2V0Q29uZmlnKHtcblx0ICAgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGdyb3VwLnNldENvbmZpZyh7XG5cdCAgICAgICAgICBmaWxsOiAnI2ZmZicsXG5cdCAgICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0b29sYmFyID0gbmV3IHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIoe1xuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRvb2xiYXIuc2V0Q29uZmlnKHtcblx0ICAgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGZyb21EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdab29tOicsIHtcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgdGV4dDoge1xuXHQgICAgICAgICAgICBzdHlsZToge1xuXHQgICAgICAgICAgICAgICdmb250LWZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG5cdCAgICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxMycsXG5cdCAgICAgICAgICAgICAgJ2ZpbGwnOiAnIzY5Njk2OScsXG5cdCAgICAgICAgICAgICAgJ2ZvbnQtd2VpZ2h0JzogJ2JvbGQnXG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBjb250YWluZXI6IHtcblx0ICAgICAgICAgICAgaGVpZ2h0OiAyMlxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZUxhYmVsKTtcblx0ICAgICAgICBhbGxCdXR0b24gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCgnQUxMJywgdHJ1ZSwge1xuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcblx0ICAgICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuXHQgICAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcblx0ICAgICAgICAgIHN0cm9rZTogJyNjZWQ1ZDQnLFxuXHQgICAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcblx0ICAgICAgICAgIGhvdmVyRmlsbDogJyNjZWQ1ZDQnLFxuXHQgICAgICAgICAgaGVpZ2h0OiAyMixcblx0ICAgICAgICAgIHJhZGl1czogMSxcblx0ICAgICAgICAgIG1hcmdpbjoge1xuXHQgICAgICAgICAgICByaWdodDogNVxuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuXHQgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG5cdCAgICAgICAgICAgICdmb250U2l6ZSc6ICcxMycsXG5cdCAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuXHQgICAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG5cdCAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZyc6ICctMC4wNGVtJ1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKCkge1xuXHQgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YXJ0RGF0YXNldCwgc2VsZi5lbmREYXRhc2V0KTtcblx0ICAgICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gJ0FMTCc7XG5cdCAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG5cdCAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdCAgICAgICAgICAgIC8vIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG5cdCAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuXHQgICAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICB0b29sdGV4dDogJ0FMTCdcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGFsbEJ1dHRvbik7XG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgZm9yIChqID0gdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG5cdCAgICAgICAgICAgIGRlZHVjdG9yQXIucHVzaChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zID0ge307XG5cdCAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9iaikge1xuXHQgICAgICAgICAgdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleV0uaGlkZSgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoX2kpIHtcblx0ICAgICAgICAgIGlmIChfaSA9PT0gc2VsZi5zdGFydFBvaW50VW5pdCkge1xuXHQgICAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YXJ0UG9pbnRNdWx0aXBsaWVyO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgc3RhcnRNdWx0aXBsaWVyID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHZhciBfbG9vcDMgPSBmdW5jdGlvbiBfbG9vcDMoX2opIHtcblx0ICAgICAgICAgICAgbWFyZ2luID0gX2kgPT09IHNlbGYubm9DYWxjQnV0dG9ucyAmJiBfaiA9PT0gMCA/IDUgOiAwO1xuXHQgICAgICAgICAgICB2YXIga2V5QWJiID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5tdWx0aXBsaWVyc1tfal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAgICAgaWYgKF90aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSBuZXcgX3RoaXMudG9vbGJveC5TeW1ib2woa2V5QWJiLCB0cnVlLCB7XG5cdCAgICAgICAgICAgICAgICBwYXBlcjogX3RoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICAgICAgICBjaGFydDogX3RoaXMuY2hhcnQsXG5cdCAgICAgICAgICAgICAgICBzbWFydExhYmVsOiBfdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgICAgICAgY2hhcnRDb250YWluZXI6IF90aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgICAgICAgIH0sIHtcblx0ICAgICAgICAgICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcblx0ICAgICAgICAgICAgICAgIGxhYmVsRmlsbDogJyM2OTY5NjknLFxuXHQgICAgICAgICAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcblx0ICAgICAgICAgICAgICAgIHN0cm9rZTogJyNjZWQ1ZDQnLFxuXHQgICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6ICcxJyxcblx0ICAgICAgICAgICAgICAgIGhvdmVyRmlsbDogJyNjZWQ1ZDQnLFxuXHQgICAgICAgICAgICAgICAgaGVpZ2h0OiAyMixcblx0ICAgICAgICAgICAgICAgIHJhZGl1czogMSxcblx0ICAgICAgICAgICAgICAgIG1hcmdpbjoge1xuXHQgICAgICAgICAgICAgICAgICByaWdodDogMFxuXHQgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuXHQgICAgICAgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG5cdCAgICAgICAgICAgICAgICAgICdmb250U2l6ZSc6ICcxMycsXG5cdCAgICAgICAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuXHQgICAgICAgICAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG5cdCAgICAgICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZyc6ICctMC4wNGVtJ1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gY2xpY2soKSB7XG5cdCAgICAgICAgICAgICAgICAgIGRlZHVjdG9yID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5tdWx0aXBsaWVyc1tfal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLm1pbGxpc2Vjb25kcztcblx0ICAgICAgICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLm11bHRpcGxpZXJzW19qXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tfaV0uYWJicmV2aWF0aW9uO1xuXHQgICAgICAgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChkZWR1Y3Rvcik7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHRvb2xiYXIuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuXHQgICAgICAgICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuXHQgICAgICAgICAgICAgICAgICAvLyBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuXHQgICAgICAgICAgICAgICAgICAvLyBzZWxmLmRyYXcoKTtcblx0ICAgICAgICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHRoaXMudG9vbGJhcnNbdGhpcy50b29sYmFycy5sZW5ndGggLSAxXSA9IHRoaXMuY3JlYXRlVG9vbGJhcigpO1xuXHQgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgIHRvb2x0ZXh0OiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLm11bHRpcGxpZXJzW19qXSArICcgJyArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tfaV0uZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICBfdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0gPSBjYWxjdWxhdGVkQnV0dG9ucztcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAvLyB1bmlncm91cC5hZGRTeW1ib2woY2FsY3VsYXRlZEJ1dHRvbnNbaV0pO1xuXHQgICAgICAgICAgICBfdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0uc2hvdygpO1xuXHQgICAgICAgICAgICB1bmlncm91cC5hZGRTeW1ib2woX3RoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdKTtcblx0ICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgZm9yICh2YXIgX2ogPSBzdGFydE11bHRpcGxpZXI7IF9qID49IDA7IF9qLS0pIHtcblx0ICAgICAgICAgICAgX2xvb3AzKF9qKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IHNlbGYuc3RhcnRQb2ludFVuaXQ7IF9pID49IDA7IF9pLS0pIHtcblx0ICAgICAgICAgIF9sb29wKF9pKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIGZvciAobGV0IGkgPSBzZWxmLnN0YXJ0UG9pbnRVbml0OyBpID49IDA7IGktLSkge1xuXHQgICAgICAgIC8vICAgZm9yIChsZXQgaiA9IHN0YXJ0TXVsdGlwbGllcjsgaiA+PSAwOyBqLS0pIHtcblx0ICAgICAgICAvLyAgICAgbGV0IGtleUFiYiA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG5cdCAgICAgICAgLy8gICAgIHVuaWdyb3VwLmFkZFN5bWJvbCh0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSk7XG5cdCAgICAgICAgLy8gICB9XG5cdCAgICAgICAgLy8gfVxuXHRcblx0ICAgICAgICBjb250ZXh0dWFsQnV0dG9ucyA9IFtdO1xuXHRcblx0ICAgICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKF9pMikge1xuXHQgICAgICAgICAgY29udGV4dHVhbEJ1dHRvbnNbX2kyXSA9IG5ldyBfdGhpcy50b29sYm94LlN5bWJvbChfdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbX2kyXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcblx0ICAgICAgICAgICAgcGFwZXI6IF90aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgICBjaGFydDogX3RoaXMuY2hhcnQsXG5cdCAgICAgICAgICAgIHNtYXJ0TGFiZWw6IF90aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiBfdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICAgIH0sIHtcblx0ICAgICAgICAgICAgZmlsbDogJyNmZmZmZmYnLFxuXHQgICAgICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5Jyxcblx0ICAgICAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcblx0ICAgICAgICAgICAgc3Ryb2tlOiAnI2NlZDVkNCcsXG5cdCAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG5cdCAgICAgICAgICAgIGhlaWdodDogMjIsXG5cdCAgICAgICAgICAgIGhvdmVyRmlsbDogJyNjZWQ1ZDQnLFxuXHQgICAgICAgICAgICByYWRpdXM6IDEsXG5cdCAgICAgICAgICAgIG1hcmdpbjoge1xuXHQgICAgICAgICAgICAgIHJpZ2h0OiAwXG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGJ0blRleHRTdHlsZToge1xuXHQgICAgICAgICAgICAgICdmb250RmFtaWx5JzogJ1wiTHVjaWRhIEdyYW5kZVwiLCBzYW5zLXNlcmlmJyxcblx0ICAgICAgICAgICAgICAnZm9udFNpemUnOiAnMTMnLFxuXHQgICAgICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuXHQgICAgICAgICAgICAgICdsaW5lLWhlaWdodCc6ICcxJyxcblx0ICAgICAgICAgICAgICAnbGV0dGVyLXNwYWNpbmcnOiAnLTAuMDRlbSdcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG5cdCAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uIGNsaWNrKCkge1xuXHQgICAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW19pMl0uZGF0ZVN0YXJ0LCBzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tfaTJdLmRhdGVFbmQpO1xuXHQgICAgICAgICAgICAgIHNlbGYuY2xpY2tlZElkID0gc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbX2kyXS5hYmJyZXZpYXRpb247XG5cdCAgICAgICAgICAgICAgLy8gdG9vbGJhci5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wb3AoKTtcblx0ICAgICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuXHQgICAgICAgICAgICAgIC8vIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG5cdCAgICAgICAgICAgICAgLy8gc2VsZi5kcmF3KCk7XG5cdCAgICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIHRvb2x0ZXh0OiBfdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbX2kyXS5kZXNjcmlwdGlvblxuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB1bmlncm91cC5hZGRTeW1ib2woY29udGV4dHVhbEJ1dHRvbnNbX2kyXSk7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHMubGVuZ3RoOyBfaTIrKykge1xuXHQgICAgICAgICAgX2xvb3AyKF9pMik7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLlN5bWJvbFN0b3JlLnJlZ2lzdGVyKCd0ZXh0Qm94SWNvbicsIGZ1bmN0aW9uICh4LCB5LCByYWQsIHcsIGgsIHBhZFgsIHBhZFkpIHtcblx0ICAgICAgICAgIHZhciB4MSA9IHggLSB3IC8gMiArIHBhZFggLyAyLFxuXHQgICAgICAgICAgICAgIHgyID0geCArIHcgLyAyIC0gcGFkWCAvIDIsXG5cdCAgICAgICAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcblx0ICAgICAgICAgICAgICB5MiA9IHkgKyBoIC8gMiAtIHBhZFkgLyAyO1xuXHRcblx0ICAgICAgICAgIHJldHVybiBbJ00nLCB4MSwgeTEsICdMJywgeDIsIHkxLCAnTCcsIHgyLCB5MiwgJ0wnLCB4MSwgeTIsICdaJ107XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KGdyb3VwKTtcblx0ICAgICAgICB0b29sYmFyLmFkZENvbXBvbmVudCh1bmlncm91cCk7XG5cdCAgICAgICAgdGhpcy50b29sYmFyID0gdG9vbGJhcjtcblx0ICAgICAgICByZXR1cm4gdG9vbGJhcjtcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdnZXRMb2dpY2FsU3BhY2UnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9naWNhbFNwYWNlKCkge1xuXHQgICAgICAgIHZhciBhdmFpbGFibGVXaWR0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogdGhpcy5fcFdpZHRoO1xuXHQgICAgICAgIHZhciBhdmFpbGFibGVIZWlnaHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMuX3BIZWlnaHQ7XG5cdFxuXHQgICAgICAgIC8vIGF2YWlsYWJsZVdpZHRoIC89IDI7XG5cdCAgICAgICAgdmFyIGxvZ2ljYWxTcGFjZSxcblx0ICAgICAgICAgICAgd2lkdGggPSA0MjAsXG5cdCAgICAgICAgICAgIC8vIHdpZHRoIGhhcmRjb2RlZDsgVE9ETzogbWFrZSBpdCBkeW5hbWljXG5cdCAgICAgICAgaGVpZ2h0ID0gMCxcblx0ICAgICAgICAgICAgaSxcblx0ICAgICAgICAgICAgbG47XG5cdFxuXHQgICAgICAgIGZvciAoaSA9IDAsIGxuID0gdGhpcy50b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG5cdCAgICAgICAgICBsb2dpY2FsU3BhY2UgPSB0aGlzLnRvb2xiYXJzW2ldLmdldExvZ2ljYWxTcGFjZShhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KTtcblx0ICAgICAgICAgIC8vIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG5cdCAgICAgICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgICAgIHRoaXMudG9vbGJhcnNbaV0ud2lkdGggPSBsb2dpY2FsU3BhY2Uud2lkdGg7XG5cdCAgICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGhlaWdodCArPSB0aGlzLnBhZGRpbmc7XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgIHdpZHRoOiB3aWR0aCxcblx0ICAgICAgICAgIGhlaWdodDogaGVpZ2h0XG5cdCAgICAgICAgfTtcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdnZXREZWZhdWx0R3JvdXAnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVmYXVsdEdyb3VwKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnBhcmVudEdyb3VwO1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ3BsYWNlSW5DYW52YXMnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gcGxhY2VJbkNhbnZhcygpIHtcblx0ICAgICAgICB2YXIgX3NlbGYgPSB0aGlzO1xuXHQgICAgICAgIF9zZWxmLnBhZGRpbmcgPSA1O1xuXHQgICAgICAgIF9zZWxmLnNwYWNlTWFuYWdlckluc3RhbmNlLmFkZChbe1xuXHQgICAgICAgICAgbmFtZTogZnVuY3Rpb24gbmFtZSgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuICdzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3ItZXh0Jztcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihvYmopIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG9ialsnMCddO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIHNlbGY6IGZ1bmN0aW9uIHNlbGYoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBfc2VsZjtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBwcmlvcml0eTogZnVuY3Rpb24gcHJpb3JpdHkoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiAyO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGxheW91dDogZnVuY3Rpb24gbGF5b3V0KG9iaikge1xuXHQgICAgICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBvcmllbnRhdGlvbjogW3tcblx0ICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gb2JqLmhvcml6b250YWw7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIHBvc2l0aW9uOiBbe1xuXHQgICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIHR5cGUob2JqKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gb2JqLnRvcDtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGFsaWdubWVudDogW3tcblx0ICAgICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIHR5cGUob2JqKSB7XG5cdCAgICAgICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcblx0ICAgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgICBkaW1lbnNpb25zOiBbZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuXHQgICAgICAgICAgICAgICAgICBfc2VsZi5fcmVmID0gdGhpcztcblx0ICAgICAgICAgICAgICAgICAgcmV0dXJuIF9zZWxmLmdldExvZ2ljYWxTcGFjZShfc2VsZi5fcFdpZHRoID0gcGFyZW50LmdldFdpZHRoKCksIF9zZWxmLl9wSGVpZ2h0ID0gcGFyZW50LmdldEhlaWdodCgpKTtcblx0ICAgICAgICAgICAgICAgIH1dXG5cdCAgICAgICAgICAgICAgfV1cblx0ICAgICAgICAgICAgfV1cblx0ICAgICAgICAgIH1dXG5cdCAgICAgICAgfV0pO1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ3NldERyYXdpbmdDb25maWd1cmF0aW9uJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldERyYXdpbmdDb25maWd1cmF0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG5cdCAgICAgICAgbWVzLnggPSB4O1xuXHQgICAgICAgIG1lcy55ID0geTtcblx0ICAgICAgICBtZXMud2lkdGggPSB3aWR0aDtcblx0ICAgICAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcblx0ICAgICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cdFxuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2RyYXcnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdyh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuXHQgICAgICAgIHZhciBtZWFzdXJlbWVudCA9IHRoaXMubWVhc3VyZW1lbnQsXG5cdCAgICAgICAgICAgIHRvb2xiYXJzID0gdGhpcy50b29sYmFycyxcblx0ICAgICAgICAgICAgc2VsZiA9IHRoaXMsXG5cdCAgICAgICAgICAgIGxuLFxuXHQgICAgICAgICAgICBpLFxuXHQgICAgICAgICAgICB0b29sYmFyLFxuXHQgICAgICAgICAgICBib3VuZEVsZW1lbnQsXG5cdCAgICAgICAgICAgIGJCb3gsXG5cdCAgICAgICAgICAgIHgxLFxuXHQgICAgICAgICAgICB4Mixcblx0ICAgICAgICAgICAgeTIsXG5cdCAgICAgICAgICAgIHNlbGVjdExpbmUsXG5cdCAgICAgICAgICAgIG1vZGVsID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHRcblx0ICAgICAgICB0aGlzLmZsYWcgPSB0cnVlO1xuXHQgICAgICAgIHNlbGVjdExpbmUgPSB0aGlzLnNhdmVTZWxlY3RMaW5lIHx8IHRoaXMuZ3JhcGhpY3MucGFwZXIucGF0aCh7XG5cdCAgICAgICAgICAnc3Ryb2tlJzogJyNjOTVhNWEnLFxuXHQgICAgICAgICAgJ3N0cm9rZS13aWR0aCc6ICcycHgnXG5cdCAgICAgICAgfSkudG9Gcm9udCgpO1xuXHQgICAgICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcblx0ICAgICAgICB5ID0geSA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueSA6IHk7XG5cdCAgICAgICAgd2lkdGggPSB3aWR0aCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQud2lkdGggOiB3aWR0aDtcblx0ICAgICAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcblx0ICAgICAgICBncm91cCA9IGdyb3VwID09PSB1bmRlZmluZWQgPyB0aGlzLnBhcmVudEdyb3VwIDogZ3JvdXA7XG5cdCAgICAgICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuXHQgICAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIHRvb2xiYXIgPSB0b29sYmFyc1tpXTtcblx0ICAgICAgICAgICAgdG9vbGJhci5kcmF3KHgsIHksIGdyb3VwKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5zYXZlU2VsZWN0TGluZSA9IHNlbGVjdExpbmU7XG5cdCAgICAgICAgZm9yICh2YXIgX2kzID0gMCwgaWkgPSB0b29sYmFyc1swXS5jb21wb25lbnRHcm91cHNbMV0uc3ltYm9sTGlzdDsgX2kzIDwgaWkubGVuZ3RoOyBfaTMrKykge1xuXHQgICAgICAgICAgaWYgKGlpW19pM10uc3ltYm9sID09PSB0aGlzLmNsaWNrZWRJZCkge1xuXHQgICAgICAgICAgICBib3VuZEVsZW1lbnQgPSBpaVtfaTNdLmdldEJvdW5kRWxlbWVudCgpO1xuXHQgICAgICAgICAgICBiQm94ID0gYm91bmRFbGVtZW50LmdldEJCb3goKTtcblx0ICAgICAgICAgICAgeDEgPSBiQm94Lng7XG5cdCAgICAgICAgICAgIHgyID0gYkJveC54Mjtcblx0ICAgICAgICAgICAgeTIgPSBiQm94LnkyO1xuXHRcblx0ICAgICAgICAgICAgLy8gc2VsZWN0TGluZS5hdHRyKHtcblx0ICAgICAgICAgICAgLy8gICBwYXRoOiBbJ00nLCB4MSAtIDAuNSwgeTIgLSAwLjUsICdMJywgeDIgKyAwLjUsIHkyIC0gMC41XVxuXHQgICAgICAgICAgICAvLyB9KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcblx0ICB9KCk7XG5cdFxuXHQgIHJldHVybiBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yO1xuXHR9O1xuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAzOGRiNjhkY2FhNjZhOGZiOWQ0YiIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSByZXF1aXJlKCcuL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3RvcicpO1xuXG53aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG5cbjsoZnVuY3Rpb24gKGVudiwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGVudi5kb2N1bWVudFxuICAgICAgID8gZmFjdG9yeShlbnYpIDogZnVuY3Rpb24gKHdpbikge1xuICAgICAgICAgaWYgKCF3aW4uZG9jdW1lbnQpIHtcbiAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaW5kb3cgd2l0aCBkb2N1bWVudCBub3QgcHJlc2VudCcpO1xuICAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIGZhY3Rvcnkod2luLCB0cnVlKTtcbiAgICAgICB9O1xuICB9IGVsc2Uge1xuICAgIGVudi5TdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gZmFjdG9yeShlbnYsIHRydWUpO1xuICB9XG59KSh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uIChfd2luZG93LCB3aW5kb3dFeGlzdHMpIHtcbiAgdmFyIEZDID0gX3dpbmRvdy5GdXNpb25DaGFydHM7XG4gIEZDLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3ByaXZhdGUnLCAnU3RhbmRhcmRQZXJpb2RTZWxlY3RvcicsIGZ1bmN0aW9uICgpIHtcbiAgICBGQy5yZWdpc3RlckNvbXBvbmVudCgnZXh0ZW5zaW9ucycsICdTdGFuZGFyZFBlcmlvZFNlbGVjdG9yJywgU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcih7RnVzaW9uQ2hhcnRzOiBGQ30pKTtcbiAgfV0pO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHR9XG5cdHJldHVybiBtb2R1bGU7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENsYXNzIGRlZmluaXRpb24gb2YgU3RhbmRhcmRQZXJpb2RTZWxlY3RvclxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRlcCkge1xuICBjbGFzcyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yIHtcbiAgICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgICAvKipcbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKi9cbiAgICAgIHRoaXMucmF0aW8gPSA4O1xuICAgICAgdGhpcy50b29sYm94ID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcbiAgICAgIHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIgPSB0aGlzLnRvb2xib3guSG9yaXpvbnRhbFRvb2xiYXI7XG4gICAgICB0aGlzLkNvbXBvbmVudEdyb3VwID0gdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwO1xuICAgICAgdGhpcy5TeW1ib2xTdG9yZSA9IHRoaXMudG9vbGJveC5TeW1ib2xTdG9yZTtcbiAgICAgIHRoaXMuYWxsID0gMTtcbiAgICAgIHRoaXMuY2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcbiAgICAgIC8vIHRoaXMuZW5kRGF0YXNldCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IDA7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IDE7XG4gICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gMDtcbiAgICAgIHRoaXMuc3RhcnRQb2ludE11bHRpcGxpZXIgPSAwO1xuICAgICAgdGhpcy5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IDA7XG4gICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmogPSB7fTtcbiAgICAgIHRoaXMudGRCdXR0b25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnWVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1lURCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llYXIgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1FURCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAgICdtdWx0aXBsaWVyJzogMyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnTVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdXVEQnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ211bHRpcGxpZXInOiA3LFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1knLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVzdGVyZGF5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnVCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcbiAgICAgICAgfVxuICAgICAgXTtcbiAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICBhbmNob3JQb3NpdGlvbnM6ICdyaWdodCcsXG4gICAgICAgIGFsbDogJzEnLFxuICAgICAgICBjb250ZXh0dWFsOiAnMScsXG4gICAgICAgIGNhbGN1bGF0ZWQ6ICcxJyxcbiAgICAgICAgdGVydGlhcnlUaW1lUGVyaW9kczoge31cbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY2FsY3VsYXRlZCBidXR0b25zIHVzaW5nXG4gICAgICogdGhlIGFjdGl2ZSByYW5nZSBhbmQgdGhlIGxvY2F0aW9uIG9mIHRoZSBhY3RpdmUgcmFuZ2VcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zICgpIHtcbiAgICAgIHZhciB0YXJnZXRCbG9jayA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydERhdGFzZXQsXG4gICAgICAgIGkgPSAwLFxuICAgICAgICBqID0gMCxcbiAgICAgICAgYWN0aXZlV2luZG93ID0gdGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93LFxuICAgICAgICBjb3VudCA9IDA7XG4gICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgYXBwbGljYWJsZSBmb3IgdGhlIGN1cnJlbnQgdGFyZ2V0IGJsb2NrXG4gICAgICAgIGlmICh0YXJnZXRCbG9jayAvIHRoaXMudGltZVBlcmlvZHNbaV0uaW50ZXJ2YWwgPj0gMSkge1xuICAgICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgb2YgdGhlIGhpZ2hlciBvcmRlciBhbmQgb25seSBtdWx0aXBsaWVyIDEgaXMgYXBwbGljYWJsZVxuICAgICAgICAgIGlmIChNYXRoLmZsb29yKChhY3RpdmVXaW5kb3cpIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCkgPCAxKSB7XG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGUsXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogWzFdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgeyAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGUsXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyB0aGlzLnJhdGlvIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHRoaXMudGltZVBlcmlvZHNbaV0uaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aCAtIDFdLm11bHRpcGxpZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgICB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBJbmZpbml0eTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICsrY291bnQ7XG4gICAgICAgICAgaWYgKHRoaXMubm9DYWxjQnV0dG9ucyA+IGkpIHtcbiAgICAgICAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IGk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3VudCA8PSA0KSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gajtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRQb2ludFVuaXQgPSBpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ2FsY3VsYXRlZCh0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNvbnRleHR1YWwgYnV0dG9ucyB1c2luZ1xuICAgICAqIHRoZSBlbmQgcG9pbnQgb2YgdGhlIHRpbWUtc2NhbGVcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUNvbnRleHR1YWxCdXR0b25zICgpIHtcbiAgICAgIC8vIGdlbmVyYXRpbmcgYW4gYXJyYXkgd2l0aCBhcHBsaWNhYmxlIFREIGJ1dHRvbnNcbiAgICAgIHZhciBidXR0b25zID0gW10sXG4gICAgICAgIGkgPSAwLFxuICAgICAgICBlbmRTdGFtcCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddLFxuICAgICAgICBkYXRlU3RhcnQgPSBlbmRTdGFtcCAtIDIsXG4gICAgICAgIGRhdGVFbmQgPSBlbmRTdGFtcCxcbiAgICAgICAgcmVsYXRpdmVUREJ1dHRvbiA9IHt9O1xuICAgICAgZm9yICg7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkYXRlU3RhcnQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG4gICAgICAgIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnWVREJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ01URCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1FURCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMTEgLSAoZGF0ZVN0YXJ0LmdldE1vbnRoKCkgJSA0KSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdXVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoZGF0ZVN0YXJ0LmdldERhdGUoKSAtIGRhdGVTdGFydC5nZXREYXkoKSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQgLT0gODY0MDAwMDA7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1QnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICAgIGlmICgrdGhpcy5lbmREYXRhc2V0ID09PSArZGF0ZVN0YXJ0KSB7XG4gICAgICAgICAgICBkYXRlU3RhcnQgPSArZGF0ZVN0YXJ0IC0gODY0MDAwMDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGVFbmQgPCBkYXRlU3RhcnQpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlU3RhcnQgPSBkYXRlU3RhcnQudmFsdWVPZigpO1xuICAgICAgICAgIHRoaXMudGRCdXR0b25zW2ldLmRhdGVFbmQgPSBkYXRlRW5kLnZhbHVlT2YoKTtcbiAgICAgICAgICBidXR0b25zLnB1c2godGhpcy50ZEJ1dHRvbnNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IEluZmluaXR5O1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnRkQnV0dG9uc1tpXS5taWxsaXNlY29uZHMgLSAodGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93KSkgPCByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcykge1xuICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzID0gdGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzO1xuICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubmFtZSA9IHRoaXMudGRCdXR0b25zW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IGJ1dHRvbnM7XG4gICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ29udGV4dHVhbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyk7XG4gICAgfVxuXG4gICAgcHJvY2Vzc011bHRpcGxpZXJzICh0aW1lQXJyKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbWVBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGxlbiA9IHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzLmxlbmd0aDtcbiAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycyA9IFtdO1xuICAgICAgICBpZiAobGVuID09PSAxKSB7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW4gPT09IDIpIHtcbiAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbMF0pO1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1tsZW4gLSAxXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcbiAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2goTWF0aC5mbG9vcih0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1tsZW4gLSAxXSAvIDIpKTtcbiAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGltZUFycjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRvIHNldCB0aGUgYWN0aXZlIHBlcmlvZCdzXG4gICAgICogc3RhcnQgYW5kIGVuZCBwb2ludFxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG4gICAgICovXG4gICAgc2V0QWN0aXZlUGVyaW9kICgpIHtcbiAgICAgIHZhciBzdGFydCxcbiAgICAgICAgZW5kLFxuICAgICAgICB0ZW1wID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgZW5kID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcbiAgICAgICAgc3RhcnQgPSBlbmQgLSBhcmd1bWVudHNbMF07XG4gICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgc3RhcnQgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIGVuZCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSBzdGFydDtcbiAgICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gZW5kO1xuICAgICAgdGhpcy5nZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zKCk7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93O1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXSA9IHRoaXMuZW5kQWN0aXZlV2luZG93O1xuICAgICAgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxCdXR0b25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIHN0YXJ0IGFuZCBlbmQgcG9pbnQgb2YgdGhlXG4gICAgICogZW50aXJlIHRpbWUtbGluZVxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIHRpbWUtbGluZVxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIG9iamVjdCB0byBzZXQgdGhlIHVzZXIgcHJlZmVyZW5jZXNcbiAgICAgKi9cbiAgICBjb25maWd1cmUgKGNvbmZpZykge1xuICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnVzaW9uY2hhcnRzIGxpZmUgY3ljbGUgbWV0aG9kIGZvciBleHRlbnNpb25cbiAgICAgKi9cbiAgICBpbml0IChyZXF1aXJlKSB7XG4gICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgcmVxdWlyZShbXG4gICAgICAgICd4QXhpcycsXG4gICAgICAgICd5QXhpcycsXG4gICAgICAgICdncmFwaGljcycsXG4gICAgICAgICdjaGFydCcsXG4gICAgICAgICdkYXRhc2V0JyxcbiAgICAgICAgJ1Bsb3RNYW5hZ2VyJyxcbiAgICAgICAgJ2NhbnZhc0NvbmZpZycsXG4gICAgICAgICdNYXJrZXJNYW5hZ2VyJyxcbiAgICAgICAgJ3JlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnZ2xvYmFsUmVhY3RpdmVNb2RlbCcsXG4gICAgICAgICdzcGFjZU1hbmFnZXJJbnN0YW5jZScsXG4gICAgICAgICdzbWFydExhYmVsJyxcbiAgICAgICAgJ2V4dERhdGEnLFxuICAgICAgICAnY2hhcnRJbnN0YW5jZScsXG4gICAgICAgIGZ1bmN0aW9uIChcbiAgICAgICAgICAgICAgeEF4aXMsXG4gICAgICAgICAgICAgIHlBeGlzLFxuICAgICAgICAgICAgICBncmFwaGljcyxcbiAgICAgICAgICAgICAgY2hhcnQsXG4gICAgICAgICAgICAgIGRhdGFzZXQsXG4gICAgICAgICAgICAgIHBsb3RNYW5hZ2VyLFxuICAgICAgICAgICAgICBjYW52YXNDb25maWcsXG4gICAgICAgICAgICAgIG1hcmtlck1hbmFnZXIsXG4gICAgICAgICAgICAgIHJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICAgIGdsb2JhbFJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICAgIHNwYWNlTWFuYWdlckluc3RhbmNlLFxuICAgICAgICAgICAgICBzbWFydExhYmVsLFxuICAgICAgICAgICAgICBleHREYXRhLFxuICAgICAgICAgICAgICBjaGFydEluc3RhbmNlKSB7XG4gICAgICAgICAgaW5zdGFuY2UueEF4aXMgPSB4QXhpcztcbiAgICAgICAgICBpbnN0YW5jZS55QXhpcyA9IHlBeGlzO1xuICAgICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gZ3JhcGhpY3M7XG4gICAgICAgICAgaW5zdGFuY2UuY2hhcnQgPSBjaGFydDtcbiAgICAgICAgICBpbnN0YW5jZS5kYXRhc2V0ID0gZGF0YXNldDtcbiAgICAgICAgICBpbnN0YW5jZS5wbG90TWFuYWdlciA9IHBsb3RNYW5hZ2VyO1xuICAgICAgICAgIGluc3RhbmNlLm1hcmtlck1hbmFnZXIgPSBtYXJrZXJNYW5hZ2VyO1xuICAgICAgICAgIGluc3RhbmNlLmNhbnZhc0NvbmZpZyA9IGNhbnZhc0NvbmZpZztcbiAgICAgICAgICBpbnN0YW5jZS5yZWFjdGl2ZU1vZGVsID0gcmVhY3RpdmVNb2RlbDtcbiAgICAgICAgICBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gZ2xvYmFsUmVhY3RpdmVNb2RlbDtcbiAgICAgICAgICBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IHNwYWNlTWFuYWdlckluc3RhbmNlO1xuICAgICAgICAgIGluc3RhbmNlLnNtYXJ0TGFiZWwgPSBzbWFydExhYmVsO1xuICAgICAgICAgIGluc3RhbmNlLmV4dERhdGEgPSBleHREYXRhO1xuICAgICAgICAgIGluc3RhbmNlLmNoYXJ0SW5zdGFuY2UgPSBjaGFydEluc3RhbmNlO1xuICAgICAgICB9XG4gICAgICBdKTtcbiAgICAgIHRoaXMuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG4gICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5lbmREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgICAgLy8gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsnX3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gKz0gMTI0NDE2MDAwMDAwO1xuICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLmNoYXJ0SW5zdGFuY2UuYXBpSW5zdGFuY2UuZ2V0Q29tcG9uZW50U3RvcmUoKTtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0Q2FudmFzQnlJbmRleCgwKS5jb21wb3NpdGlvbi5pbXBsO1xuICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLnRpbWVSdWxlcy5nZXREYXRhQWdncmVnYXRvcigpO1xuICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLnRpbWVSdWxlcy5nZXRBZ2dyZWdhdGlvblRpbWVSdWxlcygpO1xuICAgICAgdGhpcy50aW1lUGVyaW9kcyA9IHRoaXMucHJvY2Vzc011bHRpcGxpZXJzKHRoaXMudGltZVJ1bGVzKTtcbiAgICAgIHRoaXMuc2V0QWN0aXZlUGVyaW9kKHRoaXMuc3RhcnRBY3RpdmVXaW5kb3csIHRoaXMuZW5kQWN0aXZlV2luZG93KTtcbiAgICAgIHRoaXMudG9vbGJhcnMgPSBbXTtcbiAgICAgIHRoaXMubWVhc3VyZW1lbnQgPSB7fTtcbiAgICAgIHRoaXMuZmxhZyA9IHRydWU7XG5cbiAgICAgIHRoaXMudG9vbGJhcnMucHVzaCh0aGlzLmNyZWF0ZVRvb2xiYXIoKSk7XG5cbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5vblByb3BzQ2hhbmdlKFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnLCAneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10sXG4gICAgICAgIGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgICAgaWYgKGluc3RhbmNlLmZsYWcpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLmZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGluc3RhbmNlLnNldEFjdGl2ZVBlcmlvZChzdGFydFsxXSwgZW5kWzFdKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5zdGFuY2Uuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGluc3RhbmNlLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoKGVuZFsxXSAtIHN0YXJ0WzFdKSA+PSBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIGluc3RhbmNlLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgICBpbnN0YW5jZS5jbGlja2VkSWQgPSBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIGluc3RhbmNlLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnN0YW5jZS50b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIGluc3RhbmNlLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgICAgaW5zdGFuY2UudG9vbGJhcnMucHVzaChpbnN0YW5jZS5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgaW5zdGFuY2UuZ2V0TG9naWNhbFNwYWNlKCk7XG4gICAgICAgICAgICBpbnN0YW5jZS5kcmF3KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBjcmVhdGVUb29sYmFyICgpIHtcbiAgICAgIHZhciB1bmlncm91cCxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMsXG4gICAgICAgIGNvbnRleHR1YWxCdXR0b25zLFxuICAgICAgICBhbGxCdXR0b24sXG4gICAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgICBkZWR1Y3RvckFyID0gW10sXG4gICAgICAgIHN0YXJ0TXVsdGlwbGllcixcbiAgICAgICAgZGVkdWN0b3IsXG4gICAgICAgIGksXG4gICAgICAgIGosXG4gICAgICAgIG1hcmdpbixcbiAgICAgICAgZnJvbURhdGVMYWJlbCxcbiAgICAgICAgZ3JvdXA7XG5cbiAgICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuXG4gICAgICB1bmlncm91cCA9IG5ldyB0aGlzLnRvb2xib3guVW5pU2VsZWN0Q29tcG9uZW50R3JvdXAoe1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9KTtcbiAgICAgIHVuaWdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIGdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIHRvb2xiYXIgPSBuZXcgdGhpcy5Ib3Jpem9udGFsVG9vbGJhcih7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuICAgICAgdG9vbGJhci5zZXRDb25maWcoe1xuICAgICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgICAgfSk7XG4gICAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnWm9vbTonLCB7XG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcbiAgICAgIH0sIHtcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAnZm9udC1mYW1pbHknOiAnXCJMdWNpZGEgR3JhbmRlXCIsIHNhbnMtc2VyaWYnLFxuICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxMycsXG4gICAgICAgICAgICAnZmlsbCc6ICcjNjk2OTY5JyxcbiAgICAgICAgICAgICdmb250LXdlaWdodCc6ICdib2xkJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29udGFpbmVyOiB7XG4gICAgICAgICAgaGVpZ2h0OiAyMlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZUxhYmVsKTtcbiAgICAgIGFsbEJ1dHRvbiA9IG5ldyB0aGlzLnRvb2xib3guU3ltYm9sKCdBTEwnLCB0cnVlLCB7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0sIHtcbiAgICAgICAgZmlsbDogJyNmZmZmZmYnLFxuICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6ICcyJyxcbiAgICAgICAgc3Ryb2tlOiAnI2NlZDVkNCcsXG4gICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICAgIGhvdmVyRmlsbDogJyNjZWQ1ZDQnLFxuICAgICAgICBoZWlnaHQ6IDIyLFxuICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgIHJpZ2h0OiA1XG4gICAgICAgIH0sXG4gICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgICdmb250RmFtaWx5JzogJ1wiTHVjaWRhIEdyYW5kZVwiLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICAnZm9udFNpemUnOiAnMTMnLFxuICAgICAgICAgICdmaWxsJzogJyM2OTY5NjknLFxuICAgICAgICAgICdsaW5lLWhlaWdodCc6ICcxJyxcbiAgICAgICAgICAnbGV0dGVyLXNwYWNpbmcnOiAnLTAuMDRlbSdcbiAgICAgICAgfVxuICAgICAgfSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAvLyBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9vbHRleHQ6ICdBTEwnXG4gICAgICB9KTtcblxuICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGFsbEJ1dHRvbik7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICAgIGRlZHVjdG9yQXIucHVzaChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjYWxjdWxhdGVkQnV0dG9ucyA9IHt9O1xuICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9iaikge1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5XS5oaWRlKCk7XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBpID0gc2VsZi5zdGFydFBvaW50VW5pdDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKGkgPT09IHNlbGYuc3RhcnRQb2ludFVuaXQpIHtcbiAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YXJ0UG9pbnRNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0YXJ0TXVsdGlwbGllciA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGogPSBzdGFydE11bHRpcGxpZXI7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgbWFyZ2luID0gKGkgPT09IHNlbGYubm9DYWxjQnV0dG9ucyAmJiBqID09PSAwKSA/IDUgOiAwO1xuICAgICAgICAgIGxldCBrZXlBYmIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgIGlmICh0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjYWxjdWxhdGVkQnV0dG9ucyA9IG5ldyB0aGlzLnRvb2xib3guU3ltYm9sKGtleUFiYiwgdHJ1ZSwge1xuICAgICAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgbGFiZWxGaWxsOiAnIzY5Njk2OScsXG4gICAgICAgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAnMicsXG4gICAgICAgICAgICAgIHN0cm9rZTogJyNjZWQ1ZDQnLFxuICAgICAgICAgICAgICBzdHJva2VXaWR0aDogJzEnLFxuICAgICAgICAgICAgICBob3ZlckZpbGw6ICcjY2VkNWQ0JyxcbiAgICAgICAgICAgICAgaGVpZ2h0OiAyMixcbiAgICAgICAgICAgICAgcmFkaXVzOiAxLFxuICAgICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgICByaWdodDogMFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBidG5UZXh0U3R5bGU6IHtcbiAgICAgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgICAgICAgJ2ZvbnRTaXplJzogJzEzJyxcbiAgICAgICAgICAgICAgICAnZmlsbCc6ICcjNjk2OTY5JyxcbiAgICAgICAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG4gICAgICAgICAgICAgICAgJ2xldHRlci1zcGFjaW5nJzogJy0wLjA0ZW0nXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZGVkdWN0b3IgPSAoc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKGRlZHVjdG9yKTtcbiAgICAgICAgICAgICAgICAvLyB0b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAgICAgICAvLyBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnRvb2xiYXJzW3RoaXMudG9vbGJhcnMubGVuZ3RoIC0gMV0gPSB0aGlzLmNyZWF0ZVRvb2xiYXIoKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdG9vbHRleHQ6IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArICcgJyArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5kZXNjcmlwdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSA9IGNhbGN1bGF0ZWRCdXR0b25zO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyB1bmlncm91cC5hZGRTeW1ib2woY2FsY3VsYXRlZEJ1dHRvbnNbaV0pO1xuICAgICAgICAgIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdLnNob3coKTtcbiAgICAgICAgICB1bmlncm91cC5hZGRTeW1ib2wodGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIGZvciAobGV0IGkgPSBzZWxmLnN0YXJ0UG9pbnRVbml0OyBpID49IDA7IGktLSkge1xuICAgICAgLy8gICBmb3IgKGxldCBqID0gc3RhcnRNdWx0aXBsaWVyOyBqID49IDA7IGotLSkge1xuICAgICAgLy8gICAgIGxldCBrZXlBYmIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgLy8gICAgIHVuaWdyb3VwLmFkZFN5bWJvbCh0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSk7XG4gICAgICAvLyAgIH1cbiAgICAgIC8vIH1cblxuICAgICAgY29udGV4dHVhbEJ1dHRvbnMgPSBbXTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb250ZXh0dWFsQnV0dG9uc1tpXSA9IG5ldyB0aGlzLnRvb2xib3guU3ltYm9sKHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmFiYnJldmlhdGlvbiwgdHJ1ZSwge1xuICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgICAgfSwge1xuICAgICAgICAgIGZpbGw6ICcjZmZmZmZmJyxcbiAgICAgICAgICBsYWJlbEZpbGw6ICcjNjk2OTY5JyxcbiAgICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogJzInLFxuICAgICAgICAgIHN0cm9rZTogJyNjZWQ1ZDQnLFxuICAgICAgICAgIHN0cm9rZVdpZHRoOiAnMScsXG4gICAgICAgICAgaGVpZ2h0OiAyMixcbiAgICAgICAgICBob3ZlckZpbGw6ICcjY2VkNWQ0JyxcbiAgICAgICAgICByYWRpdXM6IDEsXG4gICAgICAgICAgbWFyZ2luOiB7XG4gICAgICAgICAgICByaWdodDogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgICAgICAnZm9udEZhbWlseSc6ICdcIkx1Y2lkYSBHcmFuZGVcIiwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgICAnZm9udFNpemUnOiAnMTMnLFxuICAgICAgICAgICAgJ2ZpbGwnOiAnIzY5Njk2OScsXG4gICAgICAgICAgICAnbGluZS1oZWlnaHQnOiAnMScsXG4gICAgICAgICAgICAnbGV0dGVyLXNwYWNpbmcnOiAnLTAuMDRlbSdcbiAgICAgICAgICB9XG4gICAgICAgIH0pLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmRhdGVTdGFydCwgc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uZGF0ZUVuZCk7XG4gICAgICAgICAgICBzZWxmLmNsaWNrZWRJZCA9IHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgICAgIC8vIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wb3AoKTtcbiAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgICAvLyBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgLy8gc2VsZi5kcmF3KCk7XG4gICAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvb2x0ZXh0OiB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kZXNjcmlwdGlvblxuICAgICAgICB9KTtcbiAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGNvbnRleHR1YWxCdXR0b25zW2ldKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5TeW1ib2xTdG9yZS5yZWdpc3RlcigndGV4dEJveEljb24nLCBmdW5jdGlvbiAoeCwgeSwgcmFkLCB3LCBoLCBwYWRYLCBwYWRZKSB7XG4gICAgICAgIHZhciB4MSA9IHggLSB3IC8gMiArIHBhZFggLyAyLFxuICAgICAgICAgIHgyID0geCArIHcgLyAyIC0gcGFkWCAvIDIsXG4gICAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcbiAgICAgICAgICB5MiA9IHkgKyBoIC8gMiAtIHBhZFkgLyAyO1xuXG4gICAgICAgIHJldHVybiBbJ00nLCB4MSwgeTEsICdMJywgeDIsIHkxLCAnTCcsIHgyLCB5MiwgJ0wnLCB4MSwgeTIsICdaJ107XG4gICAgICB9KTtcblxuICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQoZ3JvdXApO1xuICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQodW5pZ3JvdXApO1xuICAgICAgdGhpcy50b29sYmFyID0gdG9vbGJhcjtcbiAgICAgIHJldHVybiB0b29sYmFyO1xuICAgIH07XG5cbiAgICBnZXRMb2dpY2FsU3BhY2UgKGF2YWlsYWJsZVdpZHRoID0gdGhpcy5fcFdpZHRoLCBhdmFpbGFibGVIZWlnaHQgPSB0aGlzLl9wSGVpZ2h0KSB7XG4gICAgICAvLyBhdmFpbGFibGVXaWR0aCAvPSAyO1xuICAgICAgdmFyIGxvZ2ljYWxTcGFjZSxcbiAgICAgICAgd2lkdGggPSA0MjAsIC8vIHdpZHRoIGhhcmRjb2RlZDsgVE9ETzogbWFrZSBpdCBkeW5hbWljXG4gICAgICAgIGhlaWdodCA9IDAsXG4gICAgICAgIGksXG4gICAgICAgIGxuO1xuXG4gICAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuICAgICAgICBsb2dpY2FsU3BhY2UgPSB0aGlzLnRvb2xiYXJzW2ldLmdldExvZ2ljYWxTcGFjZShhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICAgICAgLy8gd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcbiAgICAgICAgaGVpZ2h0ICs9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgICAgIHRoaXMudG9vbGJhcnNbaV0ud2lkdGggPSBsb2dpY2FsU3BhY2Uud2lkdGg7XG4gICAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICAgIH1cbiAgICAgIGhlaWdodCArPSB0aGlzLnBhZGRpbmc7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgICB9O1xuICAgIH07XG5cbiAgICBnZXREZWZhdWx0R3JvdXAgKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50R3JvdXA7XG4gICAgfVxuXG4gICAgcGxhY2VJbkNhbnZhcyAoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBzZWxmLnBhZGRpbmcgPSA1O1xuICAgICAgc2VsZi5zcGFjZU1hbmFnZXJJbnN0YW5jZS5hZGQoW3tcbiAgICAgICAgbmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAnc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWV4dCc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlZjogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgIHJldHVybiBvYmpbJzAnXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgICB9LFxuICAgICAgICBwcmlvcml0eTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9LFxuICAgICAgICBsYXlvdXQ6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcbiAgICAgICAgfSxcbiAgICAgICAgb3JpZW50YXRpb246IFt7XG4gICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIG9iai5ob3Jpem9udGFsO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcG9zaXRpb246IFt7XG4gICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYmoudG9wO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFsaWdubWVudDogW3tcbiAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGltZW5zaW9uczogW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3JlZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0TG9naWNhbFNwYWNlKChzZWxmLl9wV2lkdGggPSBwYXJlbnQuZ2V0V2lkdGgoKSksIChzZWxmLl9wSGVpZ2h0ID0gcGFyZW50LmdldEhlaWdodCgpKSk7XG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dXG4gICAgICAgIH1dXG4gICAgICB9XSk7XG4gICAgfTtcblxuICAgIHNldERyYXdpbmdDb25maWd1cmF0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG4gICAgICBtZXMueCA9IHg7XG4gICAgICBtZXMueSA9IHk7XG4gICAgICBtZXMud2lkdGggPSB3aWR0aDtcbiAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgIHRoaXMucGFyZW50R3JvdXAgPSBncm91cDtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIGRyYXcgKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG4gICAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG4gICAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgICBsbixcbiAgICAgICAgaSxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgYm91bmRFbGVtZW50LFxuICAgICAgICBiQm94LFxuICAgICAgICB4MSxcbiAgICAgICAgeDIsXG4gICAgICAgIHkyLFxuICAgICAgICBzZWxlY3RMaW5lLFxuICAgICAgICBtb2RlbCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbDtcblxuICAgICAgdGhpcy5mbGFnID0gdHJ1ZTtcbiAgICAgIHNlbGVjdExpbmUgPSB0aGlzLnNhdmVTZWxlY3RMaW5lIHx8IHRoaXMuZ3JhcGhpY3MucGFwZXIucGF0aCh7XG4gICAgICAgICdzdHJva2UnOiAnI2M5NWE1YScsXG4gICAgICAgICdzdHJva2Utd2lkdGgnOiAnMnB4J1xuICAgICAgfSkudG9Gcm9udCgpO1xuICAgICAgeCA9IHggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnggOiB4O1xuICAgICAgeSA9IHkgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnkgOiB5O1xuICAgICAgd2lkdGggPSB3aWR0aCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQud2lkdGggOiB3aWR0aDtcbiAgICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQuaGVpZ2h0IDogaGVpZ2h0O1xuICAgICAgZ3JvdXAgPSBncm91cCA9PT0gdW5kZWZpbmVkID8gdGhpcy5wYXJlbnRHcm91cCA6IGdyb3VwO1xuICAgICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuICAgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgICB0b29sYmFyID0gdG9vbGJhcnNbaV07XG4gICAgICAgICAgdG9vbGJhci5kcmF3KHgsIHksIGdyb3VwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zYXZlU2VsZWN0TGluZSA9IHNlbGVjdExpbmU7XG4gICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0b29sYmFyc1swXS5jb21wb25lbnRHcm91cHNbMV0uc3ltYm9sTGlzdDsgaSA8IGlpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpaVtpXS5zeW1ib2wgPT09IHRoaXMuY2xpY2tlZElkKSB7XG4gICAgICAgICAgYm91bmRFbGVtZW50ID0gaWlbaV0uZ2V0Qm91bmRFbGVtZW50KCk7XG4gICAgICAgICAgYkJveCA9IGJvdW5kRWxlbWVudC5nZXRCQm94KCk7XG4gICAgICAgICAgeDEgPSBiQm94Lng7XG4gICAgICAgICAgeDIgPSBiQm94LngyO1xuICAgICAgICAgIHkyID0gYkJveC55MjtcblxuICAgICAgICAgIC8vIHNlbGVjdExpbmUuYXR0cih7XG4gICAgICAgICAgLy8gICBwYXRoOiBbJ00nLCB4MSAtIDAuNSwgeTIgLSAwLjUsICdMJywgeDIgKyAwLjUsIHkyIC0gMC41XVxuICAgICAgICAgIC8vIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==
!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1);window.stPS=new n,window.timePeriods=[{name:"minute",milliseconds:6e4,startingPoint:0,abbreviation:"min",description:"MINUTE",parent:"hour",multipliers:[1,15,30]},{name:"hour",milliseconds:36e5,startingPoint:0,abbreviation:"hr",description:"HOUR",parent:"day",multipliers:[1,3,6,12]},{name:"day",milliseconds:864e5,startingPoint:0,abbreviation:"D",description:"DAY",parent:"month",multipliers:[1,7,15]},{name:"month",milliseconds:2592e6,startingPoint:0,abbreviation:"M",description:"MONTH",parent:"year",multipliers:[1,3,6]},{name:"year",milliseconds:31104e6,startingPoint:0,abbreviation:"Y",description:"YEAR",multipliers:[1,3,5]}]},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(){i(this,t),this.all=1,this.calculatedPeriods=[],this.startDataset=0,this.endDataset=990019999999,this.startActiveWindow=55e6,this.endActiveWindow=6e7,this.standardCalculatedPeriods=[],this.standardContexualPeriods=[],this.timePeriods=[{name:"second",milliseconds:1e3,startingPoint:0,total:60,abbreviation:"sec",description:"SECOND",parent:"minute",multipliers:[1,5,15,30]},{name:"minute",milliseconds:6e4,startingPoint:0,total:60,abbreviation:"min",description:"MINUTE",parent:"hour",multipliers:[1,5,15,30]},{name:"hour",milliseconds:36e5,startingPoint:0,total:24,abbreviation:"hr",description:"HOUR",parent:"day",multipliers:[1,3,6,12]},{name:"day",milliseconds:864e5,startingPoint:0,total:30,abbreviation:"D",description:"DAY",parent:"month",multipliers:[1,7,15]},{name:"month",milliseconds:2592e6,startingPoint:0,total:12,abbreviation:"M",description:"MONTH",parent:"year",multipliers:[1,3,6]},{name:"year",milliseconds:31104e6,startingPoint:0,abbreviation:"Y",description:"YEAR",multipliers:[1,3,5]}],this.tdButtons=[{name:"YTD",abbreviation:"YTD",parent:"year",milliseconds:31104e6,description:"Year to Date"},{name:"QTD",abbreviation:"QTD",parent:"month",multiplier:3,milliseconds:7776e6,description:"Quarter to Date"},{name:"MTD",abbreviation:"MTD",parent:"month",milliseconds:2592e6,description:"Month to Date"},{name:"WTD",abbreviation:"WTD",parent:"day",multiplier:7,milliseconds:6048e5,description:"Week to Date"},{name:"Y",abbreviation:"Y",parent:"day",milliseconds:864e5,description:"Yesterday"},{name:"T",abbreviation:"T",parent:"day",milliseconds:864e5,description:"Today"}],this.config={}}return n(t,[{key:"generateCalculatedButtons",value:function(){var t=this.endActiveWindow-this.startDataset,e=0,i=0,n=this.endActiveWindow-this.startActiveWindow;for(this.standardCalculatedPeriods=[],console.log("activeWindow",n),e=0;e<this.timePeriods.length;e++)if(t/this.timePeriods[e].milliseconds>=1)if(Math.floor(n/this.timePeriods[e].milliseconds)<1)this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].milliseconds,multipliers:[1]});else for(this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].milliseconds,multipliers:[]}),i=0;i<this.timePeriods[e].multipliers.length;i++)n/10<this.timePeriods[e].multipliers[i]*this.timePeriods[e].milliseconds&&this.standardCalculatedPeriods[this.standardCalculatedPeriods.length-1].multipliers.push(this.timePeriods[e].multipliers[i]);this.drawButtonsCalculated(this.standardCalculatedPeriods)}},{key:"generateContextualButtons",value:function(){for(var t=[],e=0,i=this.endDataset,n=new Date(i),s=new Date(i);e<this.tdButtons.length;e++)n=new Date(i),"YTD"===this.tdButtons[e].name?(console.log("YTD"),n.setMonth(0),n.setDate(0),n.setHours(0),n.setMinutes(0),n.setSeconds(0)):"MTD"===this.tdButtons[e].name?(console.log("MTD"),n.setDate(0),n.setHours(0),n.setMinutes(0),n.setSeconds(0)):"QTD"===this.tdButtons[e].name?(console.log("QTD"),n.setMonth(11-n.getMonth()%4),n.setDate(0),n.setHours(0),n.setMinutes(0),n.setSeconds(0)):"WTD"===this.tdButtons[e].name?(console.log("WTD"),n.setDate(n.getDate()-n.getDay()),n.setHours(0),n.setMinutes(0),n.setSeconds(0)):"Y"===this.tdButtons[e].name?(console.log("Y"),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n-=864e5):"T"===this.tdButtons[e].name&&(console.log("T"),n.setHours(0),n.setMinutes(0),n.setSeconds(0)),s<n||(this.tdButtons[e].dateStart=n.valueOf(),this.tdButtons[e].dateEnd=s.valueOf(),t.push(this.tdButtons[e]));this.standardContexualPeriods=t,this.drawButtonsContextual(this.standardContexualPeriods)}},{key:"setActivePeriod",value:function(t,e){console.log(t,e),this.startActiveWindow=t,this.endActiveWindow=e,document.getElementById("startActiveRange").innerHTML=new Date(this.startActiveWindow),document.getElementById("endActiveRange").innerHTML=new Date(this.endActiveWindow),this.generateCalculatedButtons()}},{key:"setTimeline",value:function(t,e){console.log(t,e),this.startDataset=t,this.endDataset=e,document.getElementById("startActiveRange").innerHTML=new Date(this.startDataset),document.getElementById("endActiveRange").innerHTML=new Date(this.endDataset),this.generateCalculatedButtons()}},{key:"drawButtonsCalculated",value:function(t){var e,i=document.getElementById("calculated"),n=0,s=0,a=0,o=this;for(i.innerHTML="",n=t.length-1;n>=0;n--)for(s=t[n].multipliers.length-1;s>=0;s--)e=document.createElement("BUTTON"),e.id=t[n].multipliers[s]+t[n].abbreviation,e.innerHTML=t[n].multipliers[s]+t[n].abbreviation,a=t[n].multipliers[s]*t[n].milliseconds,e.multiplierValue=a,e.addEventListener("click",function(t){o.setActivePeriod(o.endActiveWindow-t.srcElement.multiplierValue,o.endActiveWindow),console.log(o.endActiveWindow-t.srcElement.multiplierValue,o.endActiveWindow)}),i.appendChild(e);this.standardCalculatedPeriods=[]}},{key:"drawButtonsContextual",value:function(t){function e(t){a.setActivePeriod(t.dateStart,t.dateEnd),console.log(t.dateStart,t.dateEnd)}var i,n=document.getElementById("contextual"),s=0,a=this;for(n.innerHTML="",console.log(t),s=0;s<t.length;s++)i=document.createElement("BUTTON"),i.id=t[s].abbreviation,i.innerHTML=t[s].abbreviation,i.addEventListener("click",e.bind(this,t[s])),n.appendChild(i);this.standardContextualPeriods=[]}},{key:"drawButtonAll",value:function(t){var e,i=document.getElementById("allButton"),n=this;i.innerHTML="",console.log(t),e=document.createElement("BUTTON"),e.id="all",e.innerHTML="ALL",e.addEventListener("click",function(t){n.setActivePeriod(n.startDataset,n.endDataset)}),i.appendChild(e)}},{key:"configure",value:function(t){this.config=t}},{key:"init",value:function(t){t("X-Axis","Y-Axis","graphics","chart","extensionData","dateFormatter",function(t,e,i,n,s,a){})}},{key:"placeInCanvas",value:function(){}},{key:"draw",value:function(){}},{key:"dispose",value:function(){}}]),t}();"undefined"!=typeof t&&"undefined"!=typeof t.exports?t.exports=s:window.StandardPeriod=s}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDIwYzJmZWFhMGJhZjFmODQ3Y2JiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLmpzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIlN0YW5kYXJkUGVyaW9kU2VsZWN0b3IiLCJ3aW5kb3ciLCJzdFBTIiwidGltZVBlcmlvZHMiLCJuYW1lIiwibWlsbGlzZWNvbmRzIiwic3RhcnRpbmdQb2ludCIsImFiYnJldmlhdGlvbiIsImRlc2NyaXB0aW9uIiwicGFyZW50IiwibXVsdGlwbGllcnMiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsInRoaXMiLCJhbGwiLCJjYWxjdWxhdGVkUGVyaW9kcyIsInN0YXJ0RGF0YXNldCIsImVuZERhdGFzZXQiLCJzdGFydEFjdGl2ZVdpbmRvdyIsImVuZEFjdGl2ZVdpbmRvdyIsInN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMiLCJzdGFuZGFyZENvbnRleHVhbFBlcmlvZHMiLCJ0b3RhbCIsInRkQnV0dG9ucyIsIm11bHRpcGxpZXIiLCJjb25maWciLCJ2YWx1ZSIsInRhcmdldEJsb2NrIiwiaiIsImFjdGl2ZVdpbmRvdyIsImNvbnNvbGUiLCJsb2ciLCJNYXRoIiwiZmxvb3IiLCJwdXNoIiwiZHJhd0J1dHRvbnNDYWxjdWxhdGVkIiwiYnV0dG9ucyIsImVuZFN0YW1wIiwiZGF0ZVN0YXJ0IiwiRGF0ZSIsImRhdGVFbmQiLCJzZXRNb250aCIsInNldERhdGUiLCJzZXRIb3VycyIsInNldE1pbnV0ZXMiLCJzZXRTZWNvbmRzIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RGF5IiwidmFsdWVPZiIsImRyYXdCdXR0b25zQ29udGV4dHVhbCIsInN0YXJ0IiwiZW5kIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMiLCJzdGFuZGFyZFBlcmlvZHMiLCJidG4iLCJjYWxjdWxhdGVkQnV0dG9ucyIsIm11bHRpcGxpZXJWYWx1ZSIsInNlbGYiLCJjcmVhdGVFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwic2V0QWN0aXZlUGVyaW9kIiwic3JjRWxlbWVudCIsImFwcGVuZENoaWxkIiwiZXZlbnRCdG4iLCJvYmoiLCJjb250ZXh0dWFsQnV0dG9ucyIsImJpbmQiLCJzdGFuZGFyZENvbnRleHR1YWxQZXJpb2RzIiwiYWxsQnV0dG9ucyIsInJlcXVpcmUiLCJ4IiwieSIsImdyYXBoaWNzIiwiY2hhcnQiLCJleHREYXRhIiwiZGF0ZUZvcm1hdHRlciIsIlN0YW5kYXJkUGVyaW9kIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFB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QVksUUFBUyxnQkFBaUIsZ0JBQ2hFLFNBQVVDLEVBQUdDLEVBQUdDLEVBQVVDLEVBQU9DLEVBQVNDLFNIOEkzQ3ZFLElBQUssZ0JBQ0xpQixNQUFPLGVBT1BqQixJQUFLLE9BQ0xpQixNQUFPLGVBU1BqQixJQUFLLFVBQ0xpQixNQUFPLGdCQUdGNUMsSUc3SVksb0JBQVhQLElBQW9ELG1CQUFuQkEsR0FBT0QsUUFDakRDLEVBQU9ELFFBQVVRLEVBRWpCQyxPQUFPa0csZUFBaUJuRyIsImZpbGUiOiJzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3ItZXM1Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0d2luZG93LnN0UFMgPSBuZXcgU3RhbmRhcmRQZXJpb2RTZWxlY3RvcigpO1xuXHR3aW5kb3cudGltZVBlcmlvZHMgPSBbe1xuXHQgICduYW1lJzogJ21pbnV0ZScsXG5cdCAgJ21pbGxpc2Vjb25kcyc6IDYwMDAwLFxuXHQgICdzdGFydGluZ1BvaW50JzogMCxcblx0ICAnYWJicmV2aWF0aW9uJzogJ21pbicsXG5cdCAgJ2Rlc2NyaXB0aW9uJzogJ01JTlVURScsXG5cdCAgJ3BhcmVudCc6ICdob3VyJyxcblx0ICAnbXVsdGlwbGllcnMnOiBbMSwgMTUsIDMwXVxuXHR9LCB7XG5cdCAgJ25hbWUnOiAnaG91cicsXG5cdCAgJ21pbGxpc2Vjb25kcyc6IDM2MDAwMDAsXG5cdCAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuXHQgICdhYmJyZXZpYXRpb24nOiAnaHInLFxuXHQgICdkZXNjcmlwdGlvbic6ICdIT1VSJyxcblx0ICAncGFyZW50JzogJ2RheScsXG5cdCAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxuXHR9LCB7XG5cdCAgJ25hbWUnOiAnZGF5Jyxcblx0ICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG5cdCAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuXHQgICdhYmJyZXZpYXRpb24nOiAnRCcsXG5cdCAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG5cdCAgJ3BhcmVudCc6ICdtb250aCcsXG5cdCAgJ211bHRpcGxpZXJzJzogWzEsIDcsIDE1XVxuXHR9LCB7XG5cdCAgJ25hbWUnOiAnbW9udGgnLFxuXHQgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuXHQgICdzdGFydGluZ1BvaW50JzogMCxcblx0ICAnYWJicmV2aWF0aW9uJzogJ00nLFxuXHQgICdkZXNjcmlwdGlvbic6ICdNT05USCcsXG5cdCAgJ3BhcmVudCc6ICd5ZWFyJyxcblx0ICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNl1cblx0fSwge1xuXHQgICduYW1lJzogJ3llYXInLFxuXHQgICdtaWxsaXNlY29uZHMnOiAzMTEwNDAwMDAwMCxcblx0ICAnc3RhcnRpbmdQb2ludCc6IDAsXG5cdCAgJ2FiYnJldmlhdGlvbic6ICdZJyxcblx0ICAnZGVzY3JpcHRpb24nOiAnWUVBUicsXG5cdCAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDVdXG5cdH1dO1xuXHRcblx0Ly8gdmFyIGZjID0gbmV3IEZ1c2lvbkNoYXJ0cygpO1xuXHRcblx0LyogRnVzaW9uQ2hhcnRzLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3RvcicsIGZ1bmN0aW9uIChpZCkge1xuXHQgIHZhciBnbG9iYWwgPSB0aGlzO1xuXHQgIHZhciBleHRBUEkgPSBnbG9iYWwuZXh0QVBJO1xuXG5cdCAgLy8gdmFyIG90aGVyQVBJID0gRnVzaW9uQ2hhcnRzLmdldEV4dENvbXBvbmVudChpZCwgJ2FwaScsICdsZWdhY3lleHRhcGknKTtcblx0ICAvLyB2YXIgdG9vbEJveEFwaSA9IEZ1c2lvbkNoYXJ0cy5nZXRDb21wb25lbnQoJ2FwaScsICd0b29sYm94Jyk7XG5cblx0ICB3aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG5cdCAgZXh0QVBJKHdpbmRvdy5zdFBTKTtcblx0fV0pOyAqL1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0LyoqXG5cdCAqIENsYXNzIGRlZmluaXRpb24gb2YgU3RhbmRhcmRQZXJpb2RTZWxlY3RvclxuXHQgKi9cblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gU3RhbmRhcmRQZXJpb2RTZWxlY3RvcigpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuYWxsID0gMTtcblx0ICAgIHRoaXMuY2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcblx0ICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcblx0ICAgIHRoaXMuZW5kRGF0YXNldCA9IDk5MDAxOTk5OTk5OTtcblx0ICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSA1NTAwMDAwMDtcblx0ICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gNjAwMDAwMDA7XG5cdCAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcblx0ICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gW107XG5cdCAgICB0aGlzLnRpbWVQZXJpb2RzID0gW3tcblx0ICAgICAgJ25hbWUnOiAnc2Vjb25kJyxcblx0ICAgICAgJ21pbGxpc2Vjb25kcyc6IDEwMDAsXG5cdCAgICAgICdzdGFydGluZ1BvaW50JzogMCxcblx0ICAgICAgJ3RvdGFsJzogNjAsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnc2VjJyxcblx0ICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1NFQ09ORCcsXG5cdCAgICAgICdwYXJlbnQnOiAnbWludXRlJyxcblx0ICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDUsIDE1LCAzMF1cblx0ICAgIH0sIHtcblx0ICAgICAgJ25hbWUnOiAnbWludXRlJyxcblx0ICAgICAgJ21pbGxpc2Vjb25kcyc6IDYwMDAwLFxuXHQgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG5cdCAgICAgICd0b3RhbCc6IDYwLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ21pbicsXG5cdCAgICAgICdkZXNjcmlwdGlvbic6ICdNSU5VVEUnLFxuXHQgICAgICAncGFyZW50JzogJ2hvdXInLFxuXHQgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgNSwgMTUsIDMwXVxuXHQgICAgfSwge1xuXHQgICAgICAnbmFtZSc6ICdob3VyJyxcblx0ICAgICAgJ21pbGxpc2Vjb25kcyc6IDM2MDAwMDAsXG5cdCAgICAgICdzdGFydGluZ1BvaW50JzogMCxcblx0ICAgICAgJ3RvdGFsJzogMjQsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnaHInLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnSE9VUicsXG5cdCAgICAgICdwYXJlbnQnOiAnZGF5Jyxcblx0ICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxuXHQgICAgfSwge1xuXHQgICAgICAnbmFtZSc6ICdkYXknLFxuXHQgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG5cdCAgICAgICdzdGFydGluZ1BvaW50JzogMCxcblx0ICAgICAgJ3RvdGFsJzogMzAsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnRCcsXG5cdCAgICAgICdkZXNjcmlwdGlvbic6ICdEQVknLFxuXHQgICAgICAncGFyZW50JzogJ21vbnRoJyxcblx0ICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDcsIDE1XVxuXHQgICAgfSwge1xuXHQgICAgICAnbmFtZSc6ICdtb250aCcsXG5cdCAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuXHQgICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG5cdCAgICAgICd0b3RhbCc6IDEyLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ00nLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnTU9OVEgnLFxuXHQgICAgICAncGFyZW50JzogJ3llYXInLFxuXHQgICAgICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNl1cblx0ICAgIH0sIHtcblx0ICAgICAgJ25hbWUnOiAneWVhcicsXG5cdCAgICAgICdtaWxsaXNlY29uZHMnOiAzMTEwNDAwMDAwMCxcblx0ICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnWUVBUicsXG5cdCAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAzLCA1XVxuXHQgICAgfV07XG5cdCAgICB0aGlzLnRkQnV0dG9ucyA9IFt7XG5cdCAgICAgICduYW1lJzogJ1lURCcsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnWVREJyxcblx0ICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcblx0ICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnWWVhciB0byBEYXRlJ1xuXHQgICAgfSwge1xuXHQgICAgICAnbmFtZSc6ICdRVEQnLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ1FURCcsXG5cdCAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuXHQgICAgICAnbXVsdGlwbGllcic6IDMsXG5cdCAgICAgICdtaWxsaXNlY29uZHMnOiA3Nzc2MDAwMDAwLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuXHQgICAgfSwge1xuXHQgICAgICAnbmFtZSc6ICdNVEQnLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG5cdCAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuXHQgICAgICAnbWlsbGlzZWNvbmRzJzogMjU5MjAwMDAwMCxcblx0ICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG5cdCAgICB9LCB7XG5cdCAgICAgICduYW1lJzogJ1dURCcsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcblx0ICAgICAgJ3BhcmVudCc6ICdkYXknLFxuXHQgICAgICAnbXVsdGlwbGllcic6IDcsXG5cdCAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG5cdCAgICAgICdkZXNjcmlwdGlvbic6ICdXZWVrIHRvIERhdGUnXG5cdCAgICB9LCB7XG5cdCAgICAgICduYW1lJzogJ1knLFxuXHQgICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuXHQgICAgICAncGFyZW50JzogJ2RheScsXG5cdCAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcblx0ICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llc3RlcmRheSdcblx0ICAgIH0sIHtcblx0ICAgICAgJ25hbWUnOiAnVCcsXG5cdCAgICAgICdhYmJyZXZpYXRpb24nOiAnVCcsXG5cdCAgICAgICdwYXJlbnQnOiAnZGF5Jyxcblx0ICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuXHQgICAgICAnZGVzY3JpcHRpb24nOiAnVG9kYXknXG5cdCAgICB9XTtcblx0ICAgIHRoaXMuY29uZmlnID0ge307XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjYWxjdWxhdGVkIGJ1dHRvbnMgdXNpbmdcblx0ICAgKiB0aGUgYWN0aXZlIHJhbmdlIGFuZCB0aGUgbG9jYXRpb24gb2YgdGhlIGFjdGl2ZSByYW5nZVxuXHQgICAqL1xuXHRcblx0XG5cdCAgX2NyZWF0ZUNsYXNzKFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IsIFt7XG5cdCAgICBrZXk6ICdnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zKCkge1xuXHQgICAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuXHQgICAgICAgICAgaSA9IDAsXG5cdCAgICAgICAgICBqID0gMCxcblx0ICAgICAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcblx0ICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzID0gW107XG5cdCAgICAgIGNvbnNvbGUubG9nKCdhY3RpdmVXaW5kb3cnLCBhY3RpdmVXaW5kb3cpO1xuXHQgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50aW1lUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgYXBwbGljYWJsZSBmb3IgdGhlIGN1cnJlbnQgdGFyZ2V0IGJsb2NrXG5cdCAgICAgICAgaWYgKHRhcmdldEJsb2NrIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMgPj0gMSkge1xuXHQgICAgICAgICAgLy8gY2hlY2tpbmcgd2hldGhlciB0aGUgdW5pdCBpcyBvZiB0aGUgaGlnaGVyIG9yZGVyIGFuZCBvbmx5IG11bHRpcGxpZXIgMSBpcyBhcHBsaWNhYmxlXG5cdCAgICAgICAgICBpZiAoTWF0aC5mbG9vcihhY3RpdmVXaW5kb3cgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcykgPCAxKSB7XG5cdCAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5wdXNoKHtcblx0ICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24sXG5cdCAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcblx0ICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMsXG5cdCAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogWzFdXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgLy8gaWYgdGhlIHVuaXQgaXMgb2YgdGhlIG9yZGVyIG9mIHRoZSB0YXJnZXQgYmxvY2sgYW5kIGNhbGN1bGF0aW5nIHRoZSBtdWx0aXBsaWVyc1xuXHQgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG5cdCAgICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLFxuXHQgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG5cdCAgICAgICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzLFxuXHQgICAgICAgICAgICAgICdtdWx0aXBsaWVycyc6IFtdXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAvLyBjYWxjdWxhdGluZyBhbmQgcG9wdWxhdGluZyB0aGUgYXBwbGljYWJsZSBtdWx0cGxpZXJzIG9mIGVhY2ggdW5pdFxuXHQgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuXHQgICAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyAxMCA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcykge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW3RoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGggLSAxXS5tdWx0aXBsaWVycy5wdXNoKHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0pO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICB0aGlzLmRyYXdCdXR0b25zQ2FsY3VsYXRlZCh0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY29udGV4dHVhbCBidXR0b25zIHVzaW5nXG5cdCAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpIHtcblx0ICAgICAgLy8gZ2VuZXJhdGluZyBhbiBhcnJheSB3aXRoIGFwcGxpY2FibGUgVEQgYnV0dG9uc1xuXHQgICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuXHQgICAgICAgICAgaSA9IDAsXG5cdCAgICAgICAgICBlbmRTdGFtcCA9IHRoaXMuZW5kRGF0YXNldCxcblx0ICAgICAgICAgIGRhdGVTdGFydCA9IG5ldyBEYXRlKGVuZFN0YW1wKSxcblx0ICAgICAgICAgIGRhdGVFbmQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG5cdCAgICAgIGZvciAoOyBpIDwgdGhpcy50ZEJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICBkYXRlU3RhcnQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG5cdCAgICAgICAgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZVEQnKSB7XG5cdCAgICAgICAgICBjb25zb2xlLmxvZygnWVREJyk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnTVREJykge1xuXHQgICAgICAgICAgY29uc29sZS5sb2coJ01URCcpO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1FURCcpIHtcblx0ICAgICAgICAgIGNvbnNvbGUubG9nKCdRVEQnKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgxMSAtIGRhdGVTdGFydC5nZXRNb250aCgpICUgNCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuXHQgICAgICAgICAgY29uc29sZS5sb2coJ1dURCcpO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoZGF0ZVN0YXJ0LmdldERhdGUoKSAtIGRhdGVTdGFydC5nZXREYXkoKSk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1knKSB7XG5cdCAgICAgICAgICBjb25zb2xlLmxvZygnWScpO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG5cdCAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydCAtPSA4NjQwMDAwMDtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdUJykge1xuXHQgICAgICAgICAgY29uc29sZS5sb2coJ1QnKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcblx0ICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoZGF0ZUVuZCA8IGRhdGVTdGFydCkge1xuXHQgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMudGRCdXR0b25zW2ldLmRhdGVTdGFydCA9IGRhdGVTdGFydC52YWx1ZU9mKCk7XG5cdCAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG5cdCAgICAgICAgICBidXR0b25zLnB1c2godGhpcy50ZEJ1dHRvbnNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IGJ1dHRvbnM7XG5cdCAgICAgIHRoaXMuZHJhd0J1dHRvbnNDb250ZXh0dWFsKHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBhY3RpdmUgcGVyaW9kJ3Ncblx0ICAgICAqIHN0YXJ0IGFuZCBlbmQgcG9pbnRcblx0ICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG5cdCAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIGFjdGl2ZSBwZXJpb2Rcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzZXRBY3RpdmVQZXJpb2QnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEFjdGl2ZVBlcmlvZChzdGFydCwgZW5kKSB7XG5cdCAgICAgIGNvbnNvbGUubG9nKHN0YXJ0LCBlbmQpO1xuXHQgICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG5cdCAgICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gZW5kO1xuXHQgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnRBY3RpdmVSYW5nZScpLmlubmVySFRNTCA9IG5ldyBEYXRlKHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cpO1xuXHQgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZW5kQWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLmVuZEFjdGl2ZVdpbmRvdyk7XG5cdCAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIHN0YXJ0IGFuZCBlbmQgcG9pbnQgb2YgdGhlXG5cdCAgICAgKiBlbnRpcmUgdGltZS1saW5lXG5cdCAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgdGltZS1saW5lXG5cdCAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgZW5kIHBvaW50IG9mIHRpbWUtbGluZVxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3NldFRpbWVsaW5lJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRUaW1lbGluZShzdGFydCwgZW5kKSB7XG5cdCAgICAgIGNvbnNvbGUubG9nKHN0YXJ0LCBlbmQpO1xuXHQgICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IHN0YXJ0O1xuXHQgICAgICB0aGlzLmVuZERhdGFzZXQgPSBlbmQ7XG5cdCAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5zdGFydERhdGFzZXQpO1xuXHQgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZW5kQWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLmVuZERhdGFzZXQpO1xuXHQgICAgICB0aGlzLmdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMoKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEEgZnVuY3Rpb24gdG8gZHJhdyB0aGUgY2FsY3VsYXRlZCBidXR0b25zIGluIHRoZSBjYW52YXNcblx0ICAgICAqIEBwYXJhbSAge2FycmF5fSBhcnJheSBvZiBvYmplY3RzIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBzdGFuZGFyZCBwZXJpb2RzIHRvIGJlIGRyYXduIGluZm9ybWF0aW9uXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZHJhd0J1dHRvbnNDYWxjdWxhdGVkJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3QnV0dG9uc0NhbGN1bGF0ZWQoc3RhbmRhcmRQZXJpb2RzKSB7XG5cdCAgICAgIHZhciBjYWxjdWxhdGVkQnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxjdWxhdGVkJyksXG5cdCAgICAgICAgICBidG4sXG5cdCAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgIGogPSAwLFxuXHQgICAgICAgICAgbXVsdGlwbGllclZhbHVlID0gMCxcblx0ICAgICAgICAgIHNlbGYgPSB0aGlzO1xuXHQgICAgICBjYWxjdWxhdGVkQnV0dG9ucy5pbm5lckhUTUwgPSAnJztcblx0ICAgICAgZm9yIChpID0gc3RhbmRhcmRQZXJpb2RzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdCAgICAgICAgZm9yIChqID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG5cdCAgICAgICAgICBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKTtcblx0ICAgICAgICAgIGJ0bi5pZCA9IHN0YW5kYXJkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHN0YW5kYXJkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG5cdCAgICAgICAgICBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAgIG11bHRpcGxpZXJWYWx1ZSA9IHN0YW5kYXJkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHN0YW5kYXJkUGVyaW9kc1tpXS5taWxsaXNlY29uZHM7XG5cdCAgICAgICAgICBidG4ubXVsdGlwbGllclZhbHVlID0gbXVsdGlwbGllclZhbHVlO1xuXHQgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuZW5kQWN0aXZlV2luZG93IC0gZXZlbnQuc3JjRWxlbWVudC5tdWx0aXBsaWVyVmFsdWUsIHNlbGYuZW5kQWN0aXZlV2luZG93KTtcblx0ICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5lbmRBY3RpdmVXaW5kb3cgLSBldmVudC5zcmNFbGVtZW50Lm11bHRpcGxpZXJWYWx1ZSwgc2VsZi5lbmRBY3RpdmVXaW5kb3cpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgICBjYWxjdWxhdGVkQnV0dG9ucy5hcHBlbmRDaGlsZChidG4pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEEgZnVuY3Rpb24gdG8gZHJhdyB0aGUgY29udGV4dHVhbCBidXR0b25zLlxuXHQgICAgICogQHBhcmFtICB7YXJyYXl9IGFycmF5IG9mIG9iamVjdHMgLSBBbiBhcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIHN0YW5kYXJkIHBlcmlvZHMgdG8gYmUgZHJhd24gaW5mb3JtYXRpb25cblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdkcmF3QnV0dG9uc0NvbnRleHR1YWwnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXdCdXR0b25zQ29udGV4dHVhbChzdGFuZGFyZFBlcmlvZHMpIHtcblx0ICAgICAgdmFyIGNvbnRleHR1YWxCdXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRleHR1YWwnKSxcblx0ICAgICAgICAgIGJ0bixcblx0ICAgICAgICAgIGkgPSAwLFxuXHQgICAgICAgICAgc2VsZiA9IHRoaXM7XG5cdCAgICAgIGNvbnRleHR1YWxCdXR0b25zLmlubmVySFRNTCA9ICcnO1xuXHQgICAgICBjb25zb2xlLmxvZyhzdGFuZGFyZFBlcmlvZHMpO1xuXHQgICAgICBmb3IgKGkgPSAwOyBpIDwgc3RhbmRhcmRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyk7XG5cdCAgICAgICAgYnRuLmlkID0gc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudEJ0bi5iaW5kKHRoaXMsIHN0YW5kYXJkUGVyaW9kc1tpXSkpO1xuXHQgICAgICAgIGNvbnRleHR1YWxCdXR0b25zLmFwcGVuZENoaWxkKGJ0bik7XG5cdCAgICAgIH1cblx0ICAgICAgZnVuY3Rpb24gZXZlbnRCdG4ob2JqKSB7XG5cdCAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qob2JqLmRhdGVTdGFydCwgb2JqLmRhdGVFbmQpO1xuXHQgICAgICAgIGNvbnNvbGUubG9nKG9iai5kYXRlU3RhcnQsIG9iai5kYXRlRW5kKTtcblx0ICAgICAgfVxuXHQgICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dHVhbFBlcmlvZHMgPSBbXTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEEgZnVuY3Rpb24gdG8gZHJhdyB0aGUgQUxMIGJ1dHRvbi5cblx0ICAgICAqIEBwYXJhbSAge2FycmF5fSBhcnJheSBvZiBvYmplY3RzIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBzdGFuZGFyZCBwZXJpb2RzIHRvIGJlIGRyYXduIGluZm9ybWF0aW9uXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZHJhd0J1dHRvbkFsbCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZHJhd0J1dHRvbkFsbChzdGFuZGFyZFBlcmlvZHMpIHtcblx0ICAgICAgdmFyIGFsbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxsQnV0dG9uJyksXG5cdCAgICAgICAgICBidG4sXG5cdCAgICAgICAgICBzZWxmID0gdGhpcztcblx0ICAgICAgYWxsQnV0dG9ucy5pbm5lckhUTUwgPSAnJztcblx0ICAgICAgY29uc29sZS5sb2coc3RhbmRhcmRQZXJpb2RzKTtcblx0ICAgICAgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyk7XG5cdCAgICAgIGJ0bi5pZCA9ICdhbGwnO1xuXHQgICAgICBidG4uaW5uZXJIVE1MID0gJ0FMTCc7XG5cdCAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuc3RhcnREYXRhc2V0LCBzZWxmLmVuZERhdGFzZXQpO1xuXHQgICAgICB9KTtcblx0ICAgICAgYWxsQnV0dG9ucy5hcHBlbmRDaGlsZChidG4pO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIG9iamVjdCB0byBzZXQgdGhlIHVzZXIgcHJlZmVyZW5jZXNcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdjb25maWd1cmUnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcblx0ICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2luaXQnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQocmVxdWlyZSkge1xuXHQgICAgICByZXF1aXJlKCdYLUF4aXMnLCAnWS1BeGlzJywgJ2dyYXBoaWNzJywgJ2NoYXJ0JywgJ2V4dGVuc2lvbkRhdGEnLCAnZGF0ZUZvcm1hdHRlcicsIGZ1bmN0aW9uICh4LCB5LCBncmFwaGljcywgY2hhcnQsIGV4dERhdGEsIGRhdGVGb3JtYXR0ZXIpIHt9KTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAncGxhY2VJbkNhbnZhcycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcGxhY2VJbkNhbnZhcygpIHt9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2RyYXcnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXcoKSB7fVxuXHQgICAgLy8gZHJhd2luZyBvZiB0aGUgc3RhbmRhcmQgdGltZSBwZXJpb2RzIGhhcHBlbnMgaGVyZVxuXHRcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZGlzcG9zZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHt9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcblx0fSgpO1xuXHRcblx0aWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICBtb2R1bGUuZXhwb3J0cyA9IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG5cdH0gZWxzZSB7XG5cdCAgd2luZG93LlN0YW5kYXJkUGVyaW9kID0gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcblx0fVxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAyMGMyZmVhYTBiYWYxZjg0N2NiYiIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSByZXF1aXJlKCcuL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3RvcicpO1xuXG53aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG53aW5kb3cudGltZVBlcmlvZHMgPSBbe1xuICAnbmFtZSc6ICdtaW51dGUnLFxuICAnbWlsbGlzZWNvbmRzJzogNjAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdtaW4nLFxuICAnZGVzY3JpcHRpb24nOiAnTUlOVVRFJyxcbiAgJ3BhcmVudCc6ICdob3VyJyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDE1LCAzMF1cbn0sIHtcbiAgJ25hbWUnOiAnaG91cicsXG4gICdtaWxsaXNlY29uZHMnOiAzNjAwMDAwLFxuICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICdhYmJyZXZpYXRpb24nOiAnaHInLFxuICAnZGVzY3JpcHRpb24nOiAnSE9VUicsXG4gICdwYXJlbnQnOiAnZGF5JyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDYsIDEyXVxufSwge1xuICAnbmFtZSc6ICdkYXknLFxuICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdEJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG4gICdwYXJlbnQnOiAnbW9udGgnLFxuICAnbXVsdGlwbGllcnMnOiBbMSwgNywgMTVdXG59LCB7XG4gICduYW1lJzogJ21vbnRoJyxcbiAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdNJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ01PTlRIJyxcbiAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDZdXG59LCB7XG4gICduYW1lJzogJ3llYXInLFxuICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICdzdGFydGluZ1BvaW50JzogMCxcbiAgJ2FiYnJldmlhdGlvbic6ICdZJyxcbiAgJ2Rlc2NyaXB0aW9uJzogJ1lFQVInLFxuICAnbXVsdGlwbGllcnMnOiBbMSwgMywgNV1cbn1dO1xuXG4vLyB2YXIgZmMgPSBuZXcgRnVzaW9uQ2hhcnRzKCk7XG5cbi8qIEZ1c2lvbkNoYXJ0cy5yZWdpc3RlcignZXh0ZW5zaW9uJywgWydzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InLCBmdW5jdGlvbiAoaWQpIHtcbiAgdmFyIGdsb2JhbCA9IHRoaXM7XG4gIHZhciBleHRBUEkgPSBnbG9iYWwuZXh0QVBJO1xuXG4gIC8vIHZhciBvdGhlckFQSSA9IEZ1c2lvbkNoYXJ0cy5nZXRFeHRDb21wb25lbnQoaWQsICdhcGknLCAnbGVnYWN5ZXh0YXBpJyk7XG4gIC8vIHZhciB0b29sQm94QXBpID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcblxuICB3aW5kb3cuc3RQUyA9IG5ldyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKCk7XG4gIGV4dEFQSSh3aW5kb3cuc3RQUyk7XG59XSk7ICovXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ2xhc3MgZGVmaW5pdGlvbiBvZiBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yXG4gKi9cblxuY2xhc3MgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciB7XG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuYWxsID0gMTtcbiAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSAwO1xuICAgIHRoaXMuZW5kRGF0YXNldCA9IDk5MDAxOTk5OTk5OTtcbiAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gNTUwMDAwMDA7XG4gICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSA2MDAwMDAwMDtcbiAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuICAgIHRoaXMudGltZVBlcmlvZHMgPSBbe1xuICAgICAgJ25hbWUnOiAnc2Vjb25kJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiAxMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ3RvdGFsJzogNjAsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ3NlYycsXG4gICAgICAnZGVzY3JpcHRpb24nOiAnU0VDT05EJyxcbiAgICAgICdwYXJlbnQnOiAnbWludXRlJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCA1LCAxNSwgMzBdXG4gICAgfSwge1xuICAgICAgJ25hbWUnOiAnbWludXRlJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiA2MDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICd0b3RhbCc6IDYwLFxuICAgICAgJ2FiYnJldmlhdGlvbic6ICdtaW4nLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01JTlVURScsXG4gICAgICAncGFyZW50JzogJ2hvdXInLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDUsIDE1LCAzMF1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICdob3VyJyxcbiAgICAgICdtaWxsaXNlY29uZHMnOiAzNjAwMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ3RvdGFsJzogMjQsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ2hyJyxcbiAgICAgICdkZXNjcmlwdGlvbic6ICdIT1VSJyxcbiAgICAgICdwYXJlbnQnOiAnZGF5JyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCAzLCA2LCAxMl1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICdkYXknLFxuICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuICAgICAgJ3N0YXJ0aW5nUG9pbnQnOiAwLFxuICAgICAgJ3RvdGFsJzogMzAsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ0QnLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ0RBWScsXG4gICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICdtdWx0aXBsaWVycyc6IFsxLCA3LCAxNV1cbiAgICB9LCB7XG4gICAgICAnbmFtZSc6ICdtb250aCcsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogMjU5MjAwMDAwMCxcbiAgICAgICdzdGFydGluZ1BvaW50JzogMCxcbiAgICAgICd0b3RhbCc6IDEyLFxuICAgICAgJ2FiYnJldmlhdGlvbic6ICdNJyxcbiAgICAgICdkZXNjcmlwdGlvbic6ICdNT05USCcsXG4gICAgICAncGFyZW50JzogJ3llYXInLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDZdXG4gICAgfSwge1xuICAgICAgJ25hbWUnOiAneWVhcicsXG4gICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICAgICAnc3RhcnRpbmdQb2ludCc6IDAsXG4gICAgICAnYWJicmV2aWF0aW9uJzogJ1knLFxuICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1lFQVInLFxuICAgICAgJ211bHRpcGxpZXJzJzogWzEsIDMsIDVdXG4gICAgfV07XG4gICAgdGhpcy50ZEJ1dHRvbnMgPSBbXG4gICAgICB7XG4gICAgICAgICduYW1lJzogJ1lURCcsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnWVREJyxcbiAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDMxMTA0MDAwMDAwLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVhciB0byBEYXRlJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ25hbWUnOiAnUVREJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuICAgICAgICAncGFyZW50JzogJ21vbnRoJyxcbiAgICAgICAgJ211bHRpcGxpZXInOiAzLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1F1YXJ0ZXIgdG8gRGF0ZSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICduYW1lJzogJ01URCcsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnTVREJyxcbiAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiAyNTkyMDAwMDAwLFxuICAgICAgICAnZGVzY3JpcHRpb24nOiAnTW9udGggdG8gRGF0ZSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICduYW1lJzogJ1dURCcsXG4gICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcbiAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAnbXVsdGlwbGllcic6IDcsXG4gICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdXZWVrIHRvIERhdGUnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAnbmFtZSc6ICdZJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdZJyxcbiAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdZZXN0ZXJkYXknXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAnbmFtZSc6ICdUJyxcbiAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcbiAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAnbWlsbGlzZWNvbmRzJzogODY0MDAwMDAsXG4gICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcbiAgICAgIH1cbiAgICBdO1xuICAgIHRoaXMuY29uZmlnID0ge307XG4gIH1cblxuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY2FsY3VsYXRlZCBidXR0b25zIHVzaW5nXG4gICAqIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgYWN0aXZlIHJhbmdlXG4gICAqL1xuICBnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zICgpIHtcbiAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuICAgICAgaSA9IDAsXG4gICAgICBqID0gMCxcbiAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcbiAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICBjb25zb2xlLmxvZygnYWN0aXZlV2luZG93JywgYWN0aXZlV2luZG93KTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50aW1lUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gY2hlY2tpbmcgd2hldGhlciB0aGUgdW5pdCBpcyBhcHBsaWNhYmxlIGZvciB0aGUgY3VycmVudCB0YXJnZXQgYmxvY2tcbiAgICAgIGlmICh0YXJnZXRCbG9jayAvIHRoaXMudGltZVBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzID49IDEpIHtcbiAgICAgICAgLy8gY2hlY2tpbmcgd2hldGhlciB0aGUgdW5pdCBpcyBvZiB0aGUgaGlnaGVyIG9yZGVyIGFuZCBvbmx5IG11bHRpcGxpZXIgMSBpcyBhcHBsaWNhYmxlXG4gICAgICAgIGlmIChNYXRoLmZsb29yKChhY3RpdmVXaW5kb3cpIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMpIDwgMSkge1xuICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5wdXNoKHtcbiAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbixcbiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMsXG4gICAgICAgICAgICAnbXVsdGlwbGllcnMnOiBbMV1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHsgLy8gaWYgdGhlIHVuaXQgaXMgb2YgdGhlIG9yZGVyIG9mIHRoZSB0YXJnZXQgYmxvY2sgYW5kIGNhbGN1bGF0aW5nIHRoZSBtdWx0aXBsaWVyc1xuICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5wdXNoKHtcbiAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbixcbiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5taWxsaXNlY29uZHMsXG4gICAgICAgICAgICAnbXVsdGlwbGllcnMnOiBbXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIGNhbGN1bGF0aW5nIGFuZCBwb3B1bGF0aW5nIHRoZSBhcHBsaWNhYmxlIG11bHRwbGllcnMgb2YgZWFjaCB1bml0XG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyAxMCA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiB0aGlzLnRpbWVQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aCAtIDFdLm11bHRpcGxpZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZHJhd0J1dHRvbnNDYWxjdWxhdGVkKHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyk7XG4gIH1cblxuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY29udGV4dHVhbCBidXR0b25zIHVzaW5nXG4gICAqIHRoZSBlbmQgcG9pbnQgb2YgdGhlIHRpbWUtc2NhbGVcbiAgICovXG4gIGdlbmVyYXRlQ29udGV4dHVhbEJ1dHRvbnMgKCkge1xuICAgIC8vIGdlbmVyYXRpbmcgYW4gYXJyYXkgd2l0aCBhcHBsaWNhYmxlIFREIGJ1dHRvbnNcbiAgICB2YXIgYnV0dG9ucyA9IFtdLFxuICAgICAgaSA9IDAsXG4gICAgICBlbmRTdGFtcCA9IHRoaXMuZW5kRGF0YXNldCxcbiAgICAgIGRhdGVTdGFydCA9IG5ldyBEYXRlKGVuZFN0YW1wKSxcbiAgICAgIGRhdGVFbmQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG4gICAgZm9yICg7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoZW5kU3RhbXApO1xuICAgICAgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZVEQnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdZVEQnKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNVEQnKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnUVREJykge1xuICAgICAgICBjb25zb2xlLmxvZygnUVREJyk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgxMSAtIChkYXRlU3RhcnQuZ2V0TW9udGgoKSAlIDQpKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuICAgICAgICBjb25zb2xlLmxvZygnV1REJyk7XG4gICAgICAgIGRhdGVTdGFydC5zZXREYXRlKGRhdGVTdGFydC5nZXREYXRlKCkgLSBkYXRlU3RhcnQuZ2V0RGF5KCkpO1xuICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1knKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdZJyk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICBkYXRlU3RhcnQgLT0gODY0MDAwMDA7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdUJykge1xuICAgICAgICBjb25zb2xlLmxvZygnVCcpO1xuICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGVFbmQgPCBkYXRlU3RhcnQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlU3RhcnQgPSBkYXRlU3RhcnQudmFsdWVPZigpO1xuICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG4gICAgICAgIGJ1dHRvbnMucHVzaCh0aGlzLnRkQnV0dG9uc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gYnV0dG9ucztcbiAgICB0aGlzLmRyYXdCdXR0b25zQ29udGV4dHVhbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyk7XG4gIH1cblxuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIGFjdGl2ZSBwZXJpb2Qnc1xuICAgKiBzdGFydCBhbmQgZW5kIHBvaW50XG4gICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG4gICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBlbmQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuICAgKi9cbiAgc2V0QWN0aXZlUGVyaW9kIChzdGFydCwgZW5kKSB7XG4gICAgY29uc29sZS5sb2coc3RhcnQsIGVuZCk7XG4gICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IHN0YXJ0O1xuICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gZW5kO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5zdGFydEFjdGl2ZVdpbmRvdyk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmRBY3RpdmVXaW5kb3cpO1xuICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgKiBlbnRpcmUgdGltZS1saW5lXG4gICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICovXG4gIHNldFRpbWVsaW5lIChzdGFydCwgZW5kKSB7XG4gICAgY29uc29sZS5sb2coc3RhcnQsIGVuZCk7XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSBzdGFydDtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSBlbmQ7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0QWN0aXZlUmFuZ2UnKS5pbm5lckhUTUwgPSBuZXcgRGF0ZSh0aGlzLnN0YXJ0RGF0YXNldCk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZEFjdGl2ZVJhbmdlJykuaW5uZXJIVE1MID0gbmV3IERhdGUodGhpcy5lbmREYXRhc2V0KTtcbiAgICB0aGlzLmdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIGRyYXcgdGhlIGNhbGN1bGF0ZWQgYnV0dG9ucyBpbiB0aGUgY2FudmFzXG4gICAqIEBwYXJhbSAge2FycmF5fSBhcnJheSBvZiBvYmplY3RzIC0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBzdGFuZGFyZCBwZXJpb2RzIHRvIGJlIGRyYXduIGluZm9ybWF0aW9uXG4gICAqL1xuICBkcmF3QnV0dG9uc0NhbGN1bGF0ZWQgKHN0YW5kYXJkUGVyaW9kcykge1xuICAgIHZhciBjYWxjdWxhdGVkQnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxjdWxhdGVkJyksXG4gICAgICBidG4sXG4gICAgICBpID0gMCxcbiAgICAgIGogPSAwLFxuICAgICAgbXVsdGlwbGllclZhbHVlID0gMCxcbiAgICAgIHNlbGYgPSB0aGlzO1xuICAgIGNhbGN1bGF0ZWRCdXR0b25zLmlubmVySFRNTCA9ICcnO1xuICAgIGZvciAoaSA9IHN0YW5kYXJkUGVyaW9kcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgZm9yIChqID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpO1xuICAgICAgICBidG4uaWQgPSBzdGFuZGFyZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBzdGFuZGFyZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgICBidG4uaW5uZXJIVE1MID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgbXVsdGlwbGllclZhbHVlID0gc3RhbmRhcmRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICogc3RhbmRhcmRQZXJpb2RzW2ldLm1pbGxpc2Vjb25kcztcbiAgICAgICAgYnRuLm11bHRpcGxpZXJWYWx1ZSA9IG11bHRpcGxpZXJWYWx1ZTtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5lbmRBY3RpdmVXaW5kb3cgLSBldmVudC5zcmNFbGVtZW50Lm11bHRpcGxpZXJWYWx1ZSwgc2VsZi5lbmRBY3RpdmVXaW5kb3cpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuZW5kQWN0aXZlV2luZG93IC0gZXZlbnQuc3JjRWxlbWVudC5tdWx0aXBsaWVyVmFsdWUsIHNlbGYuZW5kQWN0aXZlV2luZG93KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zLmFwcGVuZENoaWxkKGJ0bik7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gZHJhdyB0aGUgY29udGV4dHVhbCBidXR0b25zLlxuICAgKiBAcGFyYW0gIHthcnJheX0gYXJyYXkgb2Ygb2JqZWN0cyAtIEFuIGFycmF5IG9mIG9iamVjdHMgd2l0aCB0aGUgc3RhbmRhcmQgcGVyaW9kcyB0byBiZSBkcmF3biBpbmZvcm1hdGlvblxuICAgKi9cbiAgZHJhd0J1dHRvbnNDb250ZXh0dWFsIChzdGFuZGFyZFBlcmlvZHMpIHtcbiAgICB2YXIgY29udGV4dHVhbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGV4dHVhbCcpLFxuICAgICAgYnRuLFxuICAgICAgaSA9IDAsXG4gICAgICBzZWxmID0gdGhpcztcbiAgICBjb250ZXh0dWFsQnV0dG9ucy5pbm5lckhUTUwgPSAnJztcbiAgICBjb25zb2xlLmxvZyhzdGFuZGFyZFBlcmlvZHMpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBzdGFuZGFyZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpO1xuICAgICAgYnRuLmlkID0gc3RhbmRhcmRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgIGJ0bi5pbm5lckhUTUwgPSBzdGFuZGFyZFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uO1xuICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnRCdG4uYmluZCh0aGlzLCBzdGFuZGFyZFBlcmlvZHNbaV0pKTtcbiAgICAgIGNvbnRleHR1YWxCdXR0b25zLmFwcGVuZENoaWxkKGJ0bik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGV2ZW50QnRuIChvYmopIHtcbiAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKG9iai5kYXRlU3RhcnQsIG9iai5kYXRlRW5kKTtcbiAgICAgIGNvbnNvbGUubG9nKG9iai5kYXRlU3RhcnQsIG9iai5kYXRlRW5kKTtcbiAgICB9XG4gICAgdGhpcy5zdGFuZGFyZENvbnRleHR1YWxQZXJpb2RzID0gW107XG4gIH1cblxuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBkcmF3IHRoZSBBTEwgYnV0dG9uLlxuICAgKiBAcGFyYW0gIHthcnJheX0gYXJyYXkgb2Ygb2JqZWN0cyAtIEFuIGFycmF5IG9mIG9iamVjdHMgd2l0aCB0aGUgc3RhbmRhcmQgcGVyaW9kcyB0byBiZSBkcmF3biBpbmZvcm1hdGlvblxuICAgKi9cbiAgZHJhd0J1dHRvbkFsbCAoc3RhbmRhcmRQZXJpb2RzKSB7XG4gICAgdmFyIGFsbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxsQnV0dG9uJyksXG4gICAgICBidG4sXG4gICAgICBzZWxmID0gdGhpcztcbiAgICBhbGxCdXR0b25zLmlubmVySFRNTCA9ICcnO1xuICAgIGNvbnNvbGUubG9nKHN0YW5kYXJkUGVyaW9kcyk7XG4gICAgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyk7XG4gICAgYnRuLmlkID0gJ2FsbCc7XG4gICAgYnRuLmlubmVySFRNTCA9ICdBTEwnO1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgfSk7XG4gICAgYWxsQnV0dG9ucy5hcHBlbmRDaGlsZChidG4pO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBvYmplY3QgdG8gc2V0IHRoZSB1c2VyIHByZWZlcmVuY2VzXG4gICAqL1xuICBjb25maWd1cmUgKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAqL1xuICBpbml0IChyZXF1aXJlKSB7XG4gICAgcmVxdWlyZSgnWC1BeGlzJywgJ1ktQXhpcycsICdncmFwaGljcycsICdjaGFydCcsICdleHRlbnNpb25EYXRhJywgJ2RhdGVGb3JtYXR0ZXInLFxuICAgICAgZnVuY3Rpb24gKHgsIHksIGdyYXBoaWNzLCBjaGFydCwgZXh0RGF0YSwgZGF0ZUZvcm1hdHRlcikge1xuXG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuICAgKi9cbiAgcGxhY2VJbkNhbnZhcyAoKSB7fVxuXG4gIC8qKlxuICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuICAgKi9cbiAgZHJhdyAoKSB7XG4gICAgLy8gZHJhd2luZyBvZiB0aGUgc3RhbmRhcmQgdGltZSBwZXJpb2RzIGhhcHBlbnMgaGVyZVxuICB9XG5cbiAgLyoqXG4gICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAqL1xuICBkaXNwb3NlICgpIHt9XG59XG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcjtcbn0gZWxzZSB7XG4gIHdpbmRvdy5TdGFuZGFyZFBlcmlvZCA9IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==
!function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=a(2);!function(a,n){"object"===e(t)&&t.exports?t.exports=a.document?n(a):function(t){if(!t.document)throw new Error("Window with document not present");return n(t,!0)}:a.StandardPeriodSelector=n(a,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var a=t.FusionCharts;a.register("extension",["private","standard-period-selector",function(){a.registerComponent("extensions","standard-period-selector",n({FusionCharts:a}))}])})}).call(e,a(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();t.exports=function(t){var e=function(){function t(){a(this,t);var e=this;e.ratio=8,e.toolbox=FusionCharts.getComponent("api","toolbox"),e.HorizontalToolbar=e.toolbox.HorizontalToolbar,e.ComponentGroup=e.toolbox.ComponentGroup,e.SymbolStore=e.toolbox.SymbolStore,e.all=1,e.calculatedPeriods=[],e.startDataset=0,e.startActiveWindow=0,e.endActiveWindow=1,e.standardCalculatedPeriods=[],e.standardContexualPeriods=[],e.startPointUnit=0,e.startPointMultiplier=0,e.noCalcButtons=0,e.minimumBucket=1,e.buttonGroup={},e.toolbar={},e.categoryClicked,e.btns={contextualObj:{},calculatedObj:{}},e.tdButtons=[{name:"YTD",abbreviation:"YTD",parent:"year",milliseconds:31104e6,description:"Year till Date"},{name:"QTD",abbreviation:"QTD",parent:"month",multiplier:3,milliseconds:7776e6,description:"Quarter till Date"},{name:"MTD",abbreviation:"MTD",parent:"month",milliseconds:2592e6,description:"Month till Date"},{name:"WTD",abbreviation:"WTD",parent:"day",multiplier:7,milliseconds:6048e5,description:"Week till Date"},{name:"Y",abbreviation:"Y",parent:"day",milliseconds:864e5,description:"Yesterday"},{name:"T",abbreviation:"T",parent:"day",milliseconds:864e5,description:"Today"}],e.config={anchorPositions:"right",all:"1",contextual:"1",calculated:"1",tertiaryTimePeriods:{}},e._babTimer=0,e.propsChangeListener=function(t,a){e.startActiveWindow=t[1],e.endActiveWindow=a[1],e._babTimer?e.updatePending||(e.updatePending=!0,setTimeout(function(){e.updatePending=!1,e.onActiveRangeChange()},e._babTimer)):(e._babTimer=200,e.onActiveRangeChange())}}return n(t,[{key:"hideAllCalcBtns",value:function(){var t,e=this,a=e.btns.calculatedObj;for(t in a)a[t].btn.hide()}},{key:"showApplicableCalculatedButtons",value:function(){var t,e,a,n,i=this,o=0,s=0,r=0,l=0,c=i.endActiveWindow-i.startActiveWindow,d=i.anchorPositions,u=i.btns.calculatedObj,b=i.timePeriods,p=0,g=[],m=i.minimumBucket,h=i.maximumBucket;for("right"===d?t=i.endActiveWindow-i.startDataset:"left"===d&&(t=i.endDataset-i.startActiveWindow),i.hideAllCalcBtns(),o=0,s=b.length;o<s;o++)if(p=b[o].interval,a=b[o].name,n=b[o].abbreviation.single,t/p>=1)if(Math.floor(c/p)<1)g.push({name:a,abbreviation:n,multipliers:[1]});else for(g.push({name:a,abbreviation:n,multipliers:[]}),r=0,l=b[o].multipliers.length;r<l;r++)c/i.ratio<b[o].multipliers[r]*p&&b[o].multipliers[r]*p>m&&b[o].multipliers[r]*p<h&&g[g.length-1].multipliers.push(b[o].multipliers[r]);for(o=0,s=g.length;o<s;o++)for(r=0,l=g[o].multipliers.length;r<l;r++)e=g[o].multipliers[r]+g[o].name,u[e]&&u[e].btn&&u[e].btn.show();i.standardCalculatedPeriods=g,i.toolbar&&i.toolbar.redraw(),i.state?i.buttonGroup.setState&&i.buttonGroup.setState(i.state):i.buttonGroup.setState&&i.buttonGroup.setState(null)}},{key:"highlightActiveRange",value:function(){var t,e=this,a=e.clickedId,n=e.btns.contextualObj,i=e.btns.calculatedObj;t=n[a]||i[a]||e.btns[a],t&&t.btn?(e.buttonGroup.setState(t.btn),e.state=t.btn):e.buttonGroup.setState(null)}},{key:"onActiveRangeChange",value:function(){var t,e,a,n=this,i=n.categoryClicked,o=n.clickedId,s=n.startDataset,r=n.endDataset,l=n.startActiveWindow,c=n.endActiveWindow,d=n.btns.contextualObj,u=n.btns.calculatedObj;if("ALL"===i)s===l&&r===c||(delete n.clickedId,delete n.categoryClicked);else if("contextual"===i)a=d[o],!a||l===a.contextStart&&c===a.contextEnd||(delete n.clickedId,delete n.categoryClicked);else if("calculated"===i)a=u[o],a&&c-l!==a.interval&&(delete n.clickedId,delete n.categoryClicked);else if(s===l&&r===c)n.clickedId="ALL",n.categoryClicked="ALL";else{for(t in d)a=d[t],l===a.contextStart&&c===a.contextEnd&&(n.clickedId=t,n.categoryClicked="contextual",e=!0);if(!e)for(t in u)a=u[t],c-l===a.interval&&(n.clickedId=t,n.categoryClicked="calculated");e||delete n.state}n.toolbarDrawn&&(n.showApplicableCalculatedButtons(),n.highlightActiveRange())}},{key:"processMultipliers",value:function(t,e){for(var a=0,n=t.length;a<n;a++){var i=t[a].possibleFactors.length,o=t[a]&&t[a].name,s=t&&t[a];s.multipliers=[],void 0===e&&(e={}),e[o]?s.multipliers=e[o]:1===i?s.multipliers.push(s.possibleFactors[0]):2===i?(s.multipliers.push(s.possibleFactors[0]),s.multipliers.push(s.possibleFactors[i-1])):(s.multipliers.push(s.possibleFactors[0]),s.multipliers.push(Math.floor(s.possibleFactors[i-1]/2)),s.multipliers.push(s.possibleFactors[i-1]))}return t}},{key:"createCalculatedButtons",value:function(t){for(var e,a=this,n=a.btns.calculatedObj,i=a.anchorPositions,o=a.minimumBucket,s=a.maximumBucket,r=a.globalReactiveModel.model,l={},c=a.timePeriods.length-1;c>=0;c--)for(var d=function(d){var u=a.timePeriods[c].multipliers[d],b=u+a.timePeriods[c].abbreviation.single,p=u+a.timePeriods[c].name,g=u+" "+a.timePeriods[c].name+(u>1?"s":""),m=a.timePeriods[c].multipliers[d]*a.timePeriods[c].interval;m>o&&m<s&&(e=n[p]={interval:m,fn:function(){a.clickedId=p,a.categoryClicked="calculated",a.highlightActiveRange(),"right"===i?r["x-axis-absolute-range-start"]>a.endActiveWindow-m?a.globalReactiveModel.lock().prop("x-axis-visible-range-end",r["x-axis-absolute-range-start"]+m).prop("x-axis-visible-range-start",a.startDataset).unlock():r["x-axis-visible-range-start"]=a.endActiveWindow-m:r["x-axis-absolute-range-end"]<a.startActiveWindow+m?a.globalReactiveModel.lock().prop("x-axis-visible-range-end",a.endDataset).prop("x-axis-visible-range-start",r["x-axis-absolute-range-end"]-m).unlock():r["x-axis-visible-range-end"]=a.startActiveWindow+m},shortKey:b},l[p]={text:b,config:{toolText:g,height:22,radius:1,margin:{left:-4.5}},group:t,eventListeners:{click:e.fn}},a.btns.calculatedObj[p]=e)},u=a.timePeriods[c].multipliers.length-1;u>=0;u--)d(u);a.createD3Buttons(l,"calculatedObj")}},{key:"generateCtxBtnList",value:function(){var t=this,e=t.standardContexualPeriods,a=0,n=0,i=t.globalReactiveModel.model["x-axis-absolute-range-end"],o=i-2,s=i,r={},l=t.tdButtons,c=t.minimumBucket||1,d=t.startActiveWindow,u=t.endActiveWindow;for(n=l.length;a<n;a++)o=new Date(i),"YTD"===l[a].name?(o.setMonth(0),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"MTD"===l[a].name?(o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"QTD"===l[a].name?(o.setMonth(11-o.getMonth()%4),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"WTD"===l[a].name?(o.setDate(o.getDate()-o.getDay()),o.setHours(0),o.setMinutes(0),o.setSeconds(0)):"Y"===l[a].name?(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o-=864e5):"T"===l[a].name&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),i===+o&&(o=+o-864e5)),s<o&&s-o<c||(l[a].dateStart=o.valueOf(),l[a].dateEnd=s.valueOf(),e.push(l[a]));for(r.milliseconds=1/0,a=0,n=l.length;a<n;a++)Math.abs(l[a].milliseconds-(u-d))<r.milliseconds&&(r.milliseconds=l[a].milliseconds,r.name=l[a].abbreviation)}},{key:"createContextualButtons",value:function(t){var e,a,n=this,i=n.btns.contextualObj,o=0,s={};n.generateCtxBtnList();for(var r=function(r,l){return n.standardContexualPeriods[r].dateEnd-n.standardContexualPeriods[r].dateStart>=n.minimumBucket&&n.standardContexualPeriods[r].dateStart>n.startDataset?(a=n.standardContexualPeriods[r].abbreviation,e=i[a]={contextStart:n.standardContexualPeriods[r].dateStart,contextEnd:n.standardContexualPeriods[r].dateEnd,fn:function(){n.categoryClicked="contextual",n.clickedId=n.standardContexualPeriods[r].abbreviation,n.highlightActiveRange(),n.globalReactiveModel.lock().prop("x-axis-visible-range-end",n.standardContexualPeriods[r].dateEnd).prop("x-axis-visible-range-start",n.standardContexualPeriods[r].dateStart).unlock()}},s[n.standardContexualPeriods[r].abbreviation]={text:n.standardContexualPeriods[r].abbreviation,config:{toolText:n.standardContexualPeriods[r].description,height:22,radius:1,margin:{left:o}},group:t,eventListeners:{click:e.fn}},o=-5,void(n.btns.contextualObj[n.standardContexualPeriods[r].abbreviation]=e)):"continue"},l=0,c=this.standardContexualPeriods.length;l<c;l++){r(l,c)}n.createD3Buttons(s,"contextualObj")}},{key:"addCssRules",value:function(t,e){var a,n,i=this.graphics.paper;for(a in t)switch(n=t[a],a){case"container":e.container&&i.cssAddRule("."+n,e.container.style);break;case"text":e.text&&i.cssAddRule("."+n,e.text.style)}}},{key:"createD3Buttons",value:function(t,e){var a,n,i,o,s,r,l,c=this.extData.button,d=this.graphics.paper,u=d.getInstances().d3,b=this;for(a in t){n=t[a],i=n.text,o=n.config,e?(b.btns[e][a]||(b.btns[e][a]={}),l=b.btns[e][a].btn=u.button(i).setConfig(o)):(b.btns[a]||(b.btns[a]={}),l=b.btns[a].btn=u.button(i).setConfig(o)),l.namespace("fusioncharts"),l.appendSelector("standarperiodselector"),b.addCssRules(l.getIndividualClassNames(l.getClassName()),c),s=c.states;for(r in s)b.addCssRules(l.getIndividualClassNames(l.config.states[r]),c.states[r]);n.eventListeners&&l.attachEventHandlers({click:n.eventListeners.click.bind(l)}),n.group.addSymbol(l)}}},{key:"createD3Labels",value:function(t){var e,a,n,i,o=this.extData.label,s=this,r={paper:s.graphics.paper,chart:s.chart,smartLabel:s.smartLabel,chartContainer:s.graphics.container};for(e in t)a=t[e],n=a.text,i=a.config,s[e]=new s.toolbox.Label(n,r,i),s.addCssRules(s[e].getIndividualClassNames(s[e].getClassName()),o),a.group.addSymbol(s[e])}},{key:"createToolbar",value:function(){var t,e,a,n,i,o,s,r,l=this,c=l.graphics.paper,d={paper:l.graphics.paper,chart:l.chart,smartLabel:l.smartLabel,chartContainer:l.graphics.container};e=new l.HorizontalToolbar(d),e.setConfig({fill:"#fff",borderThickness:0}),s=new l.toolbox.ComponentGroup(d),t=new l.toolbox.UniSelectComponentGroup(d),t.defineStateIndicator(function(t){var e=t.getBBox(),a=e.x,n=a+e.width,i=e.y+e.height;return{type:"path",attrs:{d:["M",a+1,i-1.2,"L",n,i-1.2].join(" "),"stroke-width":2,stroke:"#c95a5a"}}}),r=new l.toolbox.ComponentGroup(d),t.setConfig({fill:"#fff",borderThickness:0}),s.setConfig({fill:"#fff",borderThickness:0}),n={ZOOM:{text:"Zoom:",config:{className:"standard-period-selector-"+c.getId(),height:22,margin:{right:-12}},group:s}},l.createD3Labels(n),a=l.allButtonShow&&{fn:function(){l.clickedId="ALL",l.state=this,l.categoryClicked="ALL",l.highlightActiveRange(),l.globalReactiveModel.lock().prop("x-axis-visible-range-end",l.endDataset).prop("x-axis-visible-range-start",l.startDataset).unlock()}},o={ALL:{text:"ALL",config:{height:22,radius:1,toolText:"Full Data",margin:{right:10}},group:t,eventListeners:{click:a.fn}}},i={dummy:{text:"___",config:{height:22,radius:1},group:r}},a&&(l.btns.ALL=a,l.createD3Buttons(o));for(var u=0;u<6;u++)l.btns.dummy={},l.createD3Buttons(i,"dummy");return e.addComponent(s),e.addComponent(t),e.addComponent(r),l.toolbar=e,l.dummyButtonGroup=r,l.buttonGroup=t,e}},{key:"appendButtons",value:function(){var t=this,e=t.buttonGroup;Object.keys(t.btns.calculatedObj).length||t.calculatedButtonShow&&t.createCalculatedButtons(e),Object.keys(t.btns.contextualObj).length||t.contextualButtonShow&&t.createContextualButtons(e)}},{key:"init",value:function(t){var e=this;return t(["graphics","chart","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","extData","chartInstance","customExtremes",function(t,a,n,i,o,s,r,l,c,d,u){e.graphics=t,e.chart=a,e.markerManager=i,e.canvasConfig=n,e.reactiveModel=o,e.globalReactiveModel=s,e.spaceManagerInstance=r,e.smartLabel=l,e.extDataUser=c,e.chartInstance=d,e.customExtremes=u}]),e.extData={disabled:!1,"default-select":"ALL","all-button":!0,"contextual-button":!0,"calculated-button":!0,posWrtCanvas:"top","anchor-align":"right",layout:"inline",alignment:"left",orientation:"horizontal",customMultipliers:{millisecond:[1,500],second:[1,5,15,30],minute:[1,5,15,30],hour:[1,3,6,12],day:[1,7,15],month:[1,3,6],year:[1,3,5]},button:{height:22,radius:1,className:"standard-period-selector",container:{style:{fill:"#FFFFFF","stroke-width":"1px",stroke:"#CED5D4",labelFill:"#4b4b4b",strokeWidth:"1px"}},text:{style:{fontFamily:'"Lucida Grande", sans-serif',"font-size":"13px",fill:"#4b4b4b","line-height":"1px","letter-spacing":"-0.04em"}},states:{hover:{className:"standard-period-selector-state-hover",container:{style:{cursor:"pointer",fill:"#f7f7f7"}}}}},label:{height:22,className:"standard-period-selector-label",text:{style:{"font-weight":"bold","font-family":'"Lucida Grande", Regular',"font-size":"13px",fill:"#4b4b4b"}}}},Object.assign(e.extData,e.extDataUser),e.endActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-end"],e.startActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-start"],e.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],e.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],e.maximumBucket=e.endDataset-e.startDataset,e.timeRules=e.chartInstance.apiInstance.getComponentStore(),e.timeRules=e.timeRules.getCanvasByIndex(0).composition.impl,e.timeRules=e.timeRules.getDataAggregator(),e.timeRules=e.timeRules.getAggregationTimeRules(),e.timePeriods=e.processMultipliers(e.timeRules,e.extData.customMultipliers),e.allButtonShow=e.extData["all-button"],e.calculatedButtonShow=e.extData["calculated-button"],e.contextualButtonShow=e.extData["contextual-button"],e.anchorPositions=e.extData["anchor-align"],e.customMultipliers=e.extData.customMultipliers,e.keySelect=e.extData["default-select"],e.measurement={},e.flag=!0,e.toolbars=[],e.toolbars.push(e.createToolbar()),e.globalReactiveModel.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],e.propsChangeListener),e.globalReactiveModel.onPropChange("x-axis-absolute-range-end",function(t){"contextual"===e.categoryClicked&&(e.globalReactiveModel.model["x-axis-visible-range-end"]=e.globalReactiveModel.model["x-axis-absolute-range-end"])}),e}},{key:"getLogicalSpace",value:function(){var t,e,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._pWidth,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pHeight,o=0,s=0,r=this;for(e=0,a=r.toolbars.length;e<a;e++)t=r.toolbars[e].getLogicalSpace(n,i),o=Math.max(t.width,o),s+=t.height,r.toolbars[e].width=t.width,r.toolbars[e].height=t.height;return s+=r.padding,{width:o,height:s}}},{key:"getDefaultGroup",value:function(){return this.parentGroup}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"standard-period-selector-ext"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[t.extData.layout]||"inline"},orientation:[{type:function(e){return e[t.extData.orientation]||"horizontal"},position:[{type:function(e){return e[t.extData.posWrtCanvas]||"top"},alignment:[{type:function(e){return e[t.extData.alignment]||"left"},dimensions:[function(){var e=this.getParentComponentGroup();return t._ref=this,t.getLogicalSpace(t._pWidth=e.getWidth(),t._pHeight=e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,a,n,i){var o=this.measurement;return o.x=t,o.y=e,o.width=a,o.height=n,this.parentGroup=i,this}},{key:"draw",value:function(t,e,a,n,i){var o,s,r,l,c,d,u=this,b=u.measurement,p=u.toolbars,g=u.btns.contextualObj,m=u.btns.calculatedObj,h=u.clickedId,f=u.globalReactiveModel.model,v=u.minimumBucket,x=u.buttonGroup;if(v=f["minimum-consecutive-datestamp-diff"]*f["x-axis-maximum-allowed-ticks"],u.minimumBucket=v,u.dummyButtonGroup.dispose(),p[0].removeComponent(u.dummyButtonGroup),u.appendButtons(),x.getLogicalSpace(),!Object.keys(u.customExtremes).length&&u.keySelect){if("ALL"===u.keySelect)u.clickedId="ALL",u.state=u.btns.ALL.btn;else if(g[u.keySelect])u.clickedId=u.keySelect;else{c=!0;for(d in m)c&&m[d].shortKey===u.keySelect&&(u.clickedId=d,c=!1)}delete u.keySelect,h=u.clickedId}if(t=void 0===t?b.x:t,e=void 0===e?b.y:e,a=void 0===a?b.width:a,n=void 0===n?b.height:n,i=void 0===i?this.parentGroup:i,a&&n){for(s=0,o=p.length;s<o;s++)r=p[s],r.draw(t,e,i),u.toolbarDrawn=!0;h?(l=m[h]||g[h]||u.btns[h],l?l.fn&&l.fn():u.onActiveRangeChange()):u.onActiveRangeChange()}}}]),t}();return e}}]);
//# sourceMappingURL=standard-period-selector-es5.min.js.map
!function(t){function e(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return t[a].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(2);window.stPS=new a,function(i,a){"object"===e(t)&&t.exports?t.exports=i.document?a(i):function(t){if(!t.document)throw new Error("Window with document not present");return a(t,!0)}:i.StandardPeriodSelector=a(i,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var i=t.FusionCharts;i.register("extension",["private","standard-period-selector",function(){i.registerComponent("extensions","standard-period-selector",a({FusionCharts:i}))}])})}).call(e,i(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();t.exports=function(t){var e=function(){function t(){i(this,t),this.ratio=8,this.toolbox=FusionCharts.getComponent("api","toolbox"),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.all=1,this.calculatedPeriods=[],this.startDataset=0,this.startActiveWindow=0,this.endActiveWindow=1,this.standardCalculatedPeriods=[],this.standardContexualPeriods=[],this.startPointUnit=0,this.startPointMultiplier=0,this.clickedId="ALL",this.noCalcButtons=0,this.calculatedButtonObj={},this.tdButtons=[{name:"YTD",abbreviation:"YTD",parent:"year",milliseconds:31104e6,description:"Year to Date"},{name:"QTD",abbreviation:"QTD",parent:"month",multiplier:3,milliseconds:7776e6,description:"Quarter to Date"},{name:"MTD",abbreviation:"MTD",parent:"month",milliseconds:2592e6,description:"Month to Date"},{name:"WTD",abbreviation:"WTD",parent:"day",multiplier:7,milliseconds:6048e5,description:"Week to Date"},{name:"Y",abbreviation:"Y",parent:"day",milliseconds:864e5,description:"Yesterday"},{name:"T",abbreviation:"T",parent:"day",milliseconds:864e5,description:"Today"}],this.config={anchorPositions:"right",all:"1",contextual:"1",calculated:"1",tertiaryTimePeriods:{}}}return a(t,[{key:"generateCalculatedButtons",value:function(){var t=this.endActiveWindow-this.startDataset,e=0,i=0,a=this.endActiveWindow-this.startActiveWindow,s=0;for(this.standardCalculatedPeriods=[],e=0;e<this.timePeriods.length;e++)if(t/this.timePeriods[e].interval>=1)if(Math.floor(a/this.timePeriods[e].interval)<1)this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation.single,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].interval,name:this.timePeriods[e].name,multipliers:[1]});else for(this.standardCalculatedPeriods.push({abbreviation:this.timePeriods[e].abbreviation.single,description:this.timePeriods[e].description,milliseconds:this.timePeriods[e].interval,name:this.timePeriods[e].name,multipliers:[]}),i=0;i<this.timePeriods[e].multipliers.length;i++)a/this.ratio<this.timePeriods[e].multipliers[i]*this.timePeriods[e].interval&&this.standardCalculatedPeriods[this.standardCalculatedPeriods.length-1].multipliers.push(this.timePeriods[e].multipliers[i]);for(this.noCalcButtons=1/0,e=0;e<this.standardCalculatedPeriods.length;e++)for(i=0;i<this.standardCalculatedPeriods[e].multipliers.length;i++)++s,this.noCalcButtons>e&&(this.noCalcButtons=e),s<=4&&(this.startPointMultiplier=i,this.startPointUnit=e)}},{key:"generateContextualButtons",value:function(){for(var t=[],e=0,i=this.globalReactiveModel.model["x-axis-absolute-range-end"],a=i-2,s=i,o={};e<this.tdButtons.length;e++)a=new Date(i),"YTD"===this.tdButtons[e].name?(a.setMonth(0),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"MTD"===this.tdButtons[e].name?(a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"QTD"===this.tdButtons[e].name?(a.setMonth(11-a.getMonth()%4),a.setDate(0),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"WTD"===this.tdButtons[e].name?(a.setDate(a.getDate()-a.getDay()),a.setHours(0),a.setMinutes(0),a.setSeconds(0)):"Y"===this.tdButtons[e].name?(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a-=864e5):"T"===this.tdButtons[e].name&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),+this.endDataset===+a&&(a=+a-864e5)),s<a||(this.tdButtons[e].dateStart=a.valueOf(),this.tdButtons[e].dateEnd=s.valueOf(),t.push(this.tdButtons[e]));for(o.milliseconds=1/0,e=0;e<this.tdButtons.length;e++)Math.abs(this.tdButtons[e].milliseconds-(this.endActiveWindow-this.startActiveWindow))<o.milliseconds&&(o.milliseconds=this.tdButtons[e].milliseconds,o.name=this.tdButtons[e].abbreviation);this.standardContexualPeriods=t}},{key:"processMultipliers",value:function(t){for(var e=this,i=0;i<t.length;i++){var a=t[i].possibleFactors.length;t[i].multipliers=[],e.extData.customMultiplers[t[i].name]?t[i].multipliers=e.extData.customMultiplers[t[i].name]:1===a?t[i].multipliers.push(t[i].possibleFactors[0]):2===a?(t[i].multipliers.push(t[i].possibleFactors[0]),t[i].multipliers.push(t[i].possibleFactors[a-1])):(t[i].multipliers.push(t[i].possibleFactors[0]),t[i].multipliers.push(Math.floor(t[i].possibleFactors[a-1]/2)),t[i].multipliers.push(t[i].possibleFactors[a-1]))}return t}},{key:"setActivePeriod",value:function(){var t,e;1===arguments.length?(e=this.globalReactiveModel.model["x-axis-visible-range-end"],t=e-arguments[0]):2===arguments.length&&(t=arguments[0],e=arguments[1]),this.startActiveWindow=t,this.endActiveWindow=e,this.generateCalculatedButtons(),this.globalReactiveModel.model["x-axis-visible-range-start"]=this.startActiveWindow,this.globalReactiveModel.model["x-axis-visible-range-end"]=this.endActiveWindow,this.generateContextualButtons()}},{key:"configure",value:function(t){this.config=t}},{key:"init",value:function(t){var e=this;return t(["xAxis","yAxis","graphics","chart","dataset","PlotManager","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","extData","chartInstance",function(t,i,a,s,o,n,r,l,d,c,h,u,p,m){e.xAxis=t,e.yAxis=i,e.graphics=a,e.chart=s,e.dataset=o,e.plotManager=n,e.markerManager=l,e.canvasConfig=r,e.reactiveModel=d,e.globalReactiveModel=c,e.spaceManagerInstance=h,e.smartLabel=u,e.extData=p,e.chartInstance=m}]),this.spaceManagerInstance=e.spaceManagerInstance,this.globalReactiveModel=e.globalReactiveModel,this.endActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-end"],this.startActiveWindow=e.globalReactiveModel.model["x-axis-visible-range-start"],this.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],this.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],this.timeRules=this.chartInstance.apiInstance.getComponentStore(),this.timeRules=this.timeRules.getCanvasByIndex(0).composition.impl,this.timeRules=this.timeRules.getDataAggregator(),this.timeRules=this.timeRules.getAggregationTimeRules(),this.timePeriods=this.processMultipliers(this.timeRules),this.setActivePeriod(this.startActiveWindow,this.endActiveWindow),this.toolbars=[],this.measurement={},this.flag=!0,this.toolbars.push(this.createToolbar()),this.globalReactiveModel.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],function(t,i){if(e.flag){e.flag=!1,e.setActivePeriod(t[1],i[1]);for(var a=0;a<e.standardCalculatedPeriods.length;a++)for(var s=0;s<e.standardCalculatedPeriods[a].multipliers.length;s++)i[1]-t[1]>=e.timePeriods[a].multipliers[s]*e.timePeriods[a].interval;e.toolbar.dispose(),e.toolbars.pop(),e.toolbars.push(e.createToolbar()),e.getLogicalSpace(),e.draw()}}),this}},{key:"createToolbar",value:function(){var t,e,i,a,s,o,n,r,l,d,c,h,u=this,p=this,m=[];for(h=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t=new this.toolbox.UniSelectComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t.setConfig({fill:"#fff",borderThickness:0}),h.setConfig({fill:"#fff",borderThickness:0}),e=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),e.setConfig({fill:"#fff",borderThickness:0}),c=new this.toolbox.Label("Zoom:",{smartLabel:this.smartLabel,paper:this.graphics.paper},p.extData.style["label-config"]),h.addSymbol(c),s=new this.toolbox.Symbol("ALL",!0,{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},p.extData.style["all-config"]).attachEventHandlers({click:function(){p.setActivePeriod(p.startDataset,p.endDataset),e.dispose(),p.clickedId="ALL"},tooltext:"ALL"}),t.addSymbol(s),r=0;r<this.standardCalculatedPeriods.length;r++)for(l=this.standardCalculatedPeriods[r].multipliers.length-1;l>=0;l--)m.push(p.standardCalculatedPeriods[r].multipliers[l]*p.standardCalculatedPeriods[r].milliseconds);i={};for(var b in this.calculatedButtonObj)this.calculatedButtonObj[b].hide();for(var g=function(e){o=e===p.startPointUnit?p.startPointMultiplier:p.standardCalculatedPeriods[e].multipliers.length-1;for(var a=function(a){var s=p.standardCalculatedPeriods[e].multipliers[a]+p.standardCalculatedPeriods[e].abbreviation;void 0===u.calculatedButtonObj[s]&&(i=new u.toolbox.Symbol(s,!0,{paper:u.graphics.paper,chart:u.chart,smartLabel:u.smartLabel,chartContainer:u.graphics.container},p.extData.style["calculated-config"]).attachEventHandlers({click:function(){n=p.standardCalculatedPeriods[e].multipliers[a]*p.standardCalculatedPeriods[e].milliseconds,p.clickedId=p.standardCalculatedPeriods[e].multipliers[a]+p.standardCalculatedPeriods[e].abbreviation,p.setActivePeriod(n)},tooltext:p.standardCalculatedPeriods[e].multipliers[a]+" "+p.standardCalculatedPeriods[e].description}),u.calculatedButtonObj[s]=i),u.calculatedButtonObj[s].show(),t.addSymbol(u.calculatedButtonObj[s])},s=o;s>=0;s--)a(s)},f=p.startPointUnit;f>=0;f--)g(f);a=[];for(var v=function(e){d=0===e?p.extData.style["contextual-config-first"]:p.extData.style["contextual-config"],a[e]=new u.toolbox.Symbol(u.standardContexualPeriods[e].abbreviation,!0,{paper:u.graphics.paper,chart:u.chart,smartLabel:u.smartLabel,chartContainer:u.graphics.container},d).attachEventHandlers({click:function(){p.setActivePeriod(p.standardContexualPeriods[e].dateStart,p.standardContexualPeriods[e].dateEnd),p.clickedId=p.standardContexualPeriods[e].abbreviation},tooltext:u.standardContexualPeriods[e].description}),t.addSymbol(a[e])},x=0;x<this.standardContexualPeriods.length;x++)v(x);return this.SymbolStore.register("textBoxIcon",function(t,e,i,a,s,o,n){var r=t-a/2+o/2,l=t+a/2-o/2,d=e-s/2+n/2,c=e+s/2-n/2;return["M",r,d,"L",l,d,"L",l,c,"L",r,c,"Z"]}),e.addComponent(h),e.addComponent(t),this.toolbar=e,e}},{key:"getLogicalSpace",value:function(){var t,e,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._pWidth,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._pHeight,o=420,n=0;for(e=0,i=this.toolbars.length;e<i;e++)t=this.toolbars[e].getLogicalSpace(a,s),n+=t.height,this.toolbars[e].width=t.width,this.toolbars[e].height=t.height;return n+=this.padding,{width:o,height:n}}},{key:"getDefaultGroup",value:function(){return this.parentGroup}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"standard-period-selector-ext"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[t.extData.layout]},orientation:[{type:function(e){return e[t.extData.orientation]},position:[{type:function(e){return e[t.extData.posWrtCanvas]},alignment:[{type:function(e){return e[t.extData.alignment]},dimensions:[function(){var e=this.getParentComponentGroup();return t._ref=this,t.getLogicalSpace(t._pWidth=e.getWidth(),t._pHeight=e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,i,a,s){var o=this.measurement;return o.x=t,o.y=e,o.width=i,o.height=a,this.parentGroup=s,this}},{key:"draw",value:function(t,e,i,a,s){var o,n,r,l,d,c,h,u,p,m=this.measurement,b=this.toolbars;if(this.flag=!0,p=this.saveSelectLine||this.graphics.paper.path({stroke:"#c95a5a","stroke-width":"2px"}).toFront(),t=void 0===t?m.x:t,e=void 0===e?m.y:e,i=void 0===i?m.width:i,a=void 0===a?m.height:a,s=void 0===s?this.parentGroup:s,i&&a)for(n=0,o=b.length;n<o;n++)r=b[n],r.draw(t,e,s);this.saveSelectLine=p;for(var g=0,f=b[0].componentGroups[1].symbolList;g<f.length;g++)f[g].symbol===this.clickedId&&(l=f[g].getBoundElement(),d=l.getBBox(),c=d.x,h=d.x2,u=d.y2,p.attr({path:["M",c-.5,u-.5,"L",h+.5,u-.5]}))}}]),t}();return e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGM0OGRmMjQyYmU4Yjk5ZmQ1NTljIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9zdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3IuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJTdGFuZGFyZFBlcmlvZFNlbGVjdG9yIiwid2luZG93Iiwic3RQUyIsImVudiIsImZhY3RvcnkiLCJkb2N1bWVudCIsIndpbiIsIkVycm9yIiwidW5kZWZpbmVkIiwiX3dpbmRvdyIsIndpbmRvd0V4aXN0cyIsIkZDIiwiRnVzaW9uQ2hhcnRzIiwicmVnaXN0ZXIiLCJyZWdpc3RlckNvbXBvbmVudCIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIiwiY2hpbGRyZW4iLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsImRlcCIsInRoaXMiLCJyYXRpbyIsInRvb2xib3giLCJnZXRDb21wb25lbnQiLCJIb3Jpem9udGFsVG9vbGJhciIsIkNvbXBvbmVudEdyb3VwIiwiU3ltYm9sU3RvcmUiLCJhbGwiLCJjYWxjdWxhdGVkUGVyaW9kcyIsInN0YXJ0RGF0YXNldCIsInN0YXJ0QWN0aXZlV2luZG93IiwiZW5kQWN0aXZlV2luZG93Iiwic3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyIsInN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyIsInN0YXJ0UG9pbnRVbml0Iiwic3RhcnRQb2ludE11bHRpcGxpZXIiLCJjbGlja2VkSWQiLCJub0NhbGNCdXR0b25zIiwiY2FsY3VsYXRlZEJ1dHRvbk9iaiIsInRkQnV0dG9ucyIsIm5hbWUiLCJhYmJyZXZpYXRpb24iLCJwYXJlbnQiLCJtaWxsaXNlY29uZHMiLCJkZXNjcmlwdGlvbiIsIm11bHRpcGxpZXIiLCJjb25maWciLCJhbmNob3JQb3NpdGlvbnMiLCJjb250ZXh0dWFsIiwiY2FsY3VsYXRlZCIsInRlcnRpYXJ5VGltZVBlcmlvZHMiLCJ2YWx1ZSIsInRhcmdldEJsb2NrIiwiaiIsImFjdGl2ZVdpbmRvdyIsImNvdW50IiwidGltZVBlcmlvZHMiLCJpbnRlcnZhbCIsIk1hdGgiLCJmbG9vciIsInB1c2giLCJzaW5nbGUiLCJtdWx0aXBsaWVycyIsIkluZmluaXR5IiwiYnV0dG9ucyIsImVuZFN0YW1wIiwiZ2xvYmFsUmVhY3RpdmVNb2RlbCIsIm1vZGVsIiwiZGF0ZVN0YXJ0IiwiZGF0ZUVuZCIsInJlbGF0aXZlVERCdXR0b24iLCJEYXRlIiwic2V0TW9udGgiLCJzZXREYXRlIiwic2V0SG91cnMiLCJzZXRNaW51dGVzIiwic2V0U2Vjb25kcyIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldERheSIsImVuZERhdGFzZXQiLCJ2YWx1ZU9mIiwiYWJzIiwidGltZUFyciIsInNlbGYiLCJsZW4iLCJwb3NzaWJsZUZhY3RvcnMiLCJleHREYXRhIiwiY3VzdG9tTXVsdGlwbGVycyIsInN0YXJ0IiwiZW5kIiwiYXJndW1lbnRzIiwiZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucyIsImdlbmVyYXRlQ29udGV4dHVhbEJ1dHRvbnMiLCJyZXF1aXJlIiwieEF4aXMiLCJ5QXhpcyIsImdyYXBoaWNzIiwiY2hhcnQiLCJkYXRhc2V0IiwicGxvdE1hbmFnZXIiLCJjYW52YXNDb25maWciLCJtYXJrZXJNYW5hZ2VyIiwicmVhY3RpdmVNb2RlbCIsInNwYWNlTWFuYWdlckluc3RhbmNlIiwic21hcnRMYWJlbCIsImNoYXJ0SW5zdGFuY2UiLCJ0aW1lUnVsZXMiLCJhcGlJbnN0YW5jZSIsImdldENvbXBvbmVudFN0b3JlIiwiZ2V0Q2FudmFzQnlJbmRleCIsImNvbXBvc2l0aW9uIiwiaW1wbCIsImdldERhdGFBZ2dyZWdhdG9yIiwiZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMiLCJwcm9jZXNzTXVsdGlwbGllcnMiLCJzZXRBY3RpdmVQZXJpb2QiLCJ0b29sYmFycyIsIm1lYXN1cmVtZW50IiwiZmxhZyIsImNyZWF0ZVRvb2xiYXIiLCJvblByb3BzQ2hhbmdlIiwidG9vbGJhciIsImRpc3Bvc2UiLCJwb3AiLCJnZXRMb2dpY2FsU3BhY2UiLCJkcmF3IiwidW5pZ3JvdXAiLCJjYWxjdWxhdGVkQnV0dG9ucyIsImNvbnRleHR1YWxCdXR0b25zIiwiYWxsQnV0dG9uIiwic3RhcnRNdWx0aXBsaWVyIiwiZGVkdWN0b3IiLCJjb250ZXh0dWFsQ29uZmlnIiwiZnJvbURhdGVMYWJlbCIsImdyb3VwIiwiX3RoaXMiLCJkZWR1Y3RvckFyIiwicGFwZXIiLCJjaGFydENvbnRhaW5lciIsImNvbnRhaW5lciIsIlVuaVNlbGVjdENvbXBvbmVudEdyb3VwIiwic2V0Q29uZmlnIiwiZmlsbCIsImJvcmRlclRoaWNrbmVzcyIsIkxhYmVsIiwic3R5bGUiLCJhZGRTeW1ib2wiLCJhdHRhY2hFdmVudEhhbmRsZXJzIiwiY2xpY2siLCJ0b29sdGV4dCIsImhpZGUiLCJfbG9vcCIsIl9sb29wMyIsImtleUFiYiIsInNob3ciLCJfbG9vcDIiLCJ4IiwieSIsInJhZCIsInciLCJoIiwicGFkWCIsInBhZFkiLCJ4MSIsIngyIiwieTEiLCJ5MiIsImFkZENvbXBvbmVudCIsImxvZ2ljYWxTcGFjZSIsImxuIiwiYXZhaWxhYmxlV2lkdGgiLCJfcFdpZHRoIiwiYXZhaWxhYmxlSGVpZ2h0IiwiX3BIZWlnaHQiLCJ3aWR0aCIsImhlaWdodCIsInBhZGRpbmciLCJwYXJlbnRHcm91cCIsImFkZCIsInJlZiIsInByaW9yaXR5IiwibGF5b3V0Iiwib3JpZW50YXRpb24iLCJ0eXBlIiwicG9zaXRpb24iLCJwb3NXcnRDYW52YXMiLCJhbGlnbm1lbnQiLCJkaW1lbnNpb25zIiwiZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAiLCJfcmVmIiwiZ2V0V2lkdGgiLCJnZXRIZWlnaHQiLCJtZXMiLCJib3VuZEVsZW1lbnQiLCJiQm94Iiwic2VsZWN0TGluZSIsInNhdmVTZWxlY3RMaW5lIiwicGF0aCIsInN0cm9rZSIsInN0cm9rZS13aWR0aCIsInRvRnJvbnQiLCJpaSIsImNvbXBvbmVudEdyb3VwcyIsInN5bWJvbExpc3QiLCJzeW1ib2wiLCJnZXRCb3VuZEVsZW1lbnQiLCJnZXRCQm94IiwiYXR0ciJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssUUFBQSxFQVVBLE9BTkFQLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLFFBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0FxQ0EsT0FUQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxHQUdBVixFQUFBLEtETU0sU0FBU0ksRUFBUUQsRUFBU0gsSUU1Q2hDLFNBQUFJLEdBQUEsWUZnREMsSUFBSU8sR0FBNEIsa0JBQVhDLFNBQW9ELGdCQUFwQkEsUUFBT0MsU0FBd0IsU0FBVUMsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVhGLFNBQXlCRSxFQUFJQyxjQUFnQkgsUUFBVUUsSUFBUUYsT0FBT0ksVUFBWSxlQUFrQkYsSUUvQ2pRRyxFQUF5QmpCLEVBQVEsRUFFdkNrQixRQUFPQyxLQUFPLEdBQUlGLEdBRWpCLFNBQVdHLEVBQUtDLEdBQ08sV0FBbEJWLEVBQU9QLElBQXVCQSxFQUFPRCxRQUN2Q0MsRUFBT0QsUUFBVWlCLEVBQUlFLFNBQ2hCRCxFQUFRRCxHQUFPLFNBQVVHLEdBQ3pCLElBQUtBLEVBQUlELFNBQ1AsS0FBTSxJQUFJRSxPQUFNLG1DQUVsQixPQUFPSCxHQUFRRSxHQUFLLElBR3pCSCxFQUFJSCx1QkFBeUJJLEVBQVFELEdBQUssSUFFekIsbUJBQVhGLFFBQXlCQSxPQUFoQ08sT0FBK0MsU0FBVUMsRUFBU0MsR0FDbkUsR0FBSUMsR0FBS0YsRUFBUUcsWUFDakJELEdBQUdFLFNBQVMsYUFBYyxVQUFXLDJCQUE0QixXQUMvREYsRUFBR0csa0JBQWtCLGFBQWMsMkJBQTRCZCxHQUF3QlksYUFBY0QsWUZtRDNFckIsS0FBS0osRUFBU0gsRUFBb0IsR0FBR0ksS0FJN0QsU0FBU0EsRUFBUUQsR0czRXZCQyxFQUFBRCxRQUFBLFNBQUFDLEdBUUEsTUFQQUEsR0FBQTRCLGtCQUNBNUIsRUFBQTZCLFVBQUEsYUFDQTdCLEVBQUE4QixTQUVBOUIsRUFBQStCLFlBQ0EvQixFQUFBNEIsZ0JBQUEsR0FFQTVCLElIbUZNLFNBQVNBLEVBQVFELEdJM0Z2QixZSnFHQyxTQUFTaUMsR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FGaEgsR0FBSUMsR0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUFPRCxFQUFXRSxjQUFlLEVBQVUsU0FBV0YsS0FBWUEsRUFBV0csVUFBVyxHQUFNQyxPQUFPQyxlQUFlVCxFQUFRSSxFQUFXTSxJQUFLTixJQUFpQixNQUFPLFVBQVVSLEVBQWFlLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZWixFQUFpQkgsRUFBWXRCLFVBQVdxQyxHQUFpQkMsR0FBYWIsRUFBaUJILEVBQWFnQixHQUFxQmhCLEtJN0ZqaUJsQyxHQUFPRCxRQUFVLFNBQVVvRCxHQUFLLEdBQ3hCdEMsR0FEd0IsV0FFNUIsUUFBQUEsS0FBZW1CLEVBQUFvQixLQUFBdkMsR0FJYnVDLEtBQUtDLE1BQVEsRUFDYkQsS0FBS0UsUUFBVTdCLGFBQWE4QixhQUFhLE1BQU8sV0FDaERILEtBQUtJLGtCQUFvQkosS0FBS0UsUUFBUUUsa0JBQ3RDSixLQUFLSyxlQUFpQkwsS0FBS0UsUUFBUUcsZUFDbkNMLEtBQUtNLFlBQWNOLEtBQUtFLFFBQVFJLFlBQ2hDTixLQUFLTyxJQUFNLEVBQ1hQLEtBQUtRLHFCQUNMUixLQUFLUyxhQUFlLEVBRXBCVCxLQUFLVSxrQkFBb0IsRUFDekJWLEtBQUtXLGdCQUFrQixFQUN2QlgsS0FBS1ksNkJBQ0xaLEtBQUthLDRCQUNMYixLQUFLYyxlQUFpQixFQUN0QmQsS0FBS2UscUJBQXVCLEVBQzVCZixLQUFLZ0IsVUFBWSxNQUNqQmhCLEtBQUtpQixjQUFnQixFQUNyQmpCLEtBQUtrQix1QkFDTGxCLEtBQUttQixZQUVEQyxLQUFRLE1BQ1JDLGFBQWdCLE1BQ2hCQyxPQUFVLE9BQ1ZDLGFBQWdCLFFBQ2hCQyxZQUFlLGlCQUdmSixLQUFRLE1BQ1JDLGFBQWdCLE1BQ2hCQyxPQUFVLFFBQ1ZHLFdBQWMsRUFDZEYsYUFBZ0IsT0FDaEJDLFlBQWUsb0JBR2ZKLEtBQVEsTUFDUkMsYUFBZ0IsTUFDaEJDLE9BQVUsUUFDVkMsYUFBZ0IsT0FDaEJDLFlBQWUsa0JBR2ZKLEtBQVEsTUFDUkMsYUFBZ0IsTUFDaEJDLE9BQVUsTUFDVkcsV0FBYyxFQUNkRixhQUFnQixPQUNoQkMsWUFBZSxpQkFHZkosS0FBUSxJQUNSQyxhQUFnQixJQUNoQkMsT0FBVSxNQUNWQyxhQUFnQixNQUNoQkMsWUFBZSxjQUdmSixLQUFRLElBQ1JDLGFBQWdCLElBQ2hCQyxPQUFVLE1BQ1ZDLGFBQWdCLE1BQ2hCQyxZQUFlLFVBR25CeEIsS0FBSzBCLFFBQ0hDLGdCQUFpQixRQUNqQnBCLElBQUssSUFDTHFCLFdBQVksSUFDWkMsV0FBWSxJQUNaQyx3QkEzRXdCLE1BQUE5QyxHQUFBdkIsSUFBQW1DLElBQUEsNEJBQUFtQyxNQUFBLFdBb0YxQixHQUFJQyxHQUFjaEMsS0FBS1csZ0JBQWtCWCxLQUFLUyxhQUM1Q3JCLEVBQUksRUFDSjZDLEVBQUksRUFDSkMsRUFBZWxDLEtBQUtXLGdCQUFrQlgsS0FBS1Usa0JBQzNDeUIsRUFBUSxDQUVWLEtBREFuQyxLQUFLWSw2QkFDQXhCLEVBQUksRUFBR0EsRUFBSVksS0FBS29DLFlBQVkvQyxPQUFRRCxJQUV2QyxHQUFJNEMsRUFBY2hDLEtBQUtvQyxZQUFZaEQsR0FBR2lELFVBQVksRUFFaEQsR0FBSUMsS0FBS0MsTUFBT0wsRUFBZ0JsQyxLQUFLb0MsWUFBWWhELEdBQUdpRCxVQUFZLEVBQzlEckMsS0FBS1ksMEJBQTBCNEIsTUFDN0JuQixhQUFnQnJCLEtBQUtvQyxZQUFZaEQsR0FBR2lDLGFBQWFvQixPQUNqRGpCLFlBQWV4QixLQUFLb0MsWUFBWWhELEdBQUdvQyxZQUNuQ0QsYUFBZ0J2QixLQUFLb0MsWUFBWWhELEdBQUdpRCxTQUNwQ2pCLEtBQVFwQixLQUFLb0MsWUFBWWhELEdBQUdnQyxLQUM1QnNCLGFBQWdCLFNBV2xCLEtBUkExQyxLQUFLWSwwQkFBMEI0QixNQUM3Qm5CLGFBQWdCckIsS0FBS29DLFlBQVloRCxHQUFHaUMsYUFBYW9CLE9BQ2pEakIsWUFBZXhCLEtBQUtvQyxZQUFZaEQsR0FBR29DLFlBQ25DRCxhQUFnQnZCLEtBQUtvQyxZQUFZaEQsR0FBR2lELFNBQ3BDakIsS0FBUXBCLEtBQUtvQyxZQUFZaEQsR0FBR2dDLEtBQzVCc0IsaUJBR0dULEVBQUksRUFBR0EsRUFBSWpDLEtBQUtvQyxZQUFZaEQsR0FBR3NELFlBQVlyRCxPQUFRNEMsSUFDbERDLEVBQWVsQyxLQUFLQyxNQUFRRCxLQUFLb0MsWUFBWWhELEdBQUdzRCxZQUFZVCxHQUFLakMsS0FBS29DLFlBQVloRCxHQUFHaUQsVUFDdkZyQyxLQUFLWSwwQkFBMEJaLEtBQUtZLDBCQUEwQnZCLE9BQVMsR0FBR3FELFlBQVlGLEtBQ3BGeEMsS0FBS29DLFlBQVloRCxHQUFHc0QsWUFBWVQsR0FRNUMsS0FEQWpDLEtBQUtpQixjQUFnQjBCLElBQ2hCdkQsRUFBSSxFQUFHQSxFQUFJWSxLQUFLWSwwQkFBMEJ2QixPQUFRRCxJQUNyRCxJQUFLNkMsRUFBSSxFQUFHQSxFQUFJakMsS0FBS1ksMEJBQTBCeEIsR0FBR3NELFlBQVlyRCxPQUFRNEMsTUFDbEVFLEVBQ0VuQyxLQUFLaUIsY0FBZ0I3QixJQUN2QlksS0FBS2lCLGNBQWdCN0IsR0FFbkIrQyxHQUFTLElBQ1huQyxLQUFLZSxxQkFBdUJrQixFQUM1QmpDLEtBQUtjLGVBQWlCMUIsTUFsSUZRLElBQUEsNEJBQUFtQyxNQUFBLFdBc0oxQixJQU5BLEdBQUlhLE1BQ0Z4RCxFQUFJLEVBQ0p5RCxFQUFXN0MsS0FBSzhDLG9CQUFvQkMsTUFBTSw2QkFDMUNDLEVBQVlILEVBQVcsRUFDdkJJLEVBQVVKLEVBQ1ZLLEtBQ0s5RCxFQUFJWSxLQUFLbUIsVUFBVTlCLE9BQVFELElBQ2hDNEQsRUFBWSxHQUFJRyxNQUFLTixHQUNVLFFBQTNCN0MsS0FBS21CLFVBQVUvQixHQUFHZ0MsTUFDcEI0QixFQUFVSSxTQUFTLEdBQ25CSixFQUFVSyxRQUFRLEdBQ2xCTCxFQUFVTSxTQUFTLEdBQ25CTixFQUFVTyxXQUFXLEdBQ3JCUCxFQUFVUSxXQUFXLElBQ2UsUUFBM0J4RCxLQUFLbUIsVUFBVS9CLEdBQUdnQyxNQUMzQjRCLEVBQVVLLFFBQVEsR0FDbEJMLEVBQVVNLFNBQVMsR0FDbkJOLEVBQVVPLFdBQVcsR0FDckJQLEVBQVVRLFdBQVcsSUFDZSxRQUEzQnhELEtBQUttQixVQUFVL0IsR0FBR2dDLE1BQzNCNEIsRUFBVUksU0FBUyxHQUFNSixFQUFVUyxXQUFhLEdBQ2hEVCxFQUFVSyxRQUFRLEdBQ2xCTCxFQUFVTSxTQUFTLEdBQ25CTixFQUFVTyxXQUFXLEdBQ3JCUCxFQUFVUSxXQUFXLElBQ2UsUUFBM0J4RCxLQUFLbUIsVUFBVS9CLEdBQUdnQyxNQUMzQjRCLEVBQVVLLFFBQVFMLEVBQVVVLFVBQVlWLEVBQVVXLFVBQ2xEWCxFQUFVTSxTQUFTLEdBQ25CTixFQUFVTyxXQUFXLEdBQ3JCUCxFQUFVUSxXQUFXLElBQ2UsTUFBM0J4RCxLQUFLbUIsVUFBVS9CLEdBQUdnQyxNQUMzQjRCLEVBQVVNLFNBQVMsR0FDbkJOLEVBQVVPLFdBQVcsR0FDckJQLEVBQVVRLFdBQVcsR0FDckJSLEdBQWEsT0FDdUIsTUFBM0JoRCxLQUFLbUIsVUFBVS9CLEdBQUdnQyxPQUMzQjRCLEVBQVVNLFNBQVMsR0FDbkJOLEVBQVVPLFdBQVcsR0FDckJQLEVBQVVRLFdBQVcsSUFDaEJ4RCxLQUFLNEQsY0FBZ0JaLElBQ3hCQSxHQUFhQSxFQUFZLFFBSXpCQyxFQUFVRCxJQUdaaEQsS0FBS21CLFVBQVUvQixHQUFHNEQsVUFBWUEsRUFBVWEsVUFDeEM3RCxLQUFLbUIsVUFBVS9CLEdBQUc2RCxRQUFVQSxFQUFRWSxVQUNwQ2pCLEVBQVFKLEtBQUt4QyxLQUFLbUIsVUFBVS9CLElBSWhDLEtBREE4RCxFQUFpQjNCLGFBQWVvQixJQUMzQnZELEVBQUksRUFBR0EsRUFBSVksS0FBS21CLFVBQVU5QixPQUFRRCxJQUNqQ2tELEtBQUt3QixJQUFJOUQsS0FBS21CLFVBQVUvQixHQUFHbUMsY0FBZ0J2QixLQUFLVyxnQkFBa0JYLEtBQUtVLG9CQUFzQndDLEVBQWlCM0IsZUFDaEgyQixFQUFpQjNCLGFBQWV2QixLQUFLbUIsVUFBVS9CLEdBQUdtQyxhQUNsRDJCLEVBQWlCOUIsS0FBT3BCLEtBQUttQixVQUFVL0IsR0FBR2lDLGFBSTlDckIsTUFBS2EseUJBQTJCK0IsS0E1TU5oRCxJQUFBLHFCQUFBbUMsTUFBQSxTQWdOUmdDLEdBRWxCLElBQUssR0FEREMsR0FBT2hFLEtBQ0ZaLEVBQUksRUFBR0EsRUFBSTJFLEVBQVExRSxPQUFRRCxJQUFLLENBQ3ZDLEdBQUk2RSxHQUFNRixFQUFRM0UsR0FBRzhFLGdCQUFnQjdFLE1BQ3JDMEUsR0FBUTNFLEdBQUdzRCxlQUNQc0IsRUFBS0csUUFBUUMsaUJBQWlCTCxFQUFRM0UsR0FBR2dDLE1BQzNDMkMsRUFBUTNFLEdBQUdzRCxZQUFjc0IsRUFBS0csUUFBUUMsaUJBQWlCTCxFQUFRM0UsR0FBR2dDLE1BQ2pELElBQVI2QyxFQUNURixFQUFRM0UsR0FBR3NELFlBQVlGLEtBQUt1QixFQUFRM0UsR0FBRzhFLGdCQUFnQixJQUN0QyxJQUFSRCxHQUNURixFQUFRM0UsR0FBR3NELFlBQVlGLEtBQUt1QixFQUFRM0UsR0FBRzhFLGdCQUFnQixJQUN2REgsRUFBUTNFLEdBQUdzRCxZQUFZRixLQUFLdUIsRUFBUTNFLEdBQUc4RSxnQkFBZ0JELEVBQU0sTUFFN0RGLEVBQVEzRSxHQUFHc0QsWUFBWUYsS0FBS3VCLEVBQVEzRSxHQUFHOEUsZ0JBQWdCLElBQ3ZESCxFQUFRM0UsR0FBR3NELFlBQVlGLEtBQUtGLEtBQUtDLE1BQU13QixFQUFRM0UsR0FBRzhFLGdCQUFnQkQsRUFBTSxHQUFLLElBQzdFRixFQUFRM0UsR0FBR3NELFlBQVlGLEtBQUt1QixFQUFRM0UsR0FBRzhFLGdCQUFnQkQsRUFBTSxLQUdqRSxNQUFPRixNQWxPbUJuRSxJQUFBLGtCQUFBbUMsTUFBQSxXQTRPMUIsR0FBSXNDLEdBQ0ZDLENBQ3VCLEtBQXJCQyxVQUFVbEYsUUFDWmlGLEVBQU10RSxLQUFLOEMsb0JBQW9CQyxNQUFNLDRCQUNyQ3NCLEVBQVFDLEVBQU1DLFVBQVUsSUFDTSxJQUFyQkEsVUFBVWxGLFNBQ25CZ0YsRUFBUUUsVUFBVSxHQUNsQkQsRUFBTUMsVUFBVSxJQUVsQnZFLEtBQUtVLGtCQUFvQjJELEVBQ3pCckUsS0FBS1csZ0JBQWtCMkQsRUFDdkJ0RSxLQUFLd0UsNEJBQ0x4RSxLQUFLOEMsb0JBQW9CQyxNQUFNLDhCQUFnQy9DLEtBQUtVLGtCQUNwRVYsS0FBSzhDLG9CQUFvQkMsTUFBTSw0QkFBOEIvQyxLQUFLVyxnQkFDbEVYLEtBQUt5RSwrQkExUHFCN0UsSUFBQSxZQUFBbUMsTUFBQSxTQXVRakJMLEdBQ1QxQixLQUFLMEIsT0FBU0EsS0F4UVk5QixJQUFBLE9BQUFtQyxNQUFBLFNBOFF0QjJDLEdBQ0osR0FBSTdGLEdBQVdtQixJQXFGZixPQXBGQTBFLElBQ0UsUUFDQSxRQUNBLFdBQ0EsUUFDQSxVQUNBLGNBQ0EsZUFDQSxnQkFDQSxnQkFDQSxzQkFDQSx1QkFDQSxhQUNBLFVBQ0EsZ0JBQ0EsU0FDTUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQXJDLEVBQ0FzQyxFQUNBQyxFQUNBbEIsRUFDQW1CLEdBQ0p6RyxFQUFTOEYsTUFBUUEsRUFDakI5RixFQUFTK0YsTUFBUUEsRUFDakIvRixFQUFTZ0csU0FBV0EsRUFDcEJoRyxFQUFTaUcsTUFBUUEsRUFDakJqRyxFQUFTa0csUUFBVUEsRUFDbkJsRyxFQUFTbUcsWUFBY0EsRUFDdkJuRyxFQUFTcUcsY0FBZ0JBLEVBQ3pCckcsRUFBU29HLGFBQWVBLEVBQ3hCcEcsRUFBU3NHLGNBQWdCQSxFQUN6QnRHLEVBQVNpRSxvQkFBc0JBLEVBQy9CakUsRUFBU3VHLHFCQUF1QkEsRUFDaEN2RyxFQUFTd0csV0FBYUEsRUFDdEJ4RyxFQUFTc0YsUUFBVUEsRUFDbkJ0RixFQUFTeUcsY0FBZ0JBLEtBRzdCdEYsS0FBS29GLHFCQUF1QnZHLEVBQVN1RyxxQkFDckNwRixLQUFLOEMsb0JBQXNCakUsRUFBU2lFLG9CQUNwQzlDLEtBQUtXLGdCQUFrQjlCLEVBQVNpRSxvQkFBb0JDLE1BQU0sNEJBQzFEL0MsS0FBS1Usa0JBQW9CN0IsRUFBU2lFLG9CQUFvQkMsTUFBTSw4QkFDNUQvQyxLQUFLUyxhQUFlNUIsRUFBU2lFLG9CQUFvQkMsTUFBTSwrQkFDdkQvQyxLQUFLNEQsV0FBYS9FLEVBQVNpRSxvQkFBb0JDLE1BQU0sNkJBRXJEL0MsS0FBS3VGLFVBQVl2RixLQUFLc0YsY0FBY0UsWUFBWUMsb0JBQ2hEekYsS0FBS3VGLFVBQVl2RixLQUFLdUYsVUFBVUcsaUJBQWlCLEdBQUdDLFlBQVlDLEtBQ2hFNUYsS0FBS3VGLFVBQVl2RixLQUFLdUYsVUFBVU0sb0JBQ2hDN0YsS0FBS3VGLFVBQVl2RixLQUFLdUYsVUFBVU8sMEJBQ2hDOUYsS0FBS29DLFlBQWNwQyxLQUFLK0YsbUJBQW1CL0YsS0FBS3VGLFdBQ2hEdkYsS0FBS2dHLGdCQUFnQmhHLEtBQUtVLGtCQUFtQlYsS0FBS1csaUJBQ2xEWCxLQUFLaUcsWUFDTGpHLEtBQUtrRyxlQUNMbEcsS0FBS21HLE1BQU8sRUFFWm5HLEtBQUtpRyxTQUFTekQsS0FBS3hDLEtBQUtvRyxpQkFFeEJwRyxLQUFLOEMsb0JBQW9CdUQsZUFBZSw2QkFBOEIsNEJBQ3BFLFNBQVVoQyxFQUFPQyxHQUNmLEdBQUl6RixFQUFTc0gsS0FBTSxDQUNqQnRILEVBQVNzSCxNQUFPLEVBQ2hCdEgsRUFBU21ILGdCQUFnQjNCLEVBQU0sR0FBSUMsRUFBSSxHQUN2QyxLQUFLLEdBQUlsRixHQUFJLEVBQUdBLEVBQUlQLEVBQVMrQiwwQkFBMEJ2QixPQUFRRCxJQUM3RCxJQUFLLEdBQUk2QyxHQUFJLEVBQUdBLEVBQUlwRCxFQUFTK0IsMEJBQTBCeEIsR0FBR3NELFlBQVlyRCxPQUFRNEMsSUFDdkVxQyxFQUFJLEdBQUtELEVBQU0sSUFBT3hGLEVBQVN1RCxZQUFZaEQsR0FBR3NELFlBQVlULEdBQUtwRCxFQUFTdUQsWUFBWWhELEdBQUdpRCxRQUtoR3hELEdBQVN5SCxRQUFRQyxVQUNqQjFILEVBQVNvSCxTQUFTTyxNQUNsQjNILEVBQVNvSCxTQUFTekQsS0FBSzNELEVBQVN1SCxpQkFDaEN2SCxFQUFTNEgsa0JBQ1Q1SCxFQUFTNkgsVUFHUjFHLFFBcFdtQkosSUFBQSxnQkFBQW1DLE1BQUEsV0F1V1gsR0FDWDRFLEdBQ0ZMLEVBQ0FNLEVBQ0FDLEVBQ0FDLEVBR0FDLEVBQ0FDLEVBQ0E1SCxFQUNBNkMsRUFDQWdGLEVBQ0FDLEVBQ0FDLEVBZGFDLEVBQUFwSCxLQU1iZ0UsRUFBT2hFLEtBQ1BxSCxJQWlFRixLQXhEQUYsRUFBUSxHQUFJbkgsTUFBS0UsUUFBUUcsZ0JBQ3ZCaUgsTUFBT3RILEtBQUs2RSxTQUFTeUMsTUFDckJ4QyxNQUFPOUUsS0FBSzhFLE1BQ1pPLFdBQVlyRixLQUFLcUYsV0FDakJrQyxlQUFnQnZILEtBQUs2RSxTQUFTMkMsWUFHaENiLEVBQVcsR0FBSTNHLE1BQUtFLFFBQVF1SCx5QkFDMUJILE1BQU90SCxLQUFLNkUsU0FBU3lDLE1BQ3JCeEMsTUFBTzlFLEtBQUs4RSxNQUNaTyxXQUFZckYsS0FBS3FGLFdBQ2pCa0MsZUFBZ0J2SCxLQUFLNkUsU0FBUzJDLFlBRWhDYixFQUFTZSxXQUNQQyxLQUFNLE9BQ05DLGdCQUFpQixJQUVuQlQsRUFBTU8sV0FDSkMsS0FBTSxPQUNOQyxnQkFBaUIsSUFFbkJ0QixFQUFVLEdBQUl0RyxNQUFLSSxtQkFDakJrSCxNQUFPdEgsS0FBSzZFLFNBQVN5QyxNQUNyQnhDLE1BQU85RSxLQUFLOEUsTUFDWk8sV0FBWXJGLEtBQUtxRixXQUNqQmtDLGVBQWdCdkgsS0FBSzZFLFNBQVMyQyxZQUVoQ2xCLEVBQVFvQixXQUNOQyxLQUFNLE9BQ05DLGdCQUFpQixJQUVuQlYsRUFBZ0IsR0FBSWxILE1BQUtFLFFBQVEySCxNQUFNLFNBQ3JDeEMsV0FBWXJGLEtBQUtxRixXQUNqQmlDLE1BQU90SCxLQUFLNkUsU0FBU3lDLE9BQ3BCdEQsRUFBS0csUUFBUTJELE1BQU0saUJBQ3RCWCxFQUFNWSxVQUFVYixHQUNoQkosRUFBWSxHQUFJOUcsTUFBS0UsUUFBUTlDLE9BQU8sT0FBTyxHQUN6Q2tLLE1BQU90SCxLQUFLNkUsU0FBU3lDLE1BQ3JCeEMsTUFBTzlFLEtBQUs4RSxNQUNaTyxXQUFZckYsS0FBS3FGLFdBQ2pCa0MsZUFBZ0J2SCxLQUFLNkUsU0FBUzJDLFdBQzdCeEQsRUFBS0csUUFBUTJELE1BQU0sZUFBZUUscUJBQ25DQyxNQUFPLFdBQ0xqRSxFQUFLZ0MsZ0JBQWdCaEMsRUFBS3ZELGFBQWN1RCxFQUFLSixZQUM3QzBDLEVBQVFDLFVBQ1J2QyxFQUFLaEQsVUFBWSxPQU9uQmtILFNBQVUsUUFHWnZCLEVBQVNvQixVQUFVakIsR0FDZDFILEVBQUksRUFBR0EsRUFBSVksS0FBS1ksMEJBQTBCdkIsT0FBUUQsSUFDckQsSUFBSzZDLEVBQUlqQyxLQUFLWSwwQkFBMEJ4QixHQUFHc0QsWUFBWXJELE9BQVMsRUFBRzRDLEdBQUssRUFBR0EsSUFDekVvRixFQUFXN0UsS0FBS3dCLEVBQUtwRCwwQkFBMEJ4QixHQUFHc0QsWUFBWVQsR0FBSytCLEVBQUtwRCwwQkFBMEJ4QixHQUFHbUMsYUFJekdxRixLQUNBLEtBQUssR0FBSWhILEtBQU9JLE1BQUtrQixvQkFDbkJsQixLQUFLa0Isb0JBQW9CdEIsR0FBS3VJLE1BRWhDLEtBQUssR0FsRlVDLEdBQUEsU0FrRk5oSixHQUVMMkgsRUFERTNILElBQU00RSxFQUFLbEQsZUFDS2tELEVBQUtqRCxxQkFFTGlELEVBQUtwRCwwQkFBMEJ4QixHQUFHc0QsWUFBWXJELE9BQVMsQ0FFM0UsS0FBSyxHQXhGUWdKLEdBQUEsU0F3RkpwRyxHQUNQLEdBQUlxRyxHQUFTdEUsRUFBS3BELDBCQUEwQnhCLEdBQUdzRCxZQUFZVCxHQUFLK0IsRUFBS3BELDBCQUEwQnhCLEdBQUdpQyxZQUN6RHBELFVBQXJDbUosRUFBS2xHLG9CQUFvQm9ILEtBQzNCMUIsRUFBb0IsR0FBSVEsR0FBS2xILFFBQVE5QyxPQUFPa0wsR0FBUSxHQUNsRGhCLE1BQU9GLEVBQUt2QyxTQUFTeUMsTUFDckJ4QyxNQUFPc0MsRUFBS3RDLE1BQ1pPLFdBQVkrQixFQUFLL0IsV0FDakJrQyxlQUFnQkgsRUFBS3ZDLFNBQVMyQyxXQUM3QnhELEVBQUtHLFFBQVEyRCxNQUFNLHNCQUFzQkUscUJBQzFDQyxNQUFTLFdBQ1BqQixFQUFZaEQsRUFBS3BELDBCQUEwQnhCLEdBQUdzRCxZQUFZVCxHQUFLK0IsRUFBS3BELDBCQUEwQnhCLEdBQUdtQyxhQUNqR3lDLEVBQUtoRCxVQUFZZ0QsRUFBS3BELDBCQUEwQnhCLEdBQUdzRCxZQUFZVCxHQUFLK0IsRUFBS3BELDBCQUEwQnhCLEdBQUdpQyxhQUN0RzJDLEVBQUtnQyxnQkFBZ0JnQixJQVN2QmtCLFNBQVVsRSxFQUFLcEQsMEJBQTBCeEIsR0FBR3NELFlBQVlULEdBQUssSUFBTStCLEVBQUtwRCwwQkFBMEJ4QixHQUFHb0MsY0FFdkc0RixFQUFLbEcsb0JBQW9Cb0gsR0FBVTFCLEdBR3JDUSxFQUFLbEcsb0JBQW9Cb0gsR0FBUUMsT0FDakM1QixFQUFTb0IsVUFBVVgsRUFBS2xHLG9CQUFvQm9ILEtBM0JyQ3JHLEVBQUk4RSxFQUFpQjlFLEdBQUssRUFBR0EsSUFBS29HLEVBQWxDcEcsSUFORjdDLEVBQUk0RSxFQUFLbEQsZUFBZ0IxQixHQUFLLEVBQUdBLElBQUtnSixFQUF0Q2hKLEVBNENUeUgsS0FFQSxLQUFLLEdBaElVMkIsR0FBQSxTQWdJTnBKLEdBQ1A2SCxFQUEwQixJQUFON0gsRUFBVzRFLEVBQUtHLFFBQVEyRCxNQUFNLDJCQUE2QjlELEVBQUtHLFFBQVEyRCxNQUFNLHFCQUNsR2pCLEVBQWtCekgsR0FBSyxHQUFJZ0ksR0FBS2xILFFBQVE5QyxPQUFPZ0ssRUFBS3ZHLHlCQUF5QnpCLEdBQUdpQyxjQUFjLEdBQzVGaUcsTUFBT0YsRUFBS3ZDLFNBQVN5QyxNQUNyQnhDLE1BQU9zQyxFQUFLdEMsTUFDWk8sV0FBWStCLEVBQUsvQixXQUNqQmtDLGVBQWdCSCxFQUFLdkMsU0FBUzJDLFdBQzdCUCxHQUFrQmUscUJBQ25CQyxNQUFTLFdBQ1BqRSxFQUFLZ0MsZ0JBQWdCaEMsRUFBS25ELHlCQUF5QnpCLEdBQUc0RCxVQUFXZ0IsRUFBS25ELHlCQUF5QnpCLEdBQUc2RCxTQUNsR2UsRUFBS2hELFVBQVlnRCxFQUFLbkQseUJBQXlCekIsR0FBR2lDLGNBUXBENkcsU0FBVWQsRUFBS3ZHLHlCQUF5QnpCLEdBQUdvQyxjQUU3Q21GLEVBQVNvQixVQUFVbEIsRUFBa0J6SCxLQXBCOUJBLEVBQUksRUFBR0EsRUFBSVksS0FBS2EseUJBQXlCeEIsT0FBUUQsSUFBS29KLEVBQXREcEosRUFtQ1QsT0FaQVksTUFBS00sWUFBWWhDLFNBQVMsY0FBZSxTQUFVbUssRUFBR0MsRUFBR0MsRUFBS0MsRUFBR0MsRUFBR0MsRUFBTUMsR0FDeEUsR0FBSUMsR0FBS1AsRUFBSUcsRUFBSSxFQUFJRSxFQUFPLEVBQzFCRyxFQUFLUixFQUFJRyxFQUFJLEVBQUlFLEVBQU8sRUFDeEJJLEVBQUtSLEVBQUlHLEVBQUksRUFBSUUsRUFBTyxFQUN4QkksRUFBS1QsRUFBSUcsRUFBSSxFQUFJRSxFQUFPLENBRTFCLFFBQVEsSUFBS0MsRUFBSUUsRUFBSSxJQUFLRCxFQUFJQyxFQUFJLElBQUtELEVBQUlFLEVBQUksSUFBS0gsRUFBSUcsRUFBSSxPQUc5RDdDLEVBQVE4QyxhQUFhakMsR0FDckJiLEVBQVE4QyxhQUFhekMsR0FDckIzRyxLQUFLc0csUUFBVUEsRUFDUkEsS0ExZ0JtQjFHLElBQUEsa0JBQUFtQyxNQUFBLFdBNmdCcUQsR0FFM0VzSCxHQUdGakssRUFDQWtLLEVBTmFDLEVBQWdFaEYsVUFBQWxGLE9BQUEsR0FBQXBCLFNBQUFzRyxVQUFBLEdBQUFBLFVBQUEsR0FBL0N2RSxLQUFLd0osUUFBU0MsRUFBaUNsRixVQUFBbEYsT0FBQSxHQUFBcEIsU0FBQXNHLFVBQUEsR0FBQUEsVUFBQSxHQUFmdkUsS0FBSzBKLFNBR25FQyxFQUFRLElBQ1JDLEVBQVMsQ0FJWCxLQUFLeEssRUFBSSxFQUFHa0ssRUFBS3RKLEtBQUtpRyxTQUFTNUcsT0FBUUQsRUFBSWtLLEVBQUlsSyxJQUM3Q2lLLEVBQWVySixLQUFLaUcsU0FBUzdHLEdBQUdxSCxnQkFBZ0I4QyxFQUFnQkUsR0FFaEVHLEdBQVVQLEVBQWFPLE9BQ3ZCNUosS0FBS2lHLFNBQVM3RyxHQUFHdUssTUFBUU4sRUFBYU0sTUFDdEMzSixLQUFLaUcsU0FBUzdHLEdBQUd3SyxPQUFTUCxFQUFhTyxNQUd6QyxPQURBQSxJQUFVNUosS0FBSzZKLFNBRWJGLE1BQU9BLEVBQ1BDLE9BQVFBLE1BL2hCZ0JoSyxJQUFBLGtCQUFBbUMsTUFBQSxXQW9pQjFCLE1BQU8vQixNQUFLOEosZUFwaUJjbEssSUFBQSxnQkFBQW1DLE1BQUEsV0F3aUIxQixHQUFJaUMsR0FBT2hFLElBQ1hnRSxHQUFLNkYsUUFBVSxFQUNmN0YsRUFBS29CLHFCQUFxQjJFLE1BQ3hCM0ksS0FBTSxXQUNKLE1BQU8sZ0NBRVQ0SSxJQUFLLFNBQVUxTSxHQUNiLE1BQU9BLEdBQUksSUFFYjBHLEtBQU0sV0FDSixNQUFPQSxJQUVUaUcsU0FBVSxXQUNSLE1BQU8sSUFFVEMsT0FBUSxTQUFVNU0sR0FDaEIsTUFBT0EsR0FBSTBHLEVBQUtHLFFBQVErRixTQUUxQkMsY0FDRUMsS0FBTSxTQUFVOU0sR0FDZCxNQUFPQSxHQUFJMEcsRUFBS0csUUFBUWdHLGNBRTFCRSxXQUNFRCxLQUFNLFNBQVU5TSxHQUNkLE1BQU9BLEdBQUkwRyxFQUFLRyxRQUFRbUcsZUFFMUJDLFlBQ0VILEtBQU0sU0FBVTlNLEdBQ2QsTUFBT0EsR0FBSTBHLEVBQUtHLFFBQVFvRyxZQUUxQkMsWUFBYSxXQUNYLEdBQUlsSixHQUFTdEIsS0FBS3lLLHlCQUVsQixPQURBekcsR0FBSzBHLEtBQU8xSyxLQUNMZ0UsRUFBS3lDLGdCQUFpQnpDLEVBQUt3RixRQUFVbEksRUFBT3FKLFdBQWMzRyxFQUFLMEYsU0FBV3BJLEVBQU9zSiwyQkF6a0J4RWhMLElBQUEsMEJBQUFtQyxNQUFBLFNBaWxCSDBHLEVBQUdDLEVBQUdpQixFQUFPQyxFQUFRekMsR0FDNUMsR0FBSTBELEdBQU03SyxLQUFLa0csV0FRZixPQVBBMkUsR0FBSXBDLEVBQUlBLEVBQ1JvQyxFQUFJbkMsRUFBSUEsRUFDUm1DLEVBQUlsQixNQUFRQSxFQUNaa0IsRUFBSWpCLE9BQVNBLEVBRWI1SixLQUFLOEosWUFBYzNDLEVBRVpuSCxRQTFsQm1CSixJQUFBLE9BQUFtQyxNQUFBLFNBNmxCdEIwRyxFQUFHQyxFQUFHaUIsRUFBT0MsRUFBUXpDLEdBQ3pCLEdBRUVtQyxHQUNBbEssRUFDQWtILEVBQ0F3RSxFQUNBQyxFQUNBL0IsRUFDQUMsRUFDQUUsRUFDQTZCLEVBVkU5RSxFQUFjbEcsS0FBS2tHLFlBQ3JCRCxFQUFXakcsS0FBS2lHLFFBcUJsQixJQVZBakcsS0FBS21HLE1BQU8sRUFDWjZFLEVBQWFoTCxLQUFLaUwsZ0JBQWtCakwsS0FBSzZFLFNBQVN5QyxNQUFNNEQsTUFDdERDLE9BQVUsVUFDVkMsZUFBZ0IsUUFDZkMsVUFDSDVDLEVBQVV4SyxTQUFOd0ssRUFBa0J2QyxFQUFZdUMsRUFBSUEsRUFDdENDLEVBQVV6SyxTQUFOeUssRUFBa0J4QyxFQUFZd0MsRUFBSUEsRUFDdENpQixFQUFrQjFMLFNBQVYwTCxFQUFzQnpELEVBQVl5RCxNQUFRQSxFQUNsREMsRUFBb0IzTCxTQUFYMkwsRUFBdUIxRCxFQUFZMEQsT0FBU0EsRUFDckR6QyxFQUFrQmxKLFNBQVZrSixFQUFzQm5ILEtBQUs4SixZQUFjM0MsRUFDN0N3QyxHQUFTQyxFQUNYLElBQUt4SyxFQUFJLEVBQUdrSyxFQUFLckQsRUFBUzVHLE9BQVFELEVBQUlrSyxFQUFJbEssSUFDeENrSCxFQUFVTCxFQUFTN0csR0FDbkJrSCxFQUFRSSxLQUFLK0IsRUFBR0MsRUFBR3ZCLEVBR3ZCbkgsTUFBS2lMLGVBQWlCRCxDQUN0QixLQUFLLEdBQUk1TCxHQUFJLEVBQUdrTSxFQUFLckYsRUFBUyxHQUFHc0YsZ0JBQWdCLEdBQUdDLFdBQVlwTSxFQUFJa00sRUFBR2pNLE9BQVFELElBQ3pFa00sRUFBR2xNLEdBQUdxTSxTQUFXekwsS0FBS2dCLFlBQ3hCOEosRUFBZVEsRUFBR2xNLEdBQUdzTSxrQkFDckJYLEVBQU9ELEVBQWFhLFVBQ3BCM0MsRUFBSytCLEVBQUt0QyxFQUNWUSxFQUFLOEIsRUFBSzlCLEdBQ1ZFLEVBQUs0QixFQUFLNUIsR0FFVjZCLEVBQVdZLE1BQ1RWLE1BQU8sSUFBS2xDLEVBQUssR0FBS0csRUFBSyxHQUFLLElBQUtGLEVBQUssR0FBS0UsRUFBSyxXQXBvQmhDMUwsSUEwb0I5QixPQUFPQSIsImZpbGUiOiJzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3ItZXM1Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSkgeyd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblx0XG5cdHZhciBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHdpbmRvdy5zdFBTID0gbmV3IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IoKTtcblx0XG5cdDsoZnVuY3Rpb24gKGVudiwgZmFjdG9yeSkge1xuXHQgIGlmICgoIGZhbHNlID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKG1vZHVsZSkpID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBlbnYuZG9jdW1lbnQgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG5cdCAgICAgIGlmICghd2luLmRvY3VtZW50KSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaW5kb3cgd2l0aCBkb2N1bWVudCBub3QgcHJlc2VudCcpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KHdpbiwgdHJ1ZSk7XG5cdCAgICB9O1xuXHQgIH0gZWxzZSB7XG5cdCAgICBlbnYuU3RhbmRhcmRQZXJpb2RTZWxlY3RvciA9IGZhY3RvcnkoZW52LCB0cnVlKTtcblx0ICB9XG5cdH0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdW5kZWZpbmVkLCBmdW5jdGlvbiAoX3dpbmRvdywgd2luZG93RXhpc3RzKSB7XG5cdCAgdmFyIEZDID0gX3dpbmRvdy5GdXNpb25DaGFydHM7XG5cdCAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InLCBmdW5jdGlvbiAoKSB7XG5cdCAgICBGQy5yZWdpc3RlckNvbXBvbmVudCgnZXh0ZW5zaW9ucycsICdzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InLCBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yKHsgRnVzaW9uQ2hhcnRzOiBGQyB9KSk7XG5cdCAgfV0pO1xuXHR9KTtcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMSkobW9kdWxlKSkpXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0XHRtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHRcdH1cblx0XHRyZXR1cm4gbW9kdWxlO1xuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdC8qKlxuXHQgKiBDbGFzcyBkZWZpbml0aW9uIG9mIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3Jcblx0ICovXG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRlcCkge1xuXHQgIHZhciBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gU3RhbmRhcmRQZXJpb2RTZWxlY3RvcigpIHtcblx0ICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IpO1xuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAqL1xuXHQgICAgICB0aGlzLnJhdGlvID0gODtcblx0ICAgICAgdGhpcy50b29sYm94ID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcblx0ICAgICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcblx0ICAgICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcblx0ICAgICAgdGhpcy5TeW1ib2xTdG9yZSA9IHRoaXMudG9vbGJveC5TeW1ib2xTdG9yZTtcblx0ICAgICAgdGhpcy5hbGwgPSAxO1xuXHQgICAgICB0aGlzLmNhbGN1bGF0ZWRQZXJpb2RzID0gW107XG5cdCAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcblx0ICAgICAgLy8gdGhpcy5lbmREYXRhc2V0ID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSAwO1xuXHQgICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IDE7XG5cdCAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuXHQgICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IFtdO1xuXHQgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gMDtcblx0ICAgICAgdGhpcy5zdGFydFBvaW50TXVsdGlwbGllciA9IDA7XG5cdCAgICAgIHRoaXMuY2xpY2tlZElkID0gJ0FMTCc7XG5cdCAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IDA7XG5cdCAgICAgIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9iaiA9IHt9O1xuXHQgICAgICB0aGlzLnRkQnV0dG9ucyA9IFt7XG5cdCAgICAgICAgJ25hbWUnOiAnWVREJyxcblx0ICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1lURCcsXG5cdCAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcblx0ICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llYXIgdG8gRGF0ZSdcblx0ICAgICAgfSwge1xuXHQgICAgICAgICduYW1lJzogJ1FURCcsXG5cdCAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuXHQgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuXHQgICAgICAgICdtdWx0aXBsaWVyJzogMyxcblx0ICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcblx0ICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuXHQgICAgICB9LCB7XG5cdCAgICAgICAgJ25hbWUnOiAnTVREJyxcblx0ICAgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG5cdCAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG5cdCAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG5cdCAgICAgIH0sIHtcblx0ICAgICAgICAnbmFtZSc6ICdXVEQnLFxuXHQgICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcblx0ICAgICAgICAncGFyZW50JzogJ2RheScsXG5cdCAgICAgICAgJ211bHRpcGxpZXInOiA3LFxuXHQgICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG5cdCAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcblx0ICAgICAgfSwge1xuXHQgICAgICAgICduYW1lJzogJ1knLFxuXHQgICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG5cdCAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuXHQgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcblx0ICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVzdGVyZGF5J1xuXHQgICAgICB9LCB7XG5cdCAgICAgICAgJ25hbWUnOiAnVCcsXG5cdCAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcblx0ICAgICAgICAncGFyZW50JzogJ2RheScsXG5cdCAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuXHQgICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcblx0ICAgICAgfV07XG5cdCAgICAgIHRoaXMuY29uZmlnID0ge1xuXHQgICAgICAgIGFuY2hvclBvc2l0aW9uczogJ3JpZ2h0Jyxcblx0ICAgICAgICBhbGw6ICcxJyxcblx0ICAgICAgICBjb250ZXh0dWFsOiAnMScsXG5cdCAgICAgICAgY2FsY3VsYXRlZDogJzEnLFxuXHQgICAgICAgIHRlcnRpYXJ5VGltZVBlcmlvZHM6IHt9XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBBIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjYWxjdWxhdGVkIGJ1dHRvbnMgdXNpbmdcblx0ICAgICAqIHRoZSBhY3RpdmUgcmFuZ2UgYW5kIHRoZSBsb2NhdGlvbiBvZiB0aGUgYWN0aXZlIHJhbmdlXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IsIFt7XG5cdCAgICAgIGtleTogJ2dlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpIHtcblx0ICAgICAgICB2YXIgdGFyZ2V0QmxvY2sgPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdyAtIHRoaXMuc3RhcnREYXRhc2V0LFxuXHQgICAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgICAgaiA9IDAsXG5cdCAgICAgICAgICAgIGFjdGl2ZVdpbmRvdyA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyxcblx0ICAgICAgICAgICAgY291bnQgPSAwO1xuXHQgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcyA9IFtdO1xuXHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAvLyBjaGVja2luZyB3aGV0aGVyIHRoZSB1bml0IGlzIGFwcGxpY2FibGUgZm9yIHRoZSBjdXJyZW50IHRhcmdldCBibG9ja1xuXHQgICAgICAgICAgaWYgKHRhcmdldEJsb2NrIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCA+PSAxKSB7XG5cdCAgICAgICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgb2YgdGhlIGhpZ2hlciBvcmRlciBhbmQgb25seSBtdWx0aXBsaWVyIDEgaXMgYXBwbGljYWJsZVxuXHQgICAgICAgICAgICBpZiAoTWF0aC5mbG9vcihhY3RpdmVXaW5kb3cgLyB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSA8IDEpIHtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG5cdCAgICAgICAgICAgICAgICAnYWJicmV2aWF0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlLFxuXHQgICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogdGhpcy50aW1lUGVyaW9kc1tpXS5kZXNjcmlwdGlvbixcblx0ICAgICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuXHQgICAgICAgICAgICAgICAgJ25hbWUnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLm5hbWUsXG5cdCAgICAgICAgICAgICAgICAnbXVsdGlwbGllcnMnOiBbMV1cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG5cdCAgICAgICAgICAgICAgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLnB1c2goe1xuXHQgICAgICAgICAgICAgICAgJ2FiYnJldmlhdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLnNpbmdsZSxcblx0ICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG5cdCAgICAgICAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCxcblx0ICAgICAgICAgICAgICAgICduYW1lJzogdGhpcy50aW1lUGVyaW9kc1tpXS5uYW1lLFxuXHQgICAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAvLyBjYWxjdWxhdGluZyBhbmQgcG9wdWxhdGluZyB0aGUgYXBwbGljYWJsZSBtdWx0cGxpZXJzIG9mIGVhY2ggdW5pdFxuXHQgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoYWN0aXZlV2luZG93IC8gdGhpcy5yYXRpbyA8IHRoaXMudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsKSB7XG5cdCAgICAgICAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1t0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoIC0gMV0ubXVsdGlwbGllcnMucHVzaCh0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5ub0NhbGNCdXR0b25zID0gSW5maW5pdHk7XG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuXHQgICAgICAgICAgICArK2NvdW50O1xuXHQgICAgICAgICAgICBpZiAodGhpcy5ub0NhbGNCdXR0b25zID4gaSkge1xuXHQgICAgICAgICAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IGk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgaWYgKGNvdW50IDw9IDQpIHtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gajtcblx0ICAgICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gaTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gdGhpcy5kcmF3QnV0dG9uc0NhbGN1bGF0ZWQodGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNvbnRleHR1YWwgYnV0dG9ucyB1c2luZ1xuXHQgICAgICAgKiB0aGUgZW5kIHBvaW50IG9mIHRoZSB0aW1lLXNjYWxlXG5cdCAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucycsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUNvbnRleHR1YWxCdXR0b25zKCkge1xuXHQgICAgICAgIC8vIGdlbmVyYXRpbmcgYW4gYXJyYXkgd2l0aCBhcHBsaWNhYmxlIFREIGJ1dHRvbnNcblx0ICAgICAgICB2YXIgYnV0dG9ucyA9IFtdLFxuXHQgICAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgICAgZW5kU3RhbXAgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXSxcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0ID0gZW5kU3RhbXAgLSAyLFxuXHQgICAgICAgICAgICBkYXRlRW5kID0gZW5kU3RhbXAsXG5cdCAgICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24gPSB7fTtcblx0ICAgICAgICBmb3IgKDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBkYXRlU3RhcnQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG5cdCAgICAgICAgICBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1lURCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdNVEQnKSB7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXREYXRlKDEpO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1FURCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1vbnRoKDExIC0gZGF0ZVN0YXJ0LmdldE1vbnRoKCkgJSA0KTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnV1REJykge1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZShkYXRlU3RhcnQuZ2V0RGF0ZSgpIC0gZGF0ZVN0YXJ0LmdldERheSgpKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZJykge1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG5cdCAgICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0IC09IDg2NDAwMDAwO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnVCcpIHtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuXHQgICAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcblx0ICAgICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG5cdCAgICAgICAgICAgIGlmICgrdGhpcy5lbmREYXRhc2V0ID09PSArZGF0ZVN0YXJ0KSB7XG5cdCAgICAgICAgICAgICAgZGF0ZVN0YXJ0ID0gK2RhdGVTdGFydCAtIDg2NDAwMDAwO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgaWYgKGRhdGVFbmQgPCBkYXRlU3RhcnQpIHtcblx0ICAgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlU3RhcnQgPSBkYXRlU3RhcnQudmFsdWVPZigpO1xuXHQgICAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlRW5kID0gZGF0ZUVuZC52YWx1ZU9mKCk7XG5cdCAgICAgICAgICAgIGJ1dHRvbnMucHVzaCh0aGlzLnRkQnV0dG9uc1tpXSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzID0gSW5maW5pdHk7XG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzIC0gKHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdykpIDwgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMpIHtcblx0ICAgICAgICAgICAgcmVsYXRpdmVUREJ1dHRvbi5taWxsaXNlY29uZHMgPSB0aGlzLnRkQnV0dG9uc1tpXS5taWxsaXNlY29uZHM7XG5cdCAgICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubmFtZSA9IHRoaXMudGRCdXR0b25zW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gYnV0dG9ucztcblx0ICAgICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ29udGV4dHVhbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyk7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAncHJvY2Vzc011bHRpcGxpZXJzJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NNdWx0aXBsaWVycyh0aW1lQXJyKSB7XG5cdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGltZUFyci5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgdmFyIGxlbiA9IHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzLmxlbmd0aDtcblx0ICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMgPSBbXTtcblx0ICAgICAgICAgIGlmIChzZWxmLmV4dERhdGEuY3VzdG9tTXVsdGlwbGVyc1t0aW1lQXJyW2ldLm5hbWVdKSB7XG5cdCAgICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMgPSBzZWxmLmV4dERhdGEuY3VzdG9tTXVsdGlwbGVyc1t0aW1lQXJyW2ldLm5hbWVdO1xuXHQgICAgICAgICAgfSBlbHNlIGlmIChsZW4gPT09IDEpIHtcblx0ICAgICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAobGVuID09PSAyKSB7XG5cdCAgICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG5cdCAgICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1tsZW4gLSAxXSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbMF0pO1xuXHQgICAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2goTWF0aC5mbG9vcih0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1tsZW4gLSAxXSAvIDIpKTtcblx0ICAgICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzW2xlbiAtIDFdKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHRpbWVBcnI7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBBIGZ1bmN0aW9uIHRvIHNldCB0aGUgYWN0aXZlIHBlcmlvZCdzXG5cdCAgICAgICAqIHN0YXJ0IGFuZCBlbmQgcG9pbnRcblx0ICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIHN0YXJ0IHBvaW50IG9mIGFjdGl2ZSBwZXJpb2Rcblx0ICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiBhY3RpdmUgcGVyaW9kXG5cdCAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnc2V0QWN0aXZlUGVyaW9kJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEFjdGl2ZVBlcmlvZCgpIHtcblx0ICAgICAgICB2YXIgc3RhcnQsIGVuZDtcblx0ICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAgICAgZW5kID0gdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcblx0ICAgICAgICAgIHN0YXJ0ID0gZW5kIC0gYXJndW1lbnRzWzBdO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuXHQgICAgICAgICAgc3RhcnQgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgICAgICBlbmQgPSBhcmd1bWVudHNbMV07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSBzdGFydDtcblx0ICAgICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGVuZDtcblx0ICAgICAgICB0aGlzLmdlbmVyYXRlQ2FsY3VsYXRlZEJ1dHRvbnMoKTtcblx0ICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93O1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdztcblx0ICAgICAgICB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbEJ1dHRvbnMoKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuXHQgICAgICAgKiBlbnRpcmUgdGltZS1saW5lXG5cdCAgICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBzdGFydCBwb2ludCBvZiB0aW1lLWxpbmVcblx0ICAgICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcblx0ICAgICAgICovXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIG9iamVjdCB0byBzZXQgdGhlIHVzZXIgcHJlZmVyZW5jZXNcblx0ICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdjb25maWd1cmUnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xuXHQgICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogRnVzaW9uY2hhcnRzIGxpZmUgY3ljbGUgbWV0aG9kIGZvciBleHRlbnNpb25cblx0ICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdpbml0Jyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQocmVxdWlyZSkge1xuXHQgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdCAgICAgICAgcmVxdWlyZShbJ3hBeGlzJywgJ3lBeGlzJywgJ2dyYXBoaWNzJywgJ2NoYXJ0JywgJ2RhdGFzZXQnLCAnUGxvdE1hbmFnZXInLCAnY2FudmFzQ29uZmlnJywgJ01hcmtlck1hbmFnZXInLCAncmVhY3RpdmVNb2RlbCcsICdnbG9iYWxSZWFjdGl2ZU1vZGVsJywgJ3NwYWNlTWFuYWdlckluc3RhbmNlJywgJ3NtYXJ0TGFiZWwnLCAnZXh0RGF0YScsICdjaGFydEluc3RhbmNlJywgZnVuY3Rpb24gKHhBeGlzLCB5QXhpcywgZ3JhcGhpY3MsIGNoYXJ0LCBkYXRhc2V0LCBwbG90TWFuYWdlciwgY2FudmFzQ29uZmlnLCBtYXJrZXJNYW5hZ2VyLCByZWFjdGl2ZU1vZGVsLCBnbG9iYWxSZWFjdGl2ZU1vZGVsLCBzcGFjZU1hbmFnZXJJbnN0YW5jZSwgc21hcnRMYWJlbCwgZXh0RGF0YSwgY2hhcnRJbnN0YW5jZSkge1xuXHQgICAgICAgICAgaW5zdGFuY2UueEF4aXMgPSB4QXhpcztcblx0ICAgICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG5cdCAgICAgICAgICBpbnN0YW5jZS5ncmFwaGljcyA9IGdyYXBoaWNzO1xuXHQgICAgICAgICAgaW5zdGFuY2UuY2hhcnQgPSBjaGFydDtcblx0ICAgICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuXHQgICAgICAgICAgaW5zdGFuY2UucGxvdE1hbmFnZXIgPSBwbG90TWFuYWdlcjtcblx0ICAgICAgICAgIGluc3RhbmNlLm1hcmtlck1hbmFnZXIgPSBtYXJrZXJNYW5hZ2VyO1xuXHQgICAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuXHQgICAgICAgICAgaW5zdGFuY2UucmVhY3RpdmVNb2RlbCA9IHJlYWN0aXZlTW9kZWw7XG5cdCAgICAgICAgICBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gZ2xvYmFsUmVhY3RpdmVNb2RlbDtcblx0ICAgICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG5cdCAgICAgICAgICBpbnN0YW5jZS5zbWFydExhYmVsID0gc21hcnRMYWJlbDtcblx0ICAgICAgICAgIGluc3RhbmNlLmV4dERhdGEgPSBleHREYXRhO1xuXHQgICAgICAgICAgaW5zdGFuY2UuY2hhcnRJbnN0YW5jZSA9IGNoYXJ0SW5zdGFuY2U7XG5cdCAgICAgICAgfV0pO1xuXHQgICAgICAgIHRoaXMuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZTtcblx0ICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgIHRoaXMuZW5kQWN0aXZlV2luZG93ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG5cdCAgICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcblx0ICAgICAgICB0aGlzLmVuZERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgICAgLy8gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsnX3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gKz0gMTI0NDE2MDAwMDAwO1xuXHQgICAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy5jaGFydEluc3RhbmNlLmFwaUluc3RhbmNlLmdldENvbXBvbmVudFN0b3JlKCk7XG5cdCAgICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLnRpbWVSdWxlcy5nZXRDYW52YXNCeUluZGV4KDApLmNvbXBvc2l0aW9uLmltcGw7XG5cdCAgICAgICAgdGhpcy50aW1lUnVsZXMgPSB0aGlzLnRpbWVSdWxlcy5nZXREYXRhQWdncmVnYXRvcigpO1xuXHQgICAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMoKTtcblx0ICAgICAgICB0aGlzLnRpbWVQZXJpb2RzID0gdGhpcy5wcm9jZXNzTXVsdGlwbGllcnModGhpcy50aW1lUnVsZXMpO1xuXHQgICAgICAgIHRoaXMuc2V0QWN0aXZlUGVyaW9kKHRoaXMuc3RhcnRBY3RpdmVXaW5kb3csIHRoaXMuZW5kQWN0aXZlV2luZG93KTtcblx0ICAgICAgICB0aGlzLnRvb2xiYXJzID0gW107XG5cdCAgICAgICAgdGhpcy5tZWFzdXJlbWVudCA9IHt9O1xuXHQgICAgICAgIHRoaXMuZmxhZyA9IHRydWU7XG5cdFxuXHQgICAgICAgIHRoaXMudG9vbGJhcnMucHVzaCh0aGlzLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdFxuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5vblByb3BzQ2hhbmdlKFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnLCAneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10sIGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG5cdCAgICAgICAgICBpZiAoaW5zdGFuY2UuZmxhZykge1xuXHQgICAgICAgICAgICBpbnN0YW5jZS5mbGFnID0gZmFsc2U7XG5cdCAgICAgICAgICAgIGluc3RhbmNlLnNldEFjdGl2ZVBlcmlvZChzdGFydFsxXSwgZW5kWzFdKTtcblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnN0YW5jZS5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbnN0YW5jZS5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoZW5kWzFdIC0gc3RhcnRbMV0gPj0gaW5zdGFuY2UudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCkge1xuXHQgICAgICAgICAgICAgICAgICAvLyBpbnN0YW5jZS5jbGlja2VkSWQgPSBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIGluc3RhbmNlLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGU7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGluc3RhbmNlLnRvb2xiYXIuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICBpbnN0YW5jZS50b29sYmFycy5wb3AoKTtcblx0ICAgICAgICAgICAgaW5zdGFuY2UudG9vbGJhcnMucHVzaChpbnN0YW5jZS5jcmVhdGVUb29sYmFyKCkpO1xuXHQgICAgICAgICAgICBpbnN0YW5jZS5nZXRMb2dpY2FsU3BhY2UoKTtcblx0ICAgICAgICAgICAgaW5zdGFuY2UuZHJhdygpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2NyZWF0ZVRvb2xiYXInLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlVG9vbGJhcigpIHtcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHRcblx0ICAgICAgICB2YXIgdW5pZ3JvdXAsXG5cdCAgICAgICAgICAgIHRvb2xiYXIsXG5cdCAgICAgICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zLFxuXHQgICAgICAgICAgICBjb250ZXh0dWFsQnV0dG9ucyxcblx0ICAgICAgICAgICAgYWxsQnV0dG9uLFxuXHQgICAgICAgICAgICBzZWxmID0gdGhpcyxcblx0ICAgICAgICAgICAgZGVkdWN0b3JBciA9IFtdLFxuXHQgICAgICAgICAgICBzdGFydE11bHRpcGxpZXIsXG5cdCAgICAgICAgICAgIGRlZHVjdG9yLFxuXHQgICAgICAgICAgICBpLFxuXHQgICAgICAgICAgICBqLFxuXHQgICAgICAgICAgICBjb250ZXh0dWFsQ29uZmlnLFxuXHQgICAgICAgICAgICBmcm9tRGF0ZUxhYmVsLFxuXHQgICAgICAgICAgICBncm91cDtcblx0XG5cdCAgICAgICAgZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwKHtcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgdW5pZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LlVuaVNlbGVjdENvbXBvbmVudEdyb3VwKHtcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB1bmlncm91cC5zZXRDb25maWcoe1xuXHQgICAgICAgICAgZmlsbDogJyNmZmYnLFxuXHQgICAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgZ3JvdXAuc2V0Q29uZmlnKHtcblx0ICAgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRvb2xiYXIgPSBuZXcgdGhpcy5Ib3Jpem9udGFsVG9vbGJhcih7XG5cdCAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcblx0ICAgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdG9vbGJhci5zZXRDb25maWcoe1xuXHQgICAgICAgICAgZmlsbDogJyNmZmYnLFxuXHQgICAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgZnJvbURhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ1pvb206Jywge1xuXHQgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcblx0ICAgICAgICB9LCBzZWxmLmV4dERhdGEuc3R5bGVbJ2xhYmVsLWNvbmZpZyddKTtcblx0ICAgICAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG5cdCAgICAgICAgYWxsQnV0dG9uID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2woJ0FMTCcsIHRydWUsIHtcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICB9LCBzZWxmLmV4dERhdGEuc3R5bGVbJ2FsbC1jb25maWcnXSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG5cdCAgICAgICAgICBjbGljazogZnVuY3Rpb24gY2xpY2soKSB7XG5cdCAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKHNlbGYuc3RhcnREYXRhc2V0LCBzZWxmLmVuZERhdGFzZXQpO1xuXHQgICAgICAgICAgICB0b29sYmFyLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSAnQUxMJztcblx0ICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wb3AoKTtcblx0ICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wdXNoKHNlbGYuY3JlYXRlVG9vbGJhcigpKTtcblx0ICAgICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcblx0ICAgICAgICAgICAgLy8gc2VsZi5kcmF3KCk7XG5cdCAgICAgICAgICAgIC8vIHNlbGYuX3JlZi5yZUFsbG9jYXRlKHNlbGYucGFyZW50R3JvdXApO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIHRvb2x0ZXh0OiAnQUxMJ1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICB1bmlncm91cC5hZGRTeW1ib2woYWxsQnV0dG9uKTtcblx0ICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBmb3IgKGogPSB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcblx0ICAgICAgICAgICAgZGVkdWN0b3JBci5wdXNoKHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5taWxsaXNlY29uZHMpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSB7fTtcblx0ICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqKSB7XG5cdCAgICAgICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5XS5oaWRlKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChfaSkge1xuXHQgICAgICAgICAgaWYgKF9pID09PSBzZWxmLnN0YXJ0UG9pbnRVbml0KSB7XG5cdCAgICAgICAgICAgIHN0YXJ0TXVsdGlwbGllciA9IHNlbGYuc3RhcnRQb2ludE11bHRpcGxpZXI7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLm11bHRpcGxpZXJzLmxlbmd0aCAtIDE7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgdmFyIF9sb29wMyA9IGZ1bmN0aW9uIF9sb29wMyhfaikge1xuXHQgICAgICAgICAgICB2YXIga2V5QWJiID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5tdWx0aXBsaWVyc1tfal0gKyBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAgICAgaWYgKF90aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgICAgICAgY2FsY3VsYXRlZEJ1dHRvbnMgPSBuZXcgX3RoaXMudG9vbGJveC5TeW1ib2woa2V5QWJiLCB0cnVlLCB7XG5cdCAgICAgICAgICAgICAgICBwYXBlcjogX3RoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICAgICAgICBjaGFydDogX3RoaXMuY2hhcnQsXG5cdCAgICAgICAgICAgICAgICBzbWFydExhYmVsOiBfdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgICAgICAgICAgY2hhcnRDb250YWluZXI6IF90aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgICAgICAgIH0sIHNlbGYuZXh0RGF0YS5zdHlsZVsnY2FsY3VsYXRlZC1jb25maWcnXSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG5cdCAgICAgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiBjbGljaygpIHtcblx0ICAgICAgICAgICAgICAgICAgZGVkdWN0b3IgPSBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbX2ldLm11bHRpcGxpZXJzW19qXSAqIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tfaV0ubWlsbGlzZWNvbmRzO1xuXHQgICAgICAgICAgICAgICAgICBzZWxmLmNsaWNrZWRJZCA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tfaV0ubXVsdGlwbGllcnNbX2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5hYmJyZXZpYXRpb247XG5cdCAgICAgICAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlUGVyaW9kKGRlZHVjdG9yKTtcblx0ICAgICAgICAgICAgICAgICAgLy8gdG9vbGJhci5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHNlbGYuZ2V0TG9naWNhbFNwYWNlKCk7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuXHQgICAgICAgICAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcblx0ICAgICAgICAgICAgICAgICAgLy8gdGhpcy50b29sYmFyc1t0aGlzLnRvb2xiYXJzLmxlbmd0aCAtIDFdID0gdGhpcy5jcmVhdGVUb29sYmFyKCk7XG5cdCAgICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgICAgdG9vbHRleHQ6IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tfaV0ubXVsdGlwbGllcnNbX2pdICsgJyAnICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW19pXS5kZXNjcmlwdGlvblxuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgIF90aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSA9IGNhbGN1bGF0ZWRCdXR0b25zO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIC8vIHVuaWdyb3VwLmFkZFN5bWJvbChjYWxjdWxhdGVkQnV0dG9uc1tpXSk7XG5cdCAgICAgICAgICAgIF90aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXS5zaG93KCk7XG5cdCAgICAgICAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChfdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0pO1xuXHQgICAgICAgICAgfTtcblx0XG5cdCAgICAgICAgICBmb3IgKHZhciBfaiA9IHN0YXJ0TXVsdGlwbGllcjsgX2ogPj0gMDsgX2otLSkge1xuXHQgICAgICAgICAgICBfbG9vcDMoX2opO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIGZvciAodmFyIF9pID0gc2VsZi5zdGFydFBvaW50VW5pdDsgX2kgPj0gMDsgX2ktLSkge1xuXHQgICAgICAgICAgX2xvb3AoX2kpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gZm9yIChsZXQgaSA9IHNlbGYuc3RhcnRQb2ludFVuaXQ7IGkgPj0gMDsgaS0tKSB7XG5cdCAgICAgICAgLy8gICBmb3IgKGxldCBqID0gc3RhcnRNdWx0aXBsaWVyOyBqID49IDA7IGotLSkge1xuXHQgICAgICAgIC8vICAgICBsZXQga2V5QWJiID0gc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmFiYnJldmlhdGlvbjtcblx0ICAgICAgICAvLyAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdKTtcblx0ICAgICAgICAvLyAgIH1cblx0ICAgICAgICAvLyB9XG5cdFxuXHQgICAgICAgIGNvbnRleHR1YWxCdXR0b25zID0gW107XG5cdFxuXHQgICAgICAgIHZhciBfbG9vcDIgPSBmdW5jdGlvbiBfbG9vcDIoX2kyKSB7XG5cdCAgICAgICAgICBjb250ZXh0dWFsQ29uZmlnID0gX2kyID09PSAwID8gc2VsZi5leHREYXRhLnN0eWxlWydjb250ZXh0dWFsLWNvbmZpZy1maXJzdCddIDogc2VsZi5leHREYXRhLnN0eWxlWydjb250ZXh0dWFsLWNvbmZpZyddO1xuXHQgICAgICAgICAgY29udGV4dHVhbEJ1dHRvbnNbX2kyXSA9IG5ldyBfdGhpcy50b29sYm94LlN5bWJvbChfdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbX2kyXS5hYmJyZXZpYXRpb24sIHRydWUsIHtcblx0ICAgICAgICAgICAgcGFwZXI6IF90aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgICBjaGFydDogX3RoaXMuY2hhcnQsXG5cdCAgICAgICAgICAgIHNtYXJ0TGFiZWw6IF90aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiBfdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICAgIH0sIGNvbnRleHR1YWxDb25maWcpLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiBjbGljaygpIHtcblx0ICAgICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tfaTJdLmRhdGVTdGFydCwgc2VsZi5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbX2kyXS5kYXRlRW5kKTtcblx0ICAgICAgICAgICAgICBzZWxmLmNsaWNrZWRJZCA9IHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW19pMl0uYWJicmV2aWF0aW9uO1xuXHQgICAgICAgICAgICAgIC8vIHRvb2xiYXIuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG5cdCAgICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wdXNoKHNlbGYuY3JlYXRlVG9vbGJhcigpKTtcblx0ICAgICAgICAgICAgICAvLyBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuXHQgICAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuXHQgICAgICAgICAgICAgIC8vIHNlbGYuX3JlZi5yZUFsbG9jYXRlKHNlbGYucGFyZW50R3JvdXApO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICB0b29sdGV4dDogX3RoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW19pMl0uZGVzY3JpcHRpb25cblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGNvbnRleHR1YWxCdXR0b25zW19pMl0pO1xuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzLmxlbmd0aDsgX2kyKyspIHtcblx0ICAgICAgICAgIF9sb29wMihfaTIpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5TeW1ib2xTdG9yZS5yZWdpc3RlcigndGV4dEJveEljb24nLCBmdW5jdGlvbiAoeCwgeSwgcmFkLCB3LCBoLCBwYWRYLCBwYWRZKSB7XG5cdCAgICAgICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcblx0ICAgICAgICAgICAgICB4MiA9IHggKyB3IC8gMiAtIHBhZFggLyAyLFxuXHQgICAgICAgICAgICAgIHkxID0geSAtIGggLyAyICsgcGFkWSAvIDIsXG5cdCAgICAgICAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblx0XG5cdCAgICAgICAgICByZXR1cm4gWydNJywgeDEsIHkxLCAnTCcsIHgyLCB5MSwgJ0wnLCB4MiwgeTIsICdMJywgeDEsIHkyLCAnWiddO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICB0b29sYmFyLmFkZENvbXBvbmVudChncm91cCk7XG5cdCAgICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQodW5pZ3JvdXApO1xuXHQgICAgICAgIHRoaXMudG9vbGJhciA9IHRvb2xiYXI7XG5cdCAgICAgICAgcmV0dXJuIHRvb2xiYXI7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnZ2V0TG9naWNhbFNwYWNlJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExvZ2ljYWxTcGFjZSgpIHtcblx0ICAgICAgICB2YXIgYXZhaWxhYmxlV2lkdGggPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRoaXMuX3BXaWR0aDtcblx0ICAgICAgICB2YXIgYXZhaWxhYmxlSGVpZ2h0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0aGlzLl9wSGVpZ2h0O1xuXHRcblx0ICAgICAgICAvLyBhdmFpbGFibGVXaWR0aCAvPSAyO1xuXHQgICAgICAgIHZhciBsb2dpY2FsU3BhY2UsXG5cdCAgICAgICAgICAgIHdpZHRoID0gNDIwLFxuXHQgICAgICAgICAgICAvLyB3aWR0aCBoYXJkY29kZWQ7IFRPRE86IG1ha2UgaXQgZHluYW1pY1xuXHQgICAgICAgIGhlaWdodCA9IDAsXG5cdCAgICAgICAgICAgIGksXG5cdCAgICAgICAgICAgIGxuO1xuXHRcblx0ICAgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuXHQgICAgICAgICAgbG9naWNhbFNwYWNlID0gdGhpcy50b29sYmFyc1tpXS5nZXRMb2dpY2FsU3BhY2UoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCk7XG5cdCAgICAgICAgICAvLyB3aWR0aCA9IE1hdGgubWF4KGxvZ2ljYWxTcGFjZS53aWR0aCwgd2lkdGgpO1xuXHQgICAgICAgICAgaGVpZ2h0ICs9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG5cdCAgICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuXHQgICAgICAgICAgdGhpcy50b29sYmFyc1tpXS5oZWlnaHQgPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuXHQgICAgICAgIH1cblx0ICAgICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICB3aWR0aDogd2lkdGgsXG5cdCAgICAgICAgICBoZWlnaHQ6IGhlaWdodFxuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnZ2V0RGVmYXVsdEdyb3VwJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlZmF1bHRHcm91cCgpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRHcm91cDtcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdwbGFjZUluQ2FudmFzJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYWNlSW5DYW52YXMoKSB7XG5cdCAgICAgICAgdmFyIF9zZWxmID0gdGhpcztcblx0ICAgICAgICBfc2VsZi5wYWRkaW5nID0gNTtcblx0ICAgICAgICBfc2VsZi5zcGFjZU1hbmFnZXJJbnN0YW5jZS5hZGQoW3tcblx0ICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uIG5hbWUoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiAnc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yLWV4dCc7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgcmVmOiBmdW5jdGlvbiByZWYob2JqKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBvYmpbJzAnXTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBzZWxmOiBmdW5jdGlvbiBzZWxmKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gX3NlbGY7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgcHJpb3JpdHk6IGZ1bmN0aW9uIHByaW9yaXR5KCkge1xuXHQgICAgICAgICAgICByZXR1cm4gMjtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBsYXlvdXQ6IGZ1bmN0aW9uIGxheW91dChvYmopIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG9ialtfc2VsZi5leHREYXRhLmxheW91dF07XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgb3JpZW50YXRpb246IFt7XG5cdCAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIHR5cGUob2JqKSB7XG5cdCAgICAgICAgICAgICAgcmV0dXJuIG9ialtfc2VsZi5leHREYXRhLm9yaWVudGF0aW9uXTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgcG9zaXRpb246IFt7XG5cdCAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBvYmpbX3NlbGYuZXh0RGF0YS5wb3NXcnRDYW52YXNdO1xuXHQgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgYWxpZ25tZW50OiBbe1xuXHQgICAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialtfc2VsZi5leHREYXRhLmFsaWdubWVudF07XG5cdCAgICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgICAgZGltZW5zaW9uczogW2Z1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcblx0ICAgICAgICAgICAgICAgICAgX3NlbGYuX3JlZiA9IHRoaXM7XG5cdCAgICAgICAgICAgICAgICAgIHJldHVybiBfc2VsZi5nZXRMb2dpY2FsU3BhY2UoX3NlbGYuX3BXaWR0aCA9IHBhcmVudC5nZXRXaWR0aCgpLCBfc2VsZi5fcEhlaWdodCA9IHBhcmVudC5nZXRIZWlnaHQoKSk7XG5cdCAgICAgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgICAgIH1dXG5cdCAgICAgICAgICAgIH1dXG5cdCAgICAgICAgICB9XVxuXHQgICAgICAgIH1dKTtcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdzZXREcmF3aW5nQ29uZmlndXJhdGlvbicsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREcmF3aW5nQ29uZmlndXJhdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuXHQgICAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuXHQgICAgICAgIG1lcy54ID0geDtcblx0ICAgICAgICBtZXMueSA9IHk7XG5cdCAgICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG5cdCAgICAgICAgbWVzLmhlaWdodCA9IGhlaWdodDtcblx0XG5cdCAgICAgICAgdGhpcy5wYXJlbnRHcm91cCA9IGdyb3VwO1xuXHRcblx0ICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdkcmF3Jyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYXcoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcblx0ICAgICAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuXHQgICAgICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG5cdCAgICAgICAgICAgIGxuLFxuXHQgICAgICAgICAgICBpLFxuXHQgICAgICAgICAgICB0b29sYmFyLFxuXHQgICAgICAgICAgICBib3VuZEVsZW1lbnQsXG5cdCAgICAgICAgICAgIGJCb3gsXG5cdCAgICAgICAgICAgIHgxLFxuXHQgICAgICAgICAgICB4Mixcblx0ICAgICAgICAgICAgeTIsXG5cdCAgICAgICAgICAgIHNlbGVjdExpbmU7XG5cdFxuXHQgICAgICAgIHRoaXMuZmxhZyA9IHRydWU7XG5cdCAgICAgICAgc2VsZWN0TGluZSA9IHRoaXMuc2F2ZVNlbGVjdExpbmUgfHwgdGhpcy5ncmFwaGljcy5wYXBlci5wYXRoKHtcblx0ICAgICAgICAgICdzdHJva2UnOiAnI2M5NWE1YScsXG5cdCAgICAgICAgICAnc3Ryb2tlLXdpZHRoJzogJzJweCdcblx0ICAgICAgICB9KS50b0Zyb250KCk7XG5cdCAgICAgICAgeCA9IHggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnggOiB4O1xuXHQgICAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcblx0ICAgICAgICB3aWR0aCA9IHdpZHRoID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC53aWR0aCA6IHdpZHRoO1xuXHQgICAgICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQuaGVpZ2h0IDogaGVpZ2h0O1xuXHQgICAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcblx0ICAgICAgICBpZiAod2lkdGggJiYgaGVpZ2h0KSB7XG5cdCAgICAgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcblx0ICAgICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuXHQgICAgICAgICAgICB0b29sYmFyLmRyYXcoeCwgeSwgZ3JvdXApO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLnNhdmVTZWxlY3RMaW5lID0gc2VsZWN0TGluZTtcblx0ICAgICAgICBmb3IgKHZhciBfaTMgPSAwLCBpaSA9IHRvb2xiYXJzWzBdLmNvbXBvbmVudEdyb3Vwc1sxXS5zeW1ib2xMaXN0OyBfaTMgPCBpaS5sZW5ndGg7IF9pMysrKSB7XG5cdCAgICAgICAgICBpZiAoaWlbX2kzXS5zeW1ib2wgPT09IHRoaXMuY2xpY2tlZElkKSB7XG5cdCAgICAgICAgICAgIGJvdW5kRWxlbWVudCA9IGlpW19pM10uZ2V0Qm91bmRFbGVtZW50KCk7XG5cdCAgICAgICAgICAgIGJCb3ggPSBib3VuZEVsZW1lbnQuZ2V0QkJveCgpO1xuXHQgICAgICAgICAgICB4MSA9IGJCb3gueDtcblx0ICAgICAgICAgICAgeDIgPSBiQm94LngyO1xuXHQgICAgICAgICAgICB5MiA9IGJCb3gueTI7XG5cdFxuXHQgICAgICAgICAgICBzZWxlY3RMaW5lLmF0dHIoe1xuXHQgICAgICAgICAgICAgIHBhdGg6IFsnTScsIHgxIC0gMC41LCB5MiAtIDAuNSwgJ0wnLCB4MiArIDAuNSwgeTIgLSAwLjVdXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yO1xuXHQgIH0oKTtcblx0XG5cdCAgcmV0dXJuIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG5cdH07XG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3ItZXM1Lm1pbi5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGM0OGRmMjQyYmU4Yjk5ZmQ1NTljIiwiJ3VzZSBzdHJpY3QnO1xuY29uc3QgU3RhbmRhcmRQZXJpb2RTZWxlY3RvciA9IHJlcXVpcmUoJy4vc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yJyk7XG5cbndpbmRvdy5zdFBTID0gbmV3IFN0YW5kYXJkUGVyaW9kU2VsZWN0b3IoKTtcblxuOyhmdW5jdGlvbiAoZW52LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50XG4gICAgICAgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG4gICAgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dpbmRvdyB3aXRoIGRvY3VtZW50IG5vdCBwcmVzZW50Jyk7XG4gICAgICAgICB9XG4gICAgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuICAgICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW52LlN0YW5kYXJkUGVyaW9kU2VsZWN0b3IgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG4gIH1cbn0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuICB2YXIgRkMgPSBfd2luZG93LkZ1c2lvbkNoYXJ0cztcbiAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdzdGFuZGFyZC1wZXJpb2Qtc2VsZWN0b3InLCBmdW5jdGlvbiAoKSB7XG4gICAgRkMucmVnaXN0ZXJDb21wb25lbnQoJ2V4dGVuc2lvbnMnLCAnc3RhbmRhcmQtcGVyaW9kLXNlbGVjdG9yJywgU3RhbmRhcmRQZXJpb2RTZWxlY3Rvcih7RnVzaW9uQ2hhcnRzOiBGQ30pKTtcbiAgfV0pO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHR9XG5cdHJldHVybiBtb2R1bGU7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENsYXNzIGRlZmluaXRpb24gb2YgU3RhbmRhcmRQZXJpb2RTZWxlY3RvclxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRlcCkge1xuICBjbGFzcyBTdGFuZGFyZFBlcmlvZFNlbGVjdG9yIHtcbiAgICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgICAvKipcbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKi9cbiAgICAgIHRoaXMucmF0aW8gPSA4O1xuICAgICAgdGhpcy50b29sYm94ID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcbiAgICAgIHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIgPSB0aGlzLnRvb2xib3guSG9yaXpvbnRhbFRvb2xiYXI7XG4gICAgICB0aGlzLkNvbXBvbmVudEdyb3VwID0gdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwO1xuICAgICAgdGhpcy5TeW1ib2xTdG9yZSA9IHRoaXMudG9vbGJveC5TeW1ib2xTdG9yZTtcbiAgICAgIHRoaXMuYWxsID0gMTtcbiAgICAgIHRoaXMuY2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcbiAgICAgIC8vIHRoaXMuZW5kRGF0YXNldCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy5zdGFydEFjdGl2ZVdpbmRvdyA9IDA7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IDE7XG4gICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzID0gW107XG4gICAgICB0aGlzLnN0YXJ0UG9pbnRVbml0ID0gMDtcbiAgICAgIHRoaXMuc3RhcnRQb2ludE11bHRpcGxpZXIgPSAwO1xuICAgICAgdGhpcy5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IDA7XG4gICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmogPSB7fTtcbiAgICAgIHRoaXMudGRCdXR0b25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnWVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ1lURCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICd5ZWFyJyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogMzExMDQwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1llYXIgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1FURCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdRVEQnLFxuICAgICAgICAgICdwYXJlbnQnOiAnbW9udGgnLFxuICAgICAgICAgICdtdWx0aXBsaWVyJzogMyxcbiAgICAgICAgICAnbWlsbGlzZWNvbmRzJzogNzc3NjAwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnUXVhcnRlciB0byBEYXRlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnTVREJyxcbiAgICAgICAgICAnYWJicmV2aWF0aW9uJzogJ01URCcsXG4gICAgICAgICAgJ3BhcmVudCc6ICdtb250aCcsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDI1OTIwMDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ01vbnRoIHRvIERhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAnbmFtZSc6ICdXVEQnLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnV1REJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ211bHRpcGxpZXInOiA3LFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA2MDQ4MDAwMDAsXG4gICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1dlZWsgdG8gRGF0ZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICduYW1lJzogJ1knLFxuICAgICAgICAgICdhYmJyZXZpYXRpb24nOiAnWScsXG4gICAgICAgICAgJ3BhcmVudCc6ICdkYXknLFxuICAgICAgICAgICdtaWxsaXNlY29uZHMnOiA4NjQwMDAwMCxcbiAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnWWVzdGVyZGF5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgJ25hbWUnOiAnVCcsXG4gICAgICAgICAgJ2FiYnJldmlhdGlvbic6ICdUJyxcbiAgICAgICAgICAncGFyZW50JzogJ2RheScsXG4gICAgICAgICAgJ21pbGxpc2Vjb25kcyc6IDg2NDAwMDAwLFxuICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdUb2RheSdcbiAgICAgICAgfVxuICAgICAgXTtcbiAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICBhbmNob3JQb3NpdGlvbnM6ICdyaWdodCcsXG4gICAgICAgIGFsbDogJzEnLFxuICAgICAgICBjb250ZXh0dWFsOiAnMScsXG4gICAgICAgIGNhbGN1bGF0ZWQ6ICcxJyxcbiAgICAgICAgdGVydGlhcnlUaW1lUGVyaW9kczoge31cbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBnZW5lcmF0ZSB0aGUgY2FsY3VsYXRlZCBidXR0b25zIHVzaW5nXG4gICAgICogdGhlIGFjdGl2ZSByYW5nZSBhbmQgdGhlIGxvY2F0aW9uIG9mIHRoZSBhY3RpdmUgcmFuZ2VcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUNhbGN1bGF0ZWRCdXR0b25zICgpIHtcbiAgICAgIHZhciB0YXJnZXRCbG9jayA9IHRoaXMuZW5kQWN0aXZlV2luZG93IC0gdGhpcy5zdGFydERhdGFzZXQsXG4gICAgICAgIGkgPSAwLFxuICAgICAgICBqID0gMCxcbiAgICAgICAgYWN0aXZlV2luZG93ID0gdGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93LFxuICAgICAgICBjb3VudCA9IDA7XG4gICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMgPSBbXTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRpbWVQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgYXBwbGljYWJsZSBmb3IgdGhlIGN1cnJlbnQgdGFyZ2V0IGJsb2NrXG4gICAgICAgIGlmICh0YXJnZXRCbG9jayAvIHRoaXMudGltZVBlcmlvZHNbaV0uaW50ZXJ2YWwgPj0gMSkge1xuICAgICAgICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHVuaXQgaXMgb2YgdGhlIGhpZ2hlciBvcmRlciBhbmQgb25seSBtdWx0aXBsaWVyIDEgaXMgYXBwbGljYWJsZVxuICAgICAgICAgIGlmIChNYXRoLmZsb29yKChhY3RpdmVXaW5kb3cpIC8gdGhpcy50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCkgPCAxKSB7XG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGUsXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogWzFdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgeyAvLyBpZiB0aGUgdW5pdCBpcyBvZiB0aGUgb3JkZXIgb2YgdGhlIHRhcmdldCBibG9jayBhbmQgY2FsY3VsYXRpbmcgdGhlIG11bHRpcGxpZXJzXG4gICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMucHVzaCh7XG4gICAgICAgICAgICAgICdhYmJyZXZpYXRpb24nOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmFiYnJldmlhdGlvbi5zaW5nbGUsXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMudGltZVBlcmlvZHNbaV0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICdtaWxsaXNlY29uZHMnOiB0aGlzLnRpbWVQZXJpb2RzW2ldLmludGVydmFsLFxuICAgICAgICAgICAgICAnbmFtZSc6IHRoaXMudGltZVBlcmlvZHNbaV0ubmFtZSxcbiAgICAgICAgICAgICAgJ211bHRpcGxpZXJzJzogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIGFwcGxpY2FibGUgbXVsdHBsaWVycyBvZiBlYWNoIHVuaXRcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVXaW5kb3cgLyB0aGlzLnJhdGlvIDwgdGhpcy50aW1lUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSAqIHRoaXMudGltZVBlcmlvZHNbaV0uaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aCAtIDFdLm11bHRpcGxpZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgICB0aGlzLnRpbWVQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLm5vQ2FsY0J1dHRvbnMgPSBJbmZpbml0eTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICsrY291bnQ7XG4gICAgICAgICAgaWYgKHRoaXMubm9DYWxjQnV0dG9ucyA+IGkpIHtcbiAgICAgICAgICAgIHRoaXMubm9DYWxjQnV0dG9ucyA9IGk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3VudCA8PSA0KSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRNdWx0aXBsaWVyID0gajtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRQb2ludFVuaXQgPSBpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ2FsY3VsYXRlZCh0aGlzLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIGNvbnRleHR1YWwgYnV0dG9ucyB1c2luZ1xuICAgICAqIHRoZSBlbmQgcG9pbnQgb2YgdGhlIHRpbWUtc2NhbGVcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUNvbnRleHR1YWxCdXR0b25zICgpIHtcbiAgICAgIC8vIGdlbmVyYXRpbmcgYW4gYXJyYXkgd2l0aCBhcHBsaWNhYmxlIFREIGJ1dHRvbnNcbiAgICAgIHZhciBidXR0b25zID0gW10sXG4gICAgICAgIGkgPSAwLFxuICAgICAgICBlbmRTdGFtcCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddLFxuICAgICAgICBkYXRlU3RhcnQgPSBlbmRTdGFtcCAtIDIsXG4gICAgICAgIGRhdGVFbmQgPSBlbmRTdGFtcCxcbiAgICAgICAgcmVsYXRpdmVUREJ1dHRvbiA9IHt9O1xuICAgICAgZm9yICg7IGkgPCB0aGlzLnRkQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkYXRlU3RhcnQgPSBuZXcgRGF0ZShlbmRTdGFtcCk7XG4gICAgICAgIGlmICh0aGlzLnRkQnV0dG9uc1tpXS5uYW1lID09PSAnWVREJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNb250aCgwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ01URCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0RGF0ZSgxKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0SG91cnMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldFNlY29uZHMoMCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1FURCcpIHtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TW9udGgoMTEgLSAoZGF0ZVN0YXJ0LmdldE1vbnRoKCkgJSA0KSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoMCk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdXVEQnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldERhdGUoZGF0ZVN0YXJ0LmdldERhdGUoKSAtIGRhdGVTdGFydC5nZXREYXkoKSk7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGRCdXR0b25zW2ldLm5hbWUgPT09ICdZJykge1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRIb3VycygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0TWludXRlcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgICBkYXRlU3RhcnQgLT0gODY0MDAwMDA7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50ZEJ1dHRvbnNbaV0ubmFtZSA9PT0gJ1QnKSB7XG4gICAgICAgICAgZGF0ZVN0YXJ0LnNldEhvdXJzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRNaW51dGVzKDApO1xuICAgICAgICAgIGRhdGVTdGFydC5zZXRTZWNvbmRzKDApO1xuICAgICAgICAgIGlmICgrdGhpcy5lbmREYXRhc2V0ID09PSArZGF0ZVN0YXJ0KSB7XG4gICAgICAgICAgICBkYXRlU3RhcnQgPSArZGF0ZVN0YXJ0IC0gODY0MDAwMDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGVFbmQgPCBkYXRlU3RhcnQpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnRkQnV0dG9uc1tpXS5kYXRlU3RhcnQgPSBkYXRlU3RhcnQudmFsdWVPZigpO1xuICAgICAgICAgIHRoaXMudGRCdXR0b25zW2ldLmRhdGVFbmQgPSBkYXRlRW5kLnZhbHVlT2YoKTtcbiAgICAgICAgICBidXR0b25zLnB1c2godGhpcy50ZEJ1dHRvbnNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcyA9IEluZmluaXR5O1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMudGRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnRkQnV0dG9uc1tpXS5taWxsaXNlY29uZHMgLSAodGhpcy5lbmRBY3RpdmVXaW5kb3cgLSB0aGlzLnN0YXJ0QWN0aXZlV2luZG93KSkgPCByZWxhdGl2ZVREQnV0dG9uLm1pbGxpc2Vjb25kcykge1xuICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubWlsbGlzZWNvbmRzID0gdGhpcy50ZEJ1dHRvbnNbaV0ubWlsbGlzZWNvbmRzO1xuICAgICAgICAgIHJlbGF0aXZlVERCdXR0b24ubmFtZSA9IHRoaXMudGRCdXR0b25zW2ldLmFiYnJldmlhdGlvbjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyA9IGJ1dHRvbnM7XG4gICAgICAvLyB0aGlzLmRyYXdCdXR0b25zQ29udGV4dHVhbCh0aGlzLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kcyk7XG4gICAgfVxuXG4gICAgcHJvY2Vzc011bHRpcGxpZXJzICh0aW1lQXJyKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbWVBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGxlbiA9IHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzLmxlbmd0aDtcbiAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycyA9IFtdO1xuICAgICAgICBpZiAoc2VsZi5leHREYXRhLmN1c3RvbU11bHRpcGxlcnNbdGltZUFycltpXS5uYW1lXSkge1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMgPSBzZWxmLmV4dERhdGEuY3VzdG9tTXVsdGlwbGVyc1t0aW1lQXJyW2ldLm5hbWVdO1xuICAgICAgICB9IGVsc2UgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG4gICAgICAgIH0gZWxzZSBpZiAobGVuID09PSAyKSB7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzWzBdKTtcbiAgICAgICAgICB0aW1lQXJyW2ldLm11bHRpcGxpZXJzLnB1c2godGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRpbWVBcnJbaV0ubXVsdGlwbGllcnMucHVzaCh0aW1lQXJyW2ldLnBvc3NpYmxlRmFjdG9yc1swXSk7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKE1hdGguZmxvb3IodGltZUFycltpXS5wb3NzaWJsZUZhY3RvcnNbbGVuIC0gMV0gLyAyKSk7XG4gICAgICAgICAgdGltZUFycltpXS5tdWx0aXBsaWVycy5wdXNoKHRpbWVBcnJbaV0ucG9zc2libGVGYWN0b3JzW2xlbiAtIDFdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRpbWVBcnI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0byBzZXQgdGhlIGFjdGl2ZSBwZXJpb2Qnc1xuICAgICAqIHN0YXJ0IGFuZCBlbmQgcG9pbnRcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZGF0ZSBzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgc2V0IGFzIHRoZSBlbmQgcG9pbnQgb2YgYWN0aXZlIHBlcmlvZFxuICAgICAqL1xuICAgIHNldEFjdGl2ZVBlcmlvZCAoKSB7XG4gICAgICB2YXIgc3RhcnQsXG4gICAgICAgIGVuZDtcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGVuZCA9IHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG4gICAgICAgIHN0YXJ0ID0gZW5kIC0gYXJndW1lbnRzWzBdO1xuICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHN0YXJ0ID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBlbmQgPSBhcmd1bWVudHNbMV07XG4gICAgICB9XG4gICAgICB0aGlzLnN0YXJ0QWN0aXZlV2luZG93ID0gc3RhcnQ7XG4gICAgICB0aGlzLmVuZEFjdGl2ZVdpbmRvdyA9IGVuZDtcbiAgICAgIHRoaXMuZ2VuZXJhdGVDYWxjdWxhdGVkQnV0dG9ucygpO1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddID0gdGhpcy5zdGFydEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZEFjdGl2ZVdpbmRvdztcbiAgICAgIHRoaXMuZ2VuZXJhdGVDb250ZXh0dWFsQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50IG9mIHRoZVxuICAgICAqIGVudGlyZSB0aW1lLWxpbmVcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGRhdGUgc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIHNldCBhcyB0aGUgc3RhcnQgcG9pbnQgb2YgdGltZS1saW5lXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBkYXRlIHN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBzZXQgYXMgdGhlIGVuZCBwb2ludCBvZiB0aW1lLWxpbmVcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdG8gc2V0IHRoZSBvYmplY3QgdG8gc2V0IHRoZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICovXG4gICAgY29uZmlndXJlIChjb25maWcpIHtcbiAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAgICovXG4gICAgaW5pdCAocmVxdWlyZSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHJlcXVpcmUoW1xuICAgICAgICAneEF4aXMnLFxuICAgICAgICAneUF4aXMnLFxuICAgICAgICAnZ3JhcGhpY3MnLFxuICAgICAgICAnY2hhcnQnLFxuICAgICAgICAnZGF0YXNldCcsXG4gICAgICAgICdQbG90TWFuYWdlcicsXG4gICAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAgICdyZWFjdGl2ZU1vZGVsJyxcbiAgICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgICAnc21hcnRMYWJlbCcsXG4gICAgICAgICdleHREYXRhJyxcbiAgICAgICAgJ2NoYXJ0SW5zdGFuY2UnLFxuICAgICAgICBmdW5jdGlvbiAoXG4gICAgICAgICAgICAgIHhBeGlzLFxuICAgICAgICAgICAgICB5QXhpcyxcbiAgICAgICAgICAgICAgZ3JhcGhpY3MsXG4gICAgICAgICAgICAgIGNoYXJ0LFxuICAgICAgICAgICAgICBkYXRhc2V0LFxuICAgICAgICAgICAgICBwbG90TWFuYWdlcixcbiAgICAgICAgICAgICAgY2FudmFzQ29uZmlnLFxuICAgICAgICAgICAgICBtYXJrZXJNYW5hZ2VyLFxuICAgICAgICAgICAgICByZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBnbG9iYWxSZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgICBzcGFjZU1hbmFnZXJJbnN0YW5jZSxcbiAgICAgICAgICAgICAgc21hcnRMYWJlbCxcbiAgICAgICAgICAgICAgZXh0RGF0YSxcbiAgICAgICAgICAgICAgY2hhcnRJbnN0YW5jZSkge1xuICAgICAgICAgIGluc3RhbmNlLnhBeGlzID0geEF4aXM7XG4gICAgICAgICAgaW5zdGFuY2UueUF4aXMgPSB5QXhpcztcbiAgICAgICAgICBpbnN0YW5jZS5ncmFwaGljcyA9IGdyYXBoaWNzO1xuICAgICAgICAgIGluc3RhbmNlLmNoYXJ0ID0gY2hhcnQ7XG4gICAgICAgICAgaW5zdGFuY2UuZGF0YXNldCA9IGRhdGFzZXQ7XG4gICAgICAgICAgaW5zdGFuY2UucGxvdE1hbmFnZXIgPSBwbG90TWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5tYXJrZXJNYW5hZ2VyID0gbWFya2VyTWFuYWdlcjtcbiAgICAgICAgICBpbnN0YW5jZS5jYW52YXNDb25maWcgPSBjYW52YXNDb25maWc7XG4gICAgICAgICAgaW5zdGFuY2UucmVhY3RpdmVNb2RlbCA9IHJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICAgICAgaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBzcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgICAgICBpbnN0YW5jZS5zbWFydExhYmVsID0gc21hcnRMYWJlbDtcbiAgICAgICAgICBpbnN0YW5jZS5leHREYXRhID0gZXh0RGF0YTtcbiAgICAgICAgICBpbnN0YW5jZS5jaGFydEluc3RhbmNlID0gY2hhcnRJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgXSk7XG4gICAgICB0aGlzLnNwYWNlTWFuYWdlckluc3RhbmNlID0gaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgICAgdGhpcy5lbmRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXTtcbiAgICAgIHRoaXMuc3RhcnRBY3RpdmVXaW5kb3cgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcbiAgICAgIC8vIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ194LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddICs9IDEyNDQxNjAwMDAwMDtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy5jaGFydEluc3RhbmNlLmFwaUluc3RhbmNlLmdldENvbXBvbmVudFN0b3JlKCk7XG4gICAgICB0aGlzLnRpbWVSdWxlcyA9IHRoaXMudGltZVJ1bGVzLmdldENhbnZhc0J5SW5kZXgoMCkuY29tcG9zaXRpb24uaW1wbDtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0RGF0YUFnZ3JlZ2F0b3IoKTtcbiAgICAgIHRoaXMudGltZVJ1bGVzID0gdGhpcy50aW1lUnVsZXMuZ2V0QWdncmVnYXRpb25UaW1lUnVsZXMoKTtcbiAgICAgIHRoaXMudGltZVBlcmlvZHMgPSB0aGlzLnByb2Nlc3NNdWx0aXBsaWVycyh0aGlzLnRpbWVSdWxlcyk7XG4gICAgICB0aGlzLnNldEFjdGl2ZVBlcmlvZCh0aGlzLnN0YXJ0QWN0aXZlV2luZG93LCB0aGlzLmVuZEFjdGl2ZVdpbmRvdyk7XG4gICAgICB0aGlzLnRvb2xiYXJzID0gW107XG4gICAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG4gICAgICB0aGlzLmZsYWcgPSB0cnVlO1xuXG4gICAgICB0aGlzLnRvb2xiYXJzLnB1c2godGhpcy5jcmVhdGVUb29sYmFyKCkpO1xuXG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwub25Qcm9wc0NoYW5nZShbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0JywgJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLFxuICAgICAgICBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICAgIGlmIChpbnN0YW5jZS5mbGFnKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5mbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZXRBY3RpdmVQZXJpb2Qoc3RhcnRbMV0sIGVuZFsxXSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluc3RhbmNlLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnN0YW5jZS5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKChlbmRbMV0gLSBzdGFydFsxXSkgPj0gaW5zdGFuY2UudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5pbnRlcnZhbCkge1xuICAgICAgICAgICAgICAgICAgLy8gaW5zdGFuY2UuY2xpY2tlZElkID0gaW5zdGFuY2UudGltZVBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKyBpbnN0YW5jZS50aW1lUGVyaW9kc1tpXS5hYmJyZXZpYXRpb24uc2luZ2xlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5zdGFuY2UudG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgICBpbnN0YW5jZS50b29sYmFycy5wb3AoKTtcbiAgICAgICAgICAgIGluc3RhbmNlLnRvb2xiYXJzLnB1c2goaW5zdGFuY2UuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgICAgICAgIGluc3RhbmNlLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgaW5zdGFuY2UuZHJhdygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgY3JlYXRlVG9vbGJhciAoKSB7XG4gICAgICB2YXIgdW5pZ3JvdXAsXG4gICAgICAgIHRvb2xiYXIsXG4gICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zLFxuICAgICAgICBjb250ZXh0dWFsQnV0dG9ucyxcbiAgICAgICAgYWxsQnV0dG9uLFxuICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgZGVkdWN0b3JBciA9IFtdLFxuICAgICAgICBzdGFydE11bHRpcGxpZXIsXG4gICAgICAgIGRlZHVjdG9yLFxuICAgICAgICBpLFxuICAgICAgICBqLFxuICAgICAgICBjb250ZXh0dWFsQ29uZmlnLFxuICAgICAgICBmcm9tRGF0ZUxhYmVsLFxuICAgICAgICBncm91cDtcblxuICAgICAgZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwKHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSk7XG5cbiAgICAgIHVuaWdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5VbmlTZWxlY3RDb21wb25lbnRHcm91cCh7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuICAgICAgdW5pZ3JvdXAuc2V0Q29uZmlnKHtcbiAgICAgICAgZmlsbDogJyNmZmYnLFxuICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICAgIH0pO1xuICAgICAgZ3JvdXAuc2V0Q29uZmlnKHtcbiAgICAgICAgZmlsbDogJyNmZmYnLFxuICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICAgIH0pO1xuICAgICAgdG9vbGJhciA9IG5ldyB0aGlzLkhvcml6b250YWxUb29sYmFyKHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSk7XG4gICAgICB0b29sYmFyLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcbiAgICAgIGZyb21EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdab29tOicsIHtcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuICAgICAgfSwgc2VsZi5leHREYXRhLnN0eWxlWydsYWJlbC1jb25maWcnXSk7XG4gICAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG4gICAgICBhbGxCdXR0b24gPSBuZXcgdGhpcy50b29sYm94LlN5bWJvbCgnQUxMJywgdHJ1ZSwge1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9LCBzZWxmLmV4dERhdGEuc3R5bGVbJ2FsbC1jb25maWcnXSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2Qoc2VsZi5zdGFydERhdGFzZXQsIHNlbGYuZW5kRGF0YXNldCk7XG4gICAgICAgICAgdG9vbGJhci5kaXNwb3NlKCk7XG4gICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSAnQUxMJztcbiAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnBvcCgpO1xuICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucHVzaChzZWxmLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAvLyBzZWxmLmRyYXcoKTtcbiAgICAgICAgICAvLyBzZWxmLl9yZWYucmVBbGxvY2F0ZShzZWxmLnBhcmVudEdyb3VwKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9vbHRleHQ6ICdBTEwnXG4gICAgICB9KTtcblxuICAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKGFsbEJ1dHRvbik7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAoaiA9IHRoaXMuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICAgIGRlZHVjdG9yQXIucHVzaChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjYWxjdWxhdGVkQnV0dG9ucyA9IHt9O1xuICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9iaikge1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5XS5oaWRlKCk7XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBpID0gc2VsZi5zdGFydFBvaW50VW5pdDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKGkgPT09IHNlbGYuc3RhcnRQb2ludFVuaXQpIHtcbiAgICAgICAgICBzdGFydE11bHRpcGxpZXIgPSBzZWxmLnN0YXJ0UG9pbnRNdWx0aXBsaWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0YXJ0TXVsdGlwbGllciA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVycy5sZW5ndGggLSAxO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGogPSBzdGFydE11bHRpcGxpZXI7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgbGV0IGtleUFiYiA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgaWYgKHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNhbGN1bGF0ZWRCdXR0b25zID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2woa2V5QWJiLCB0cnVlLCB7XG4gICAgICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgICAgICAgIH0sIHNlbGYuZXh0RGF0YS5zdHlsZVsnY2FsY3VsYXRlZC1jb25maWcnXSkuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkZWR1Y3RvciA9IChzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubXVsdGlwbGllcnNbal0gKiBzZWxmLnN0YW5kYXJkQ2FsY3VsYXRlZFBlcmlvZHNbaV0ubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICBzZWxmLmNsaWNrZWRJZCA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgICAgICAgc2VsZi5zZXRBY3RpdmVQZXJpb2QoZGVkdWN0b3IpO1xuICAgICAgICAgICAgICAgIC8vIHRvb2xiYXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgICAgICAgLy8gc2VsZi50b29sYmFycy5wdXNoKHNlbGYuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgICAgICAgICAgICAvLyBzZWxmLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuICAgICAgICAgICAgICAgIC8vIHNlbGYuX3JlZi5yZUFsbG9jYXRlKHNlbGYucGFyZW50R3JvdXApO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMudG9vbGJhcnNbdGhpcy50b29sYmFycy5sZW5ndGggLSAxXSA9IHRoaXMuY3JlYXRlVG9vbGJhcigpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0b29sdGV4dDogc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLm11bHRpcGxpZXJzW2pdICsgJyAnICsgc2VsZi5zdGFuZGFyZENhbGN1bGF0ZWRQZXJpb2RzW2ldLmRlc2NyaXB0aW9uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdID0gY2FsY3VsYXRlZEJ1dHRvbnM7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHVuaWdyb3VwLmFkZFN5bWJvbChjYWxjdWxhdGVkQnV0dG9uc1tpXSk7XG4gICAgICAgICAgdGhpcy5jYWxjdWxhdGVkQnV0dG9uT2JqW2tleUFiYl0uc2hvdygpO1xuICAgICAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbCh0aGlzLmNhbGN1bGF0ZWRCdXR0b25PYmpba2V5QWJiXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gZm9yIChsZXQgaSA9IHNlbGYuc3RhcnRQb2ludFVuaXQ7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAvLyAgIGZvciAobGV0IGogPSBzdGFydE11bHRpcGxpZXI7IGogPj0gMDsgai0tKSB7XG4gICAgICAvLyAgICAgbGV0IGtleUFiYiA9IHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5tdWx0aXBsaWVyc1tqXSArIHNlbGYuc3RhbmRhcmRDYWxjdWxhdGVkUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAvLyAgICAgdW5pZ3JvdXAuYWRkU3ltYm9sKHRoaXMuY2FsY3VsYXRlZEJ1dHRvbk9ialtrZXlBYmJdKTtcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfVxuXG4gICAgICBjb250ZXh0dWFsQnV0dG9ucyA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnRleHR1YWxDb25maWcgPSAoaSA9PT0gMCkgPyBzZWxmLmV4dERhdGEuc3R5bGVbJ2NvbnRleHR1YWwtY29uZmlnLWZpcnN0J10gOiBzZWxmLmV4dERhdGEuc3R5bGVbJ2NvbnRleHR1YWwtY29uZmlnJ107XG4gICAgICAgIGNvbnRleHR1YWxCdXR0b25zW2ldID0gbmV3IHRoaXMudG9vbGJveC5TeW1ib2wodGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uYWJicmV2aWF0aW9uLCB0cnVlLCB7XG4gICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgICB9LCBjb250ZXh0dWFsQ29uZmlnKS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLnNldEFjdGl2ZVBlcmlvZChzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5kYXRlU3RhcnQsIHNlbGYuc3RhbmRhcmRDb250ZXh1YWxQZXJpb2RzW2ldLmRhdGVFbmQpO1xuICAgICAgICAgICAgc2VsZi5jbGlja2VkSWQgPSBzZWxmLnN0YW5kYXJkQ29udGV4dWFsUGVyaW9kc1tpXS5hYmJyZXZpYXRpb247XG4gICAgICAgICAgICAvLyB0b29sYmFyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIC8vIHNlbGYudG9vbGJhcnMucG9wKCk7XG4gICAgICAgICAgICAvLyBzZWxmLnRvb2xiYXJzLnB1c2goc2VsZi5jcmVhdGVUb29sYmFyKCkpO1xuICAgICAgICAgICAgLy8gc2VsZi5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgICAgICAgIC8vIHNlbGYuZHJhdygpO1xuICAgICAgICAgICAgLy8gc2VsZi5fcmVmLnJlQWxsb2NhdGUoc2VsZi5wYXJlbnRHcm91cCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b29sdGV4dDogdGhpcy5zdGFuZGFyZENvbnRleHVhbFBlcmlvZHNbaV0uZGVzY3JpcHRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIHVuaWdyb3VwLmFkZFN5bWJvbChjb250ZXh0dWFsQnV0dG9uc1tpXSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuU3ltYm9sU3RvcmUucmVnaXN0ZXIoJ3RleHRCb3hJY29uJywgZnVuY3Rpb24gKHgsIHksIHJhZCwgdywgaCwgcGFkWCwgcGFkWSkge1xuICAgICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcbiAgICAgICAgICB4MiA9IHggKyB3IC8gMiAtIHBhZFggLyAyLFxuICAgICAgICAgIHkxID0geSAtIGggLyAyICsgcGFkWSAvIDIsXG4gICAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblxuICAgICAgICByZXR1cm4gWydNJywgeDEsIHkxLCAnTCcsIHgyLCB5MSwgJ0wnLCB4MiwgeTIsICdMJywgeDEsIHkyLCAnWiddO1xuICAgICAgfSk7XG5cbiAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KGdyb3VwKTtcbiAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KHVuaWdyb3VwKTtcbiAgICAgIHRoaXMudG9vbGJhciA9IHRvb2xiYXI7XG4gICAgICByZXR1cm4gdG9vbGJhcjtcbiAgICB9O1xuXG4gICAgZ2V0TG9naWNhbFNwYWNlIChhdmFpbGFibGVXaWR0aCA9IHRoaXMuX3BXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0ID0gdGhpcy5fcEhlaWdodCkge1xuICAgICAgLy8gYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICAgIHZhciBsb2dpY2FsU3BhY2UsXG4gICAgICAgIHdpZHRoID0gNDIwLCAvLyB3aWR0aCBoYXJkY29kZWQ7IFRPRE86IG1ha2UgaXQgZHluYW1pY1xuICAgICAgICBoZWlnaHQgPSAwLFxuICAgICAgICBpLFxuICAgICAgICBsbjtcblxuICAgICAgZm9yIChpID0gMCwgbG4gPSB0aGlzLnRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgbG9naWNhbFNwYWNlID0gdGhpcy50b29sYmFyc1tpXS5nZXRMb2dpY2FsU3BhY2UoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIC8vIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG4gICAgICAgIGhlaWdodCArPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgICB9XG4gICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICBoZWlnaHQ6IGhlaWdodFxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgZ2V0RGVmYXVsdEdyb3VwICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhcmVudEdyb3VwO1xuICAgIH1cblxuICAgIHBsYWNlSW5DYW52YXMgKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICAgIHNlbGYuc3BhY2VNYW5hZ2VySW5zdGFuY2UuYWRkKFt7XG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJ3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci1leHQnO1xuICAgICAgICB9LFxuICAgICAgICByZWY6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGY6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpb3JpdHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgfSxcbiAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIG9ialtzZWxmLmV4dERhdGEubGF5b3V0XTtcbiAgICAgICAgfSxcbiAgICAgICAgb3JpZW50YXRpb246IFt7XG4gICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIG9ialtzZWxmLmV4dERhdGEub3JpZW50YXRpb25dO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcG9zaXRpb246IFt7XG4gICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYmpbc2VsZi5leHREYXRhLnBvc1dydENhbnZhc107XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWxpZ25tZW50OiBbe1xuICAgICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9ialtzZWxmLmV4dERhdGEuYWxpZ25tZW50XTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGltZW5zaW9uczogW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3JlZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0TG9naWNhbFNwYWNlKChzZWxmLl9wV2lkdGggPSBwYXJlbnQuZ2V0V2lkdGgoKSksIChzZWxmLl9wSGVpZ2h0ID0gcGFyZW50LmdldEhlaWdodCgpKSk7XG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dXG4gICAgICAgIH1dXG4gICAgICB9XSk7XG4gICAgfTtcblxuICAgIHNldERyYXdpbmdDb25maWd1cmF0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG4gICAgICBtZXMueCA9IHg7XG4gICAgICBtZXMueSA9IHk7XG4gICAgICBtZXMud2lkdGggPSB3aWR0aDtcbiAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgIHRoaXMucGFyZW50R3JvdXAgPSBncm91cDtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIGRyYXcgKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG4gICAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG4gICAgICAgIGxuLFxuICAgICAgICBpLFxuICAgICAgICB0b29sYmFyLFxuICAgICAgICBib3VuZEVsZW1lbnQsXG4gICAgICAgIGJCb3gsXG4gICAgICAgIHgxLFxuICAgICAgICB4MixcbiAgICAgICAgeTIsXG4gICAgICAgIHNlbGVjdExpbmU7XG5cbiAgICAgIHRoaXMuZmxhZyA9IHRydWU7XG4gICAgICBzZWxlY3RMaW5lID0gdGhpcy5zYXZlU2VsZWN0TGluZSB8fCB0aGlzLmdyYXBoaWNzLnBhcGVyLnBhdGgoe1xuICAgICAgICAnc3Ryb2tlJzogJyNjOTVhNWEnLFxuICAgICAgICAnc3Ryb2tlLXdpZHRoJzogJzJweCdcbiAgICAgIH0pLnRvRnJvbnQoKTtcbiAgICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcbiAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcbiAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcbiAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcbiAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc2F2ZVNlbGVjdExpbmUgPSBzZWxlY3RMaW5lO1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdG9vbGJhcnNbMF0uY29tcG9uZW50R3JvdXBzWzFdLnN5bWJvbExpc3Q7IGkgPCBpaS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaWlbaV0uc3ltYm9sID09PSB0aGlzLmNsaWNrZWRJZCkge1xuICAgICAgICAgIGJvdW5kRWxlbWVudCA9IGlpW2ldLmdldEJvdW5kRWxlbWVudCgpO1xuICAgICAgICAgIGJCb3ggPSBib3VuZEVsZW1lbnQuZ2V0QkJveCgpO1xuICAgICAgICAgIHgxID0gYkJveC54O1xuICAgICAgICAgIHgyID0gYkJveC54MjtcbiAgICAgICAgICB5MiA9IGJCb3gueTI7XG5cbiAgICAgICAgICBzZWxlY3RMaW5lLmF0dHIoe1xuICAgICAgICAgICAgcGF0aDogWydNJywgeDEgLSAwLjUsIHkyIC0gMC41LCAnTCcsIHgyICsgMC41LCB5MiAtIDAuNV1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIFN0YW5kYXJkUGVyaW9kU2VsZWN0b3I7XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3N0YW5kYXJkLXBlcmlvZC1zZWxlY3Rvci5qcyJdLCJzb3VyY2VSb290IjoiIn0=
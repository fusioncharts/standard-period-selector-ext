(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p='',b(0)})([function(a,b,c){'use strict';const d=c(1);(function(e,f){'object'==typeof a&&a.exports?a.exports=e.document?f(e):function(g){if(!g.document)throw new Error('Window with document not present');return f(g,!0)}:e.StandardPeriodSelector=f(e,!0)})('undefined'==typeof window?this:window,function(e){var g=e.FusionCharts;g.register('extension',['private','standard-period-selector',function(){g.registerComponent('extensions','standard-period-selector',d({FusionCharts:g}))}])})},function(a){'use strict';a.exports=function(){return class{constructor(){var e=this;e.ratio=8,e.toolbox=FusionCharts.getComponent('api','toolbox'),e.HorizontalToolbar=e.toolbox.HorizontalToolbar,e.ComponentGroup=e.toolbox.ComponentGroup,e.SymbolStore=e.toolbox.SymbolStore,e.all=1,e.calculatedPeriods=[],e.startDataset=0,e.startActiveWindow=0,e.endActiveWindow=1,e.standardCalculatedPeriods=[],e.standardContexualPeriods=[],e.startPointUnit=0,e.startPointMultiplier=0,e.noCalcButtons=0,e.minimumBucket=1,e.buttonGroup={},e.toolbar={},e.categoryClicked,e.btns={contextualObj:{},calculatedObj:{}},e.tdButtons=[{name:'YTD',abbreviation:'YTD',parent:'year',milliseconds:31104000000,description:'Year till Date'},{name:'QTD',abbreviation:'QTD',parent:'month',multiplier:3,milliseconds:7776000000,description:'Quarter till Date'},{name:'MTD',abbreviation:'MTD',parent:'month',milliseconds:2592000000,description:'Month till Date'},{name:'WTD',abbreviation:'WTD',parent:'day',multiplier:7,milliseconds:604800000,description:'Week till Date'},{name:'Y',abbreviation:'Y',parent:'day',milliseconds:86400000,description:'Yesterday'},{name:'T',abbreviation:'T',parent:'day',milliseconds:86400000,description:'Today'}],e.config={anchorPositions:'right',all:'1',contextual:'1',calculated:'1',tertiaryTimePeriods:{}},e._babTimer=0,e.propsChangeListener=(f,g)=>{e.startActiveWindow=f[1],e.endActiveWindow=g[1],e._babTimer?!e.updatePending&&(e.updatePending=!0,setTimeout(function(){e.updatePending=!1,e.onActiveRangeChange()},e._babTimer)):(e._babTimer=200,e.onActiveRangeChange())}}hideAllCalcBtns(){var g,e=this,f=e.btns.calculatedObj;for(g in f)f[g].btn.hide()}showApplicableCalculatedButtons(){var f,o,t,u,e=this,g=0,h=0,l=0,m=0,n=e.endActiveWindow-e.startActiveWindow,p=e.anchorPositions,q=e.btns.calculatedObj,r=e.timePeriods,s=0,v=[],w=e.minimumBucket,z=e.maximumBucket;for('right'===p?f=e.endActiveWindow-e.startDataset:'left'===p&&(f=e.endDataset-e.startActiveWindow),e.hideAllCalcBtns(),(g=0,h=r.length);g<h;g++)if(s=r[g].interval,t=r[g].name,u=r[g].abbreviation.single,1<=f/s)if(1>Math.floor(n/s))v.push({name:t,abbreviation:u,multipliers:[1]});else for(v.push({name:t,abbreviation:u,multipliers:[]}),l=0,m=r[g].multipliers.length;l<m;l++)n/e.ratio<r[g].multipliers[l]*s&&r[g].multipliers[l]*s>w&&r[g].multipliers[l]*s<z&&v[v.length-1].multipliers.push(r[g].multipliers[l]);for(g=0,h=v.length;g<h;g++)for(l=0,m=v[g].multipliers.length;l<m;l++)o=v[g].multipliers[l]+v[g].name,q[o]&&q[o].btn&&q[o].btn.show();e.standardCalculatedPeriods=v,e.toolbar&&e.toolbar.redraw(),e.state?e.buttonGroup.setState&&e.buttonGroup.setState(e.state):e.buttonGroup.setState&&e.buttonGroup.setState(null)}highlightActiveRange(){var g,e=this,f=e.clickedId,h=e.btns.contextualObj,l=e.btns.calculatedObj;g=h[f]||l[f]||e.btns[f],g&&g.btn?(e.buttonGroup.setState(g.btn),e.state=g.btn):e.buttonGroup.setState(null)}onActiveRangeChange(){var f,g,s,e=this,h=e.categoryClicked,l=e.clickedId,m=e.startDataset,n=e.endDataset,o=e.startActiveWindow,p=e.endActiveWindow,q=e.btns.contextualObj,r=e.btns.calculatedObj;if('ALL'===h)m===o&&n===p||(delete e.clickedId,delete e.categoryClicked);else if('contextual'===h)s=q[l],s&&(o!==s.contextStart||p!==s.contextEnd)&&(delete e.clickedId,delete e.categoryClicked);else if('calculated'===h)s=r[l],s&&p-o!==s.interval&&(delete e.clickedId,delete e.categoryClicked);else if(m===o&&n===p)e.clickedId='ALL',e.categoryClicked='ALL';else{for(f in q)s=q[f],o===s.contextStart&&p===s.contextEnd&&(e.clickedId=f,e.categoryClicked='contextual',g=!0);if(!g)for(f in r)s=r[f],p-o===s.interval&&(e.clickedId=f,e.categoryClicked='calculated');g||delete e.state}e.toolbarDrawn&&(e.showApplicableCalculatedButtons(),e.highlightActiveRange())}processMultipliers(e,f){for(let g=0,h=e.length;g<h;g++){let l=e[g].possibleFactors.length,m=e[g]&&e[g].name,n=e&&e[g];n.multipliers=[],f===void 0&&(f={}),f[m]?n.multipliers=f[m]:1===l?n.multipliers.push(n.possibleFactors[0]):2===l?(n.multipliers.push(n.possibleFactors[0]),n.multipliers.push(n.possibleFactors[l-1])):(n.multipliers.push(n.possibleFactors[0]),n.multipliers.push(Math.floor(n.possibleFactors[l-1]/2)),n.multipliers.push(n.possibleFactors[l-1]))}return e}createCalculatedButtons(e){var h,f=this,g=f.btns.calculatedObj,l=f.anchorPositions,m=f.minimumBucket,n=f.maximumBucket,o=f.globalReactiveModel.model,p={};for(let q=f.timePeriods.length-1;0<=q;q--)for(let r=f.timePeriods[q].multipliers.length-1;0<=r;r--){let s=f.timePeriods[q].multipliers[r],t=s+f.timePeriods[q].abbreviation.single,u=s+f.timePeriods[q].name,v=s+' '+f.timePeriods[q].name+(1<s?'s':''),w=f.timePeriods[q].multipliers[r]*f.timePeriods[q].interval;w>m&&w<n&&(h=g[u]={interval:w,fn:function(){f.clickedId=u,f.categoryClicked='calculated',f.highlightActiveRange(),'right'===l?o['x-axis-absolute-range-start']>f.endActiveWindow-w?f.globalReactiveModel.lock().prop('x-axis-visible-range-end',o['x-axis-absolute-range-start']+w).prop('x-axis-visible-range-start',f.startDataset).unlock():o['x-axis-visible-range-start']=f.endActiveWindow-w:o['x-axis-absolute-range-end']<f.startActiveWindow+w?f.globalReactiveModel.lock().prop('x-axis-visible-range-end',f.endDataset).prop('x-axis-visible-range-start',o['x-axis-absolute-range-end']-w).unlock():o['x-axis-visible-range-end']=f.startActiveWindow+w},shortKey:t},p[u]={text:t,config:{toolText:v,height:22,radius:1,margin:{left:-4.5}},group:e,eventListeners:{click:h.fn}},f.btns.calculatedObj[u]=h)}f.createD3Buttons(p,'calculatedObj')}generateCtxBtnList(){var e=this,f=e.standardContexualPeriods,g=[],h=0,l=0,m=0,n=0,o=0,p=e.globalReactiveModel.model['x-axis-absolute-range-end'],q=p-2,r=p,s={},t=e.tdButtons,u=e.minimumBucket||1,v=e.startActiveWindow,w=e.endActiveWindow;for(l=t.length;h<l;h++)if(q=new Date(p),'YTD'===t[h].name?(q.setMonth(0),q.setDate(1),q.setHours(0),q.setMinutes(0),q.setSeconds(0)):'MTD'===t[h].name?(q.setDate(1),q.setHours(0),q.setMinutes(0),q.setSeconds(0)):'QTD'===t[h].name?(q.setMonth(11-q.getMonth()%3),q.setDate(1),q.setHours(0),q.setMinutes(0),q.setSeconds(0)):'WTD'===t[h].name?(q.setDate(q.getDate()-q.getDay()),q.setHours(0),q.setMinutes(0),q.setSeconds(0)):'Y'===t[h].name?(q.setHours(0),q.setMinutes(0),q.setSeconds(0),q-=8.64e7):'T'===t[h].name&&(q.setHours(0),q.setMinutes(0),q.setSeconds(0),p===+q&&(q=+q-8.64e7)),r<q&&r-q<u)continue;else t[h].dateStart=q.valueOf(),t[h].dateEnd=r.valueOf(),g.push(t[h]);for(m=0,n=g.length-1;m<n;m++)for(o=m+1;o<n;o++)g[m].dateStart===g[o].dateStart&&(g[m].redundant=!0);for(m in g)g[m].redundant||f.push(g[m]);for(s.milliseconds=1/0,h=0,l=t.length;h<l;h++)Math.abs(t[h].milliseconds-(w-v))<s.milliseconds&&(s.milliseconds=t[h].milliseconds,s.name=t[h].abbreviation)}createContextualButtons(e){var h,l,f=this,g=f.btns.contextualObj,m=0,n={};f.generateCtxBtnList();for(let o=0,p=this.standardContexualPeriods.length;o<p;o++)f.standardContexualPeriods[o].dateEnd-f.standardContexualPeriods[o].dateStart>=f.minimumBucket&&f.standardContexualPeriods[o].dateStart>f.startDataset&&(l=f.standardContexualPeriods[o].abbreviation,h=g[l]={contextStart:f.standardContexualPeriods[o].dateStart,contextEnd:f.standardContexualPeriods[o].dateEnd,fn:function(){f.categoryClicked='contextual',f.clickedId=f.standardContexualPeriods[o].abbreviation,f.highlightActiveRange(),f.globalReactiveModel.lock().prop('x-axis-visible-range-end',f.standardContexualPeriods[o].dateEnd).prop('x-axis-visible-range-start',f.standardContexualPeriods[o].dateStart).unlock()}},n[f.standardContexualPeriods[o].abbreviation]={text:f.standardContexualPeriods[o].abbreviation,config:{toolText:f.standardContexualPeriods[o].description,height:22,radius:1,margin:{left:m}},group:e,eventListeners:{click:h.fn}},m=-5,f.btns.contextualObj[f.standardContexualPeriods[o].abbreviation]=h);f.createD3Buttons(n,'contextualObj')}addCssRules(e,f){var g,h,l=this.graphics.paper;for(g in e)h=e[g],'container'===g?f.container&&l.cssAddRule('.'+h,f.container.style):'text'===g?f.text&&l.cssAddRule('.'+h,f.text.style):void 0}createD3Buttons(e,f){var g,h,l,m,n,o,p,q=this.extData.button,r=this.graphics.paper,s=r.getInstances().d3,t=this;for(g in e){for(o in h=e[g],l=h.text,m=h.config,f?(!t.btns[f][g]&&(t.btns[f][g]={}),p=t.btns[f][g].btn=s.button(l).setConfig(m)):(!t.btns[g]&&(t.btns[g]={}),p=t.btns[g].btn=s.button(l).setConfig(m)),p.namespace('fusioncharts'),p.appendSelector('standarperiodselector'),t.addCssRules(p.getIndividualClassNames(p.getClassName()),q),n=q.states,n)t.addCssRules(p.getIndividualClassNames(p.getStateClassName(o)),q.states[o]);h.eventListeners&&p.attachEventHandlers({click:h.eventListeners.click.bind(p)}),h.group.addSymbol(p)}}createD3Labels(e){var f,g,h,l,m=this.extData.label,n=this,o={paper:n.graphics.paper,chart:n.chart,smartLabel:n.smartLabel,chartContainer:n.graphics.container};for(f in e)g=e[f],h=g.text,l=g.config,n[f]=new n.toolbox.Label(h,o,l),n.addCssRules(n[f].getIndividualClassNames(n[f].getClassName()),m),g.group.addSymbol(n[f])}createToolbar(){var f,g,h,l,m,n,o,p,e=this,q=e.graphics.paper,r={paper:e.graphics.paper,chart:e.chart,smartLabel:e.smartLabel,chartContainer:e.graphics.container};g=new e.HorizontalToolbar(r),g.setConfig({fill:'#fff',borderThickness:0}),o=new e.toolbox.ComponentGroup(r),f=new e.toolbox.UniSelectComponentGroup(r),f.defineStateIndicator(function(s){var t=s.getBBox(),u=t.x,v=u+t.width,w=t.y+t.height;return{type:'path',attrs:{d:['M',u+1,w-1.2,'L',v,w-1.2].join(' '),'stroke-width':2,stroke:'#c95a5a'}}}),p=new e.toolbox.ComponentGroup(r),f.setConfig({fill:'#fff',borderThickness:0}),o.setConfig({fill:'#fff',borderThickness:0}),l={ZOOM:{text:'Zoom:',config:{className:'standard-period-selector-'+q.getId(),height:22,margin:{right:-12}},group:o}},e.createD3Labels(l),h=e.allButtonShow&&{fn:function(){e.clickedId='ALL',e.state=this,e.categoryClicked='ALL',e.highlightActiveRange(),e.globalReactiveModel.lock().prop('x-axis-visible-range-end',e.globalReactiveModel.prop('x-axis-absolute-range-end')).prop('x-axis-visible-range-start',e.startDataset).unlock()}},n={ALL:{text:'ALL',config:{height:22,radius:1,toolText:'Full Data',margin:{right:10}},group:f,eventListeners:{click:h.fn}}},m={dummy:{text:'___',config:{height:22,radius:1},group:p}},h&&(e.btns.ALL=h,e.createD3Buttons(n));for(let s=0;6>s;s++)e.btns.dummy={},e.createD3Buttons(m,'dummy');return g.addComponent(o),g.addComponent(f),g.addComponent(p),e.toolbar=g,e.dummyButtonGroup=p,e.buttonGroup=f,g}appendButtons(){var e=this,f=e.buttonGroup;!Object.keys(e.btns.calculatedObj).length&&e.calculatedButtonShow&&e.createCalculatedButtons(f),!Object.keys(e.btns.contextualObj).length&&e.contextualButtonShow&&e.createContextualButtons(f)}init(e){var f=this;return e(['graphics','chart','canvasConfig','MarkerManager','reactiveModel','globalReactiveModel','spaceManagerInstance','smartLabel','extData','chartInstance','customExtremes',function(g,h,l,m,n,o,p,q,r,s,t){f.graphics=g,f.chart=h,f.markerManager=m,f.canvasConfig=l,f.reactiveModel=n,f.globalReactiveModel=o,f.spaceManagerInstance=p,f.smartLabel=q,f.extDataUser=r,f.chartInstance=s,f.customExtremes=t}]),f.extData={disabled:!1,'default-select':'ALL','all-button':!0,'contextual-button':!0,'calculated-button':!0,posWrtCanvas:'top','anchor-align':'right',layout:'inline',alignment:'left',orientation:'horizontal',customMultipliers:{millisecond:[1,500],second:[1,5,15,30],minute:[1,5,15,30],hour:[1,3,6,12],day:[1,7,15],month:[1,3,6],year:[1,3,5]},button:{height:22,radius:1,className:'standard-period-selector',container:{style:{fill:'#FFFFFF','stroke-width':'1px',stroke:'#CED5D4',labelFill:'#4b4b4b',strokeWidth:'1px'}},text:{style:{fontFamily:'"Lucida Grande", sans-serif','font-size':'13px',fill:'#4b4b4b','line-height':'1px','letter-spacing':'-0.04em'}},states:{hover:{className:'standard-period-selector-state-hover',container:{style:{cursor:'pointer',fill:'#f7f7f7'}}}}},label:{height:22,className:'standard-period-selector-label',text:{style:{'font-weight':'bold','font-family':'"Lucida Grande", Regular','font-size':'13px',fill:'#4b4b4b'}}}},Object.assign(f.extData,f.extDataUser),f}configure(){var e=this;e.endActiveWindow=e.globalReactiveModel.model['x-axis-visible-range-end'],e.startActiveWindow=e.globalReactiveModel.model['x-axis-visible-range-start'],e.startDataset=e.globalReactiveModel.model['x-axis-absolute-range-start'],e.endDataset=e.globalReactiveModel.model['x-axis-absolute-range-end'],e.maximumBucket=e.endDataset-e.startDataset,e.timeRules=e.chartInstance.apiInstance.getComponentStore(),e.timeRules=e.timeRules.getCanvasByIndex(0).composition.impl,e.timeRules=e.timeRules.getDataAggregator(),e.timeRules=e.timeRules.getAggregationTimeRules(),e.timePeriods=e.processMultipliers(e.timeRules,e.extData.customMultipliers),e.allButtonShow=e.extData['all-button'],e.calculatedButtonShow=e.extData['calculated-button'],e.contextualButtonShow=e.extData['contextual-button'],e.anchorPositions=e.extData['anchor-align'],e.customMultipliers=e.extData.customMultipliers,e.keySelect=e.extData['default-select'],e.measurement={},e.flag=!0,e.toolbars=[],e.toolbars.push(e.createToolbar()),e.globalReactiveModel.onPropsChange(['x-axis-visible-range-start','x-axis-visible-range-end'],e.propsChangeListener),e.globalReactiveModel.onPropChange('x-axis-absolute-range-end',function(){'contextual'===e.categoryClicked&&(e.globalReactiveModel.model['x-axis-visible-range-end']=e.globalReactiveModel.model['x-axis-absolute-range-end'])})}getLogicalSpace(e=this._pWidth,f=this._pHeight){var g,m,n,h=0,l=0,o=this;for(m=0,n=o.toolbars.length;m<n;m++)g=o.toolbars[m].getLogicalSpace(e,f),h=Math.max(g.width,h),l+=g.height,o.toolbars[m].width=g.width,o.toolbars[m].height=g.height;return l+=o.padding,{width:h,height:l}}getDefaultGroup(){return this.parentGroup}placeInCanvas(){var e=this;e.padding=5,e.spaceManagerInstance.add([{name:function(){return'standard-period-selector-ext'},ref:function(f){var g=e.extData.ref;return g===void 0?f.chart:g},self:function(){return e},priority:function(){return 2},layout:function(f){return f[e.extData.layout]||'inline'},orientation:[{type:function(f){return f[e.extData.orientation]||'horizontal'},position:[{type:function(f){return f[e.extData.posWrtCanvas]||'top'},alignment:[{type:function(f){return f[e.extData.alignment]||'left'},dimensions:[function(){var f=this.getParentComponentGroup();return e._ref=this,e.getLogicalSpace(e._pWidth=f.getWidth(),e._pHeight=f.getHeight())}]}]}]}]}],Object.keys(this.chartInstance.apiInstance.getComponentStore().getAllCanvas()).length)}setDrawingConfiguration(e,f,g,h,l){var m=this.measurement;return m.x=e,m.y=f,m.width=g,m.height=h,this.parentGroup=l,this}draw(e,f,g,h,l){var p,q,r,v,B,C,m=this,n=m.measurement,o=m.toolbars,s=m.btns.contextualObj,t=m.btns.calculatedObj,u=m.clickedId,w=m.globalReactiveModel.model,z=m.minimumBucket,A=m.buttonGroup;if(z=w['minimum-consecutive-datestamp-diff']*w['x-axis-maximum-allowed-ticks'],m.minimumBucket=z,m.dummyButtonGroup.dispose(),o[0].removeComponent(m.dummyButtonGroup),m.appendButtons(),A.getLogicalSpace(),!Object.keys(m.customExtremes).length&&m.keySelect){if('ALL'===m.keySelect)m.clickedId='ALL',m.state=m.btns.ALL.btn;else if(s[m.keySelect])m.clickedId=m.keySelect;else for(C in B=!0,t)B&&t[C].shortKey===m.keySelect&&(m.clickedId=C,B=!1);delete m.keySelect,u=m.clickedId}if(e=void 0===e?n.x:e,f=void 0===f?n.y:f,g=void 0===g?n.width:g,h=void 0===h?n.height:h,l=void 0===l?this.parentGroup:l,g&&h){for(q=0,p=o.length;q<p;q++)r=o[q],r.draw(e,f,l),m.toolbarDrawn=!0;u?(v=t[u]||s[u]||m.btns[u],v?v.fn&&v.fn():m.onActiveRangeChange()):m.onActiveRangeChange()}}}}}]);
//# sourceMappingURL=standard-period-selector.min.js.map
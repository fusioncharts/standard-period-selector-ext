(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p='',b(0)})([function(a,b,c){'use strict';const d=c(1);(function(e,f){'object'==typeof a&&a.exports?a.exports=e.document?f(e):function(g){if(!g.document)throw new Error('Window with document not present');return f(g,!0)}:e.StandardPeriodSelector=f(e,!0)})('undefined'==typeof window?this:window,function(e){var g=e.FusionCharts;g.register('extension',['private','standard-period-selector',function(){g.registerComponent('extensions','standard-period-selector',d({FusionCharts:g}))}])})},function(a){'use strict';a.exports=function(){return class{constructor(){var e=this;e.ratio=8,e.toolbox=FusionCharts.getComponent('api','toolbox'),e.HorizontalToolbar=e.toolbox.HorizontalToolbar,e.ComponentGroup=e.toolbox.ComponentGroup,e.SymbolStore=e.toolbox.SymbolStore,e.all=1,e.calculatedPeriods=[],e.startDataset=0,e.startActiveWindow=0,e.endActiveWindow=1,e.standardCalculatedPeriods=[],e.standardContexualPeriods=[],e.startPointUnit=0,e.startPointMultiplier=0,e.noCalcButtons=0,e.minimumBucket=1,e.buttonGroup={},e.toolbar={},e.categoryClicked,e.btns={contextualObj:{},calculatedObj:{}},e.tdButtons=[{name:'YTD',abbreviation:'YTD',parent:'year',milliseconds:31104000000,description:'Year to Date'},{name:'QTD',abbreviation:'QTD',parent:'month',multiplier:3,milliseconds:7776000000,description:'Quarter to Date'},{name:'MTD',abbreviation:'MTD',parent:'month',milliseconds:2592000000,description:'Month to Date'},{name:'WTD',abbreviation:'WTD',parent:'day',multiplier:7,milliseconds:604800000,description:'Week to Date'},{name:'Y',abbreviation:'Y',parent:'day',milliseconds:86400000,description:'Yesterday'},{name:'T',abbreviation:'T',parent:'day',milliseconds:86400000,description:'Today'}],e.config={anchorPositions:'right',all:'1',contextual:'1',calculated:'1',tertiaryTimePeriods:{}},e._babTimer=0,e.propsChangeListener=(f,g)=>{e.startActiveWindow=f[1],e.endActiveWindow=g[1],e._babTimer?!e.updatePending&&(e.updatePending=!0,setTimeout(function(){e.updatePending=!1,e.onActiveRangeChange()},e._babTimer)):(e._babTimer=200,e.onActiveRangeChange())}}hideAllCalcBtns(){var g,e=this,f=e.btns.calculatedObj;for(g in f)f[g].btn.hide()}showApplicableCalculatedButtons(){var f,n,s,t,e=this,g=0,h=0,k=0,l=0,m=e.endActiveWindow-e.startActiveWindow,o=e.anchorPositions,p=e.btns.calculatedObj,q=e.timePeriods,r=0,u=[],v=e.minimumBucket,w=e.maximumBucket;for('right'===o?f=e.endActiveWindow-e.startDataset:'left'===o&&(f=e.endDataset-e.startActiveWindow),e.hideAllCalcBtns(),(g=0,h=q.length);g<h;g++)if(r=q[g].interval,s=q[g].name,t=q[g].abbreviation.single,1<=f/r)if(1>Math.floor(m/r))u.push({name:s,abbreviation:t,multipliers:[1]});else for(u.push({name:s,abbreviation:t,multipliers:[]}),k=0,l=q[g].multipliers.length;k<l;k++)m/e.ratio<q[g].multipliers[k]*r&&q[g].multipliers[k]*r>v&&q[g].multipliers[k]*r<w&&u[u.length-1].multipliers.push(q[g].multipliers[k]);for(g=0,h=u.length;g<h;g++)for(k=0,l=u[g].multipliers.length;k<l;k++)n=u[g].multipliers[k]+u[g].name,p[n]&&p[n].btn&&p[n].btn.show();e.standardCalculatedPeriods=u,e.toolbar&&e.toolbar.redraw(),e.state?e.buttonGroup.setState&&e.buttonGroup.setState(e.state):e.buttonGroup.setState&&e.buttonGroup.setState(null)}highlightActiveRange(){var g,e=this,f=e.clickedId,h=e.btns.contextualObj,k=e.btns.calculatedObj;g=h[f]||k[f]||e.btns[f],g&&g.btn&&(e.buttonGroup.setState(g.btn),e.state=g.btn)}onActiveRangeChange(){var f,g,r,e=this,h=e.categoryClicked,k=e.clickedId,l=e.startDataset,m=e.endDataset,n=e.startActiveWindow,o=e.endActiveWindow,p=e.btns.contextualObj,q=e.btns.calculatedObj;if('ALL'===h)l===n&&m===o||(delete e.clickedId,delete e.categoryClicked);else if('contextual'===h)r=p[k],r&&(n!==r.contextStart||o!==r.contextEnd)&&(delete e.clickedId,delete e.categoryClicked);else if('calculated'===h)r=q[k],r&&o-n!==r.interval&&(delete e.clickedId,delete e.categoryClicked);else if(l===n&&m===o)e.clickedId='ALL',e.categoryClicked='ALL';else{for(f in p)r=p[f],n===r.contextStart&&o===r.contextEnd&&(e.clickedId=f,e.categoryClicked='contextual',g=!0);if(!g)for(f in q)r=q[f],o-n===r.interval&&(e.clickedId=f,e.categoryClicked='calculated');g||delete e.state}e.toolbarDrawn&&(e.showApplicableCalculatedButtons(),e.highlightActiveRange())}processMultipliers(e,f){for(let g=0,h=e.length;g<h;g++){let k=e[g].possibleFactors.length,l=e[g]&&e[g].name,m=e&&e[g];m.multipliers=[],f===void 0&&(f={}),f[l]?m.multipliers=f[l]:1===k?m.multipliers.push(m.possibleFactors[0]):2===k?(m.multipliers.push(m.possibleFactors[0]),m.multipliers.push(m.possibleFactors[k-1])):(m.multipliers.push(m.possibleFactors[0]),m.multipliers.push(Math.floor(m.possibleFactors[k-1]/2)),m.multipliers.push(m.possibleFactors[k-1]))}return e}createCalculatedButtons(e){var h,f=this,g=f.btns.calculatedObj,k=f.anchorPositions,l=f.minimumBucket,m=f.maximumBucket,n=f.globalReactiveModel.model,o={};for(let p=f.timePeriods.length-1;0<=p;p--)for(let q=f.timePeriods[p].multipliers.length-1;0<=q;q--){let r=f.timePeriods[p].multipliers[q]+f.timePeriods[p].abbreviation.single,s=f.timePeriods[p].multipliers[q]+f.timePeriods[p].name,t=f.timePeriods[p].multipliers[q]*f.timePeriods[p].interval;t>l&&t<m&&(h=g[s]={interval:t,fn:function(){f.clickedId=s,f.categoryClicked='calculated',f.highlightActiveRange(),'right'===k?n['x-axis-absolute-range-start']>f.endActiveWindow-t?f.globalReactiveModel.lock().prop('x-axis-visible-range-end',n['x-axis-absolute-range-start']+t).prop('x-axis-visible-range-start',f.startDataset).unlock():n['x-axis-visible-range-start']=f.endActiveWindow-t:n['x-axis-absolute-range-end']<f.startActiveWindow+t?f.globalReactiveModel.lock().prop('x-axis-visible-range-end',f.endDataset).prop('x-axis-visible-range-start',n['x-axis-absolute-range-end']-t).unlock():n['x-axis-visible-range-end']=f.startActiveWindow+t},shortKey:r},o[s]={text:r,config:{toolText:s,height:22,radius:1,margin:{left:-4.5}},group:e,eventListeners:{click:h.fn}},f.btns.calculatedObj[s]=h)}f.createD3Buttons(o,'calculatedObj')}generateCtxBtnList(){var e=this,f=e.standardContexualPeriods,g=0,h=0,k=e.globalReactiveModel.model['x-axis-absolute-range-end'],l=k-2,m=k,n={},o=e.tdButtons,p=e.minimumBucket||1,q=e.startActiveWindow,r=e.endActiveWindow;for(h=o.length;g<h;g++)if(l=new Date(k),'YTD'===o[g].name?(l.setMonth(0),l.setDate(1),l.setHours(0),l.setMinutes(0),l.setSeconds(0)):'MTD'===o[g].name?(l.setDate(1),l.setHours(0),l.setMinutes(0),l.setSeconds(0)):'QTD'===o[g].name?(l.setMonth(11-l.getMonth()%4),l.setDate(0),l.setHours(0),l.setMinutes(0),l.setSeconds(0)):'WTD'===o[g].name?(l.setDate(l.getDate()-l.getDay()),l.setHours(0),l.setMinutes(0),l.setSeconds(0)):'Y'===o[g].name?(l.setHours(0),l.setMinutes(0),l.setSeconds(0),l-=8.64e7):'T'===o[g].name&&(l.setHours(0),l.setMinutes(0),l.setSeconds(0),k===+l&&(l=+l-8.64e7)),m<l&&m-l<p)continue;else o[g].dateStart=l.valueOf(),o[g].dateEnd=m.valueOf(),f.push(o[g]);for(n.milliseconds=1/0,g=0,h=o.length;g<h;g++)Math.abs(o[g].milliseconds-(r-q))<n.milliseconds&&(n.milliseconds=o[g].milliseconds,n.name=o[g].abbreviation)}createContextualButtons(e){var h,k,f=this,g=f.btns.contextualObj,l=0,m={};f.generateCtxBtnList();for(let n=0,o=this.standardContexualPeriods.length;n<o;n++)f.standardContexualPeriods[n].dateEnd-f.standardContexualPeriods[n].dateStart>=f.minimumBucket&&f.standardContexualPeriods[n].dateStart>f.startDataset&&(k=f.standardContexualPeriods[n].abbreviation,h=g[k]={contextStart:f.standardContexualPeriods[n].dateStart,contextEnd:f.standardContexualPeriods[n].dateEnd,fn:function(){f.categoryClicked='contextual',f.clickedId=f.standardContexualPeriods[n].abbreviation,f.highlightActiveRange(),f.globalReactiveModel.lock().prop('x-axis-visible-range-end',f.standardContexualPeriods[n].dateEnd).prop('x-axis-visible-range-start',f.standardContexualPeriods[n].dateStart).unlock()}},m[f.standardContexualPeriods[n].abbreviation]={text:f.standardContexualPeriods[n].abbreviation,config:{toolText:k,height:22,radius:1,margin:{left:l}},group:e,eventListeners:{click:h.fn}},l=-5,f.btns.contextualObj[f.standardContexualPeriods[n].abbreviation]=h);f.createD3Buttons(m,'contextualObj')}addCssRules(e,f){var g,h,k=this.graphics.paper;for(g in e)h=e[g],'container'===g?f.container&&k.cssAddRule('.'+h,f.container.style):'text'===g?f.text&&k.cssAddRule('.'+h,f.text.style):void 0}createD3Buttons(e,f){var g,h,k,l,m,n,o,p=this.extData.button,q=this.graphics.paper,r=q.getInstances().d3,s=this;for(g in e){for(n in h=e[g],k=h.text,l=h.config,f?(!s.btns[f][g]&&(s.btns[f][g]={}),o=s.btns[f][g].btn=r.button(k).setConfig(l)):(!s.btns[g]&&(s.btns[g]={}),o=s.btns[g].btn=r.button(k).setConfig(l)),o.namespace('fusioncharts'),o.appendSelector('standarperiodselector'),s.addCssRules(o.getIndividualClassNames(o.getClassName()),p),m=p.states,m)s.addCssRules(o.getIndividualClassNames(o.config.states[n]),p.states[n]);h.eventListeners&&o.attachEventHandlers({click:h.eventListeners.click.bind(o)}),h.group.addSymbol(o)}}createD3Labels(e){var f,g,h,k,l=this.extData.label,m=this,n={paper:m.graphics.paper,chart:m.chart,smartLabel:m.smartLabel,chartContainer:m.graphics.container};for(f in e)g=e[f],h=g.text,k=g.config,m[f]=new m.toolbox.Label(h,n,k),m.addCssRules(m[f].getIndividualClassNames(m[f].getClassName()),l),g.group.addSymbol(m[f])}createToolbar(){var f,g,h,k,l,m,n,o,e=this,p={paper:e.graphics.paper,chart:e.chart,smartLabel:e.smartLabel,chartContainer:e.graphics.container};g=new e.HorizontalToolbar(p),g.setConfig({fill:'#fff',borderThickness:0}),n=new e.toolbox.ComponentGroup(p),f=new e.toolbox.UniSelectComponentGroup(p),f.defineStateIndicator(function(q){var r=q.getBBox(),s=r.x,t=s+r.width,u=r.y+r.height;return{type:'path',attrs:{d:['M',s+1,u-1.2,'L',t,u-1.2].join(' '),'stroke-width':2,stroke:'#c95a5a'}}}),o=new e.toolbox.ComponentGroup(p),f.setConfig({fill:'#fff',borderThickness:0}),n.setConfig({fill:'#fff',borderThickness:0}),k={ZOOM:{text:'Zoom:',config:{height:22,margin:{right:-12}},group:n}},e.createD3Labels(k),h=e.allButtonShow&&{fn:function(){e.clickedId='ALL',e.state=this,e.categoryClicked='ALL',e.highlightActiveRange(),e.globalReactiveModel.lock().prop('x-axis-visible-range-end',e.endDataset).prop('x-axis-visible-range-start',e.startDataset).unlock()}},m={ALL:{text:'ALL',config:{height:22,radius:1,toolText:'ALL',margin:{right:10}},group:f,eventListeners:{click:h.fn}}},l={dummy:{text:'___',config:{height:22,radius:1},group:o}},h&&(e.btns.ALL=h,e.createD3Buttons(m));for(let q=0;6>q;q++)e.btns.dummy={},e.createD3Buttons(l,'dummy');return g.addComponent(n),g.addComponent(f),g.addComponent(o),e.toolbar=g,e.dummyButtonGroup=o,e.buttonGroup=f,g}appendButtons(){var e=this,f=e.buttonGroup;!Object.keys(e.btns.calculatedObj).length&&e.calculatedButtonShow&&e.createCalculatedButtons(f),!Object.keys(e.btns.contextualObj).length&&e.contextualButtonShow&&e.createContextualButtons(f)}init(e){var f=this;return e(['graphics','chart','canvasConfig','MarkerManager','reactiveModel','globalReactiveModel','spaceManagerInstance','smartLabel','extData','chartInstance','customExtremes',function(g,h,k,l,m,n,o,p,q,r,s){f.graphics=g,f.chart=h,f.markerManager=l,f.canvasConfig=k,f.reactiveModel=m,f.globalReactiveModel=n,f.spaceManagerInstance=o,f.smartLabel=p,f.extDataUser=q,f.chartInstance=r,f.customExtremes=s}]),f.extData={disabled:!1,'default-select':'ALL','all-button':!0,'contextual-button':!0,'calculated-button':!0,posWrtCanvas:'top','anchor-align':'right',layout:'inline',alignment:'left',orientation:'horizontal',customMultipliers:{millisecond:[1,500],second:[1,5,15,30],minute:[1,5,15,30],hour:[1,3,6,12],day:[1,7,15],month:[1,3,6],year:[1,3,5]},button:{height:22,radius:1,className:'standard-period-selector',container:{style:{fill:'#FFFFFF','stroke-width':'1px',stroke:'#CED5D4',labelFill:'#4b4b4b',strokeWidth:'1px'}},text:{style:{fontFamily:'"Lucida Grande", sans-serif','font-size':'13px',fill:'#4b4b4b','line-height':'1px','letter-spacing':'-0.04em'}},states:{hover:{className:'standard-period-selector-state-hover',container:{style:{cursor:'pointer',fill:'#f7f7f7'}}}}},label:{height:22,className:'standard-period-selector-label',text:{style:{'font-weight':'bold','font-family':'"Lucida Grande", sans-serif','font-size':'13px',fill:'#4b4b4b'}}}},Object.assign(f.extData,f.extDataUser),f.endActiveWindow=f.globalReactiveModel.model['x-axis-visible-range-end'],f.startActiveWindow=f.globalReactiveModel.model['x-axis-visible-range-start'],f.startDataset=f.globalReactiveModel.model['x-axis-absolute-range-start'],f.endDataset=f.globalReactiveModel.model['x-axis-absolute-range-end'],f.maximumBucket=f.endDataset-f.startDataset,f.timeRules=f.chartInstance.apiInstance.getComponentStore(),f.timeRules=f.timeRules.getCanvasByIndex(0).composition.impl,f.timeRules=f.timeRules.getDataAggregator(),f.timeRules=f.timeRules.getAggregationTimeRules(),f.timePeriods=f.processMultipliers(f.timeRules,f.extData.customMultipliers),f.allButtonShow=f.extData['all-button'],f.calculatedButtonShow=f.extData['calculated-button'],f.contextualButtonShow=f.extData['contextual-button'],f.anchorPositions=f.extData['anchor-align'],f.customMultipliers=f.extData.customMultipliers,f.keySelect=f.extData['default-select'],f.measurement={},f.flag=!0,f.toolbars=[],f.toolbars.push(f.createToolbar()),f.globalReactiveModel.onPropsChange(['x-axis-visible-range-start','x-axis-visible-range-end'],f.propsChangeListener),f.globalReactiveModel.onPropChange('x-axis-absolute-range-end',function(){'contextual'===f.categoryClicked&&(f.globalReactiveModel.model['x-axis-visible-range-end']=f.globalReactiveModel.model['x-axis-absolute-range-end'])}),f}getLogicalSpace(e=this._pWidth,f=this._pHeight){var g,l,m,h=0,k=0,n=this;for(l=0,m=n.toolbars.length;l<m;l++)g=n.toolbars[l].getLogicalSpace(e,f),h=Math.max(g.width,h),k+=g.height,n.toolbars[l].width=g.width,n.toolbars[l].height=g.height;return k+=n.padding,{width:h,height:k}}getDefaultGroup(){return this.parentGroup}placeInCanvas(){var e=this;e.padding=5,e.spaceManagerInstance.add([{name:function(){return'standard-period-selector-ext'},ref:function(f){return f[0]},self:function(){return e},priority:function(){return 2},layout:function(f){return f[e.extData.layout]||'inline'},orientation:[{type:function(f){return f[e.extData.orientation]||'horizontal'},position:[{type:function(f){return f[e.extData.posWrtCanvas]||'top'},alignment:[{type:function(f){return f[e.extData.alignment]||'left'},dimensions:[function(){var f=this.getParentComponentGroup();return e._ref=this,e.getLogicalSpace(e._pWidth=f.getWidth(),e._pHeight=f.getHeight())}]}]}]}]}])}setDrawingConfiguration(e,f,g,h,k){var l=this.measurement;return l.x=e,l.y=f,l.width=g,l.height=h,this.parentGroup=k,this}draw(e,f,g,h,k){var o,p,q,u,A,B,l=this,m=l.measurement,n=l.toolbars,r=l.btns.contextualObj,s=l.btns.calculatedObj,t=l.clickedId,v=l.globalReactiveModel.model,w=l.minimumBucket,z=l.buttonGroup;if(w=v['minimum-consecutive-datestamp-diff']*v['x-axis-maximum-allowed-ticks'],l.minimumBucket=w,l.dummyButtonGroup.dispose(),n[0].removeComponent(l.dummyButtonGroup),l.appendButtons(),z.getLogicalSpace(),!Object.keys(l.customExtremes).length&&l.keySelect){if('ALL'===l.keySelect)l.clickedId='ALL',l.state=l.btns.ALL.btn;else if(r[l.keySelect])l.clickedId=l.keySelect;else for(B in A=!0,s)A&&s[B].shortKey===l.keySelect&&(l.clickedId=B,A=!1);delete l.keySelect,t=l.clickedId}if(e=void 0===e?m.x:e,f=void 0===f?m.y:f,g=void 0===g?m.width:g,h=void 0===h?m.height:h,k=void 0===k?this.parentGroup:k,g&&h){for(p=0,o=n.length;p<o;p++)q=n[p],q.draw(e,f,k),l.toolbarDrawn=!0;t?(u=s[t]||r[t]||l.btns[t],u?u.fn&&u.fn():l.onActiveRangeChange()):l.onActiveRangeChange()}}}}}]);
//# sourceMappingURL=standard-period-selector.min.js.map
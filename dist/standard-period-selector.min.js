(function(c){function d(f){if(e[f])return e[f].exports;var g=e[f]={exports:{},id:f,loaded:!1};return c[f].call(g.exports,g,g.exports,d),g.loaded=!0,g.exports}var e={};return d.m=c,d.c=e,d.p='',d(0)})([function(c,d,e){'use strict';const f=e(1);window.stPS=new f;(function(g,k){'object'==typeof c&&c.exports?c.exports=g.document?k(g):function(l){if(!l.document)throw new Error('Window with document not present');return k(l,!0)}:g.StandardPeriodSelector=k(g,!0)})('undefined'==typeof window?this:window,function(g){var k=g.FusionCharts;k.register('extension',['private','standard-period-selector',function(){k.registerComponent('extensions','standard-period-selector',f({FusionCharts:k}))}])})},function(c){'use strict';c.exports=function(){return class{constructor(){this.ratio=8,this.toolbox=FusionCharts.getComponent('api','toolbox'),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.all=1,this.calculatedPeriods=[],this.startDataset=0,this.startActiveWindow=0,this.endActiveWindow=1,this.standardCalculatedPeriods=[],this.standardContexualPeriods=[],this.startPointUnit=0,this.startPointMultiplier=0,this.clickedId='ALL',this.noCalcButtons=0,this.calculatedButtonObj={},this.minimumBucket=1,this.tdButtons=[{name:'YTD',abbreviation:'YTD',parent:'year',milliseconds:31104000000,description:'Year to Date'},{name:'QTD',abbreviation:'QTD',parent:'month',multiplier:3,milliseconds:7776000000,description:'Quarter to Date'},{name:'MTD',abbreviation:'MTD',parent:'month',milliseconds:2592000000,description:'Month to Date'},{name:'WTD',abbreviation:'WTD',parent:'day',multiplier:7,milliseconds:604800000,description:'Week to Date'},{name:'Y',abbreviation:'Y',parent:'day',milliseconds:86400000,description:'Yesterday'},{name:'T',abbreviation:'T',parent:'day',milliseconds:86400000,description:'Today'}],this.config={anchorPositions:'right',all:'1',contextual:'1',calculated:'1',tertiaryTimePeriods:{}}}generateCalculatedButtons(){var e=this.endActiveWindow-this.startDataset,f=0,g=0,k=this.endActiveWindow-this.startActiveWindow,l=0,m=this;for(m.standardCalculatedPeriods=[],f=0;f<m.timePeriods.length;f++)if(1<=e/m.timePeriods[f].interval)if(1>Math.floor(k/m.timePeriods[f].interval))m.standardCalculatedPeriods.push({abbreviation:m.timePeriods[f].abbreviation.single,description:m.timePeriods[f].description,milliseconds:m.timePeriods[f].interval,name:m.timePeriods[f].name,multipliers:[1]});else for(m.standardCalculatedPeriods.push({abbreviation:m.timePeriods[f].abbreviation.single,description:m.timePeriods[f].description,milliseconds:m.timePeriods[f].interval,name:m.timePeriods[f].name,multipliers:[]}),g=0;g<m.timePeriods[f].multipliers.length;g++)k/m.ratio<m.timePeriods[f].multipliers[g]*m.timePeriods[f].interval&&m.timePeriods[f].multipliers[g]*m.timePeriods[f].interval>m.minimumBucket&&m.standardCalculatedPeriods[m.standardCalculatedPeriods.length-1].multipliers.push(m.timePeriods[f].multipliers[g]);for(this.noCalcButtons=1/0,f=0;f<this.standardCalculatedPeriods.length;f++)for(g=0;g<this.standardCalculatedPeriods[f].multipliers.length;g++)++l,this.noCalcButtons>f&&(this.noCalcButtons=f),4>=l&&(this.startPointMultiplier=g,this.startPointUnit=f)}generateContextualButtons(){for(var e=[],f=0,g=this.globalReactiveModel.model['x-axis-absolute-range-end'],k=g-2,l=g,m={};f<this.tdButtons.length;f++)if(k=new Date(g),'YTD'===this.tdButtons[f].name?(k.setMonth(0),k.setDate(1),k.setHours(0),k.setMinutes(0),k.setSeconds(0)):'MTD'===this.tdButtons[f].name?(k.setDate(1),k.setHours(0),k.setMinutes(0),k.setSeconds(0)):'QTD'===this.tdButtons[f].name?(k.setMonth(11-k.getMonth()%4),k.setDate(0),k.setHours(0),k.setMinutes(0),k.setSeconds(0)):'WTD'===this.tdButtons[f].name?(k.setDate(k.getDate()-k.getDay()),k.setHours(0),k.setMinutes(0),k.setSeconds(0)):'Y'===this.tdButtons[f].name?(k.setHours(0),k.setMinutes(0),k.setSeconds(0),k-=8.64e7):'T'===this.tdButtons[f].name&&(k.setHours(0),k.setMinutes(0),k.setSeconds(0),+this.endDataset==+k&&(k=+k-8.64e7)),l<k)continue;else this.tdButtons[f].dateStart=k.valueOf(),this.tdButtons[f].dateEnd=l.valueOf(),e.push(this.tdButtons[f]);for(m.milliseconds=1/0,f=0;f<this.tdButtons.length;f++)Math.abs(this.tdButtons[f].milliseconds-(this.endActiveWindow-this.startActiveWindow))<m.milliseconds&&(m.milliseconds=this.tdButtons[f].milliseconds,m.name=this.tdButtons[f].abbreviation);this.standardContexualPeriods=e}processMultipliers(e){var f=this;for(let g=0;g<e.length;g++){let k=e[g].possibleFactors.length,l=e[g]&&e[g].name,m=e&&e[g],n=f.extData&&f.extData.customMultipliers||{};m.multipliers=[],n[l]?m.multipliers=n[l]:1===k?m.multipliers.push(m.possibleFactors[0]):2===k?(m.multipliers.push(m.possibleFactors[0]),m.multipliers.push(m.possibleFactors[k-1])):(m.multipliers.push(m.possibleFactors[0]),m.multipliers.push(Math.floor(m.possibleFactors[k-1]/2)),m.multipliers.push(m.possibleFactors[k-1]))}return e}setActivePeriod(){var e,f;1===arguments.length?(f=this.globalReactiveModel.model['x-axis-visible-range-end'],e=f-arguments[0]):2===arguments.length&&(e=arguments[0],f=arguments[1]),this.startActiveWindow=e,this.endActiveWindow=f,this.periodButtonClicked&&(this.periodButtonClicked=!1,this.globalReactiveModel.model['x-axis-visible-range-start']=this.startActiveWindow,this.globalReactiveModel.model['x-axis-visible-range-end']=this.endActiveWindow),this.generateCalculatedButtons(),this.generateContextualButtons()}configure(e){this.config=e}init(e){function f(l,m,n){if(g.lastDisposed=g.lastDisposed||0,n&&(g.launchedPropsHandler=!1,l=g.propsStart,m=g.propsEnd),g.propsStart=l,g.propsEnd=m,400>+new Date-g.lastDisposed)return void(g.launchedPropsHandler||(g.launchedPropsHandler=!0,setTimeout(f.bind(null,0,0,!0))));g.lastDisposed=+new Date,g.setActivePeriod(l[1],m[1]);for(let o=0;o<g.standardCalculatedPeriods.length;o++)for(let p=0;p<g.standardCalculatedPeriods[o].multipliers.length;p++)m[1]-l[1]>=g.endDataset-g.startDataset?g.clickedId='ALL':m[1]-l[1]>=g.timePeriods[o].multipliers[p]*g.timePeriods[o].interval&&(g.clickedId=g.timePeriods[o].multipliers[p]+g.timePeriods[o].abbreviation.single);g.cantDispose?g.cantDispose=!1:(g.cantDispose=!0,g.toolbar.dispose(),g.toolbars.pop(),g.toolbars.push(g.createToolbar()),g.getLogicalSpace(),g.draw())}var g=this,k=g.standardCalculatedPeriods;return e(['xAxis','yAxis','graphics','chart','dataset','PlotManager','canvasConfig','MarkerManager','reactiveModel','globalReactiveModel','spaceManagerInstance','smartLabel','extData','chartInstance',function(l,m,n,o,p,q,r,s,t,u,v,z,A,B){g.xAxis=l,g.yAxis=m,g.graphics=n,g.chart=o,g.dataset=p,g.plotManager=q,g.markerManager=s,g.canvasConfig=r,g.reactiveModel=t,g.globalReactiveModel=u,g.spaceManagerInstance=v,g.smartLabel=z,g.extData=A,g.chartInstance=B}]),g.endActiveWindow=g.globalReactiveModel.model['x-axis-visible-range-end'],g.startActiveWindow=g.globalReactiveModel.model['x-axis-visible-range-start'],g.startDataset=g.globalReactiveModel.model['x-axis-absolute-range-start'],g.endDataset=g.globalReactiveModel.model['x-axis-absolute-range-end'],g.timeRules=g.chartInstance.apiInstance.getComponentStore(),g.timeRules=g.timeRules.getCanvasByIndex(0).composition.impl,g.timeRules=g.timeRules.getDataAggregator(),g.timeRules=g.timeRules.getAggregationTimeRules(),g.timePeriods=g.processMultipliers(g.timeRules),g.setActivePeriod(g.startActiveWindow,g.endActiveWindow),g.toolbars=[],g.measurement={},g.flag=!0,g.toolbars.push(g.createToolbar()),g.globalReactiveModel.onPropsChange(['x-axis-visible-range-start','x-axis-visible-range-end'],f),g}createToolbar(){var e,f,g,k,l,o,p,q,r,s,t,u,m=this,n=[];for(u=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),e=new this.toolbox.UniSelectComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),e.setConfig({fill:'#fff',borderThickness:0}),u.setConfig({fill:'#fff',borderThickness:0}),f=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),f.setConfig({fill:'#fff',borderThickness:0}),t=new this.toolbox.Label('Zoom:',{smartLabel:this.smartLabel,paper:this.graphics.paper},m.extData.style['label-config']),u.addSymbol(t),l=new this.toolbox.Symbol('ALL',!0,{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},m.extData.style['all-config']).attachEventHandlers({click:function(){m.periodButtonClicked=!0,m.clickedId='ALL',m.setActivePeriod(m.startDataset,m.endDataset)},tooltext:'ALL'}),e.addSymbol(l),q=0;q<this.standardCalculatedPeriods.length;q++)for(r=this.standardCalculatedPeriods[q].multipliers.length-1;0<=r;r--)n.push(m.standardCalculatedPeriods[q].multipliers[r]*m.standardCalculatedPeriods[q].milliseconds);for(let v in g={},this.calculatedButtonObj)this.calculatedButtonObj[v].hide();for(let v=m.startPointUnit;0<=v;v--){o=v===m.startPointUnit?m.startPointMultiplier:m.standardCalculatedPeriods[v].multipliers.length-1;for(let z=o;0<=z;z--){let A=m.standardCalculatedPeriods[v].multipliers[z]+m.standardCalculatedPeriods[v].abbreviation;void 0===this.calculatedButtonObj[A]&&(g=new this.toolbox.Symbol(A,!0,{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},m.extData.style['calculated-config']).attachEventHandlers({click:function(){m.periodButtonClicked=!0,m.clickedId=m.standardCalculatedPeriods[v].multipliers[z]+m.standardCalculatedPeriods[v].abbreviation,p=m.standardCalculatedPeriods[v].multipliers[z]*m.standardCalculatedPeriods[v].milliseconds,m.setActivePeriod(p)},tooltext:m.standardCalculatedPeriods[v].multipliers[z]+' '+m.standardCalculatedPeriods[v].description}),this.calculatedButtonObj[A]=g),this.calculatedButtonObj[A].show(),e.addSymbol(this.calculatedButtonObj[A])}}k=[];for(let v=0;v<this.standardContexualPeriods.length;v++)s=0===v?m.extData.style['contextual-config-first']:m.extData.style['contextual-config'],k[v]=new this.toolbox.Symbol(this.standardContexualPeriods[v].abbreviation,!0,{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},s).attachEventHandlers({click:function(){m.periodButtonClicked=!0,m.clickedId=m.standardContexualPeriods[v].abbreviation,m.setActivePeriod(m.standardContexualPeriods[v].dateStart,m.standardContexualPeriods[v].dateEnd)},tooltext:this.standardContexualPeriods[v].description}),e.addSymbol(k[v]);return this.SymbolStore.register('textBoxIcon',function(v,z,A,B,C,D,E){var F=v-B/2+D/2,G=v+B/2-D/2,H=z-C/2+E/2,I=z+C/2-E/2;return['M',F,H,'L',G,H,'L',G,I,'L',F,I,'Z']}),f.addComponent(u),f.addComponent(e),this.toolbar=f,f}getLogicalSpace(e=this._pWidth,f=this._pHeight){var g,l,m,k=0;for(l=0,m=this.toolbars.length;l<m;l++)g=this.toolbars[l].getLogicalSpace(e,f),k+=g.height,this.toolbars[l].width=g.width,this.toolbars[l].height=g.height;return k+=this.padding,{width:420,height:k}}getDefaultGroup(){return this.parentGroup}placeInCanvas(){var e=this;e.padding=5,e.spaceManagerInstance.add([{name:function(){return'standard-period-selector-ext'},ref:function(f){return f['0']},self:function(){return e},priority:function(){return 2},layout:function(f){return f[e.extData.layout]},orientation:[{type:function(f){return f[e.extData.orientation]},position:[{type:function(f){return f[e.extData.posWrtCanvas]},alignment:[{type:function(f){return f[e.extData.alignment]},dimensions:[function(){var f=this.getParentComponentGroup();return e._ref=this,e.getLogicalSpace(e._pWidth=f.getWidth(),e._pHeight=f.getHeight())}]}]}]}]}])}setDrawingConfiguration(e,f,g,k,l){var m=this.measurement;return m.x=e,m.y=f,m.width=g,m.height=k,this.parentGroup=l,this}draw(e,f,g,k,l){var o,p,q,r,s,t,u,v,z,A,m=this.measurement,n=this.toolbars;if(this.flag=!0,A=this.saveSelectLine||this.graphics.paper.path({stroke:'#c95a5a','stroke-width':'2px'}).toFront(),e=void 0===e?m.x:e,f=void 0===f?m.y:f,g=void 0===g?m.width:g,k=void 0===k?m.height:k,l=void 0===l?this.parentGroup:l,g&&k)for(p=0,o=n.length;p<o;p++)q=n[p],q.draw(e,f,l);this.saveSelectLine=A,r=n[0].componentGroups[1].symbolList;for(let B=0,C=r.length;B<C;B++)r[B].symbol===this.clickedId&&(s=r[B].getBoundElement(),t=s.getBBox(),u=t.x,v=t.x2,z=t.y2,A.attr({path:['M',u-0.5,z-0.5,'L',v+0.5,z-0.5]}));this.minimumBucket=this.globalReactiveModel.model['minimum-consecutive-datestamp-diff']*this.globalReactiveModel.model['x-axis-maximum-allowed-ticks']}}}}]);
//# sourceMappingURL=standard-period-selector.min.js.map